<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="page-version" content="25.11.09.12.15">
    <title>Manual - Talento Humano - Ajustar Saldos - SchoolNet</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #1e3a8a;
            --secondary-color: #3b82f6;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --info-color: #06b6d4;
            --light-bg: #f8fafc;
            --border-color: #e2e8f0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light-bg);
            color: #1e293b;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            padding: 2rem 1rem;
        }

        .header-section {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .header-section h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .header-section p {
            font-size: 1.125rem;
            opacity: 0.95;
            margin-bottom: 0;
        }

        .section-card {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border-color);
        }

        .section-card h2 {
            color: var(--primary-color);
            font-size: 1.75rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 3px solid var(--secondary-color);
        }

        .section-card h3 {
            color: var(--secondary-color);
            font-size: 1.25rem;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }

        .info-box {
            background-color: #dbeafe;
            border-left: 4px solid var(--info-color);
            padding: 1rem 1.25rem;
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        .success-box {
            background-color: #d1fae5;
            border-left: 4px solid var(--success-color);
            padding: 1rem 1.25rem;
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        .warning-box {
            background-color: #fef3c7;
            border-left: 4px solid var(--warning-color);
            padding: 1rem 1.25rem;
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        .danger-box {
            background-color: #fee2e2;
            border-left: 4px solid var(--danger-color);
            padding: 1rem 1.25rem;
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        .step-card {
            background: var(--light-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.25rem;
            margin: 1rem 0;
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background-color: var(--secondary-color);
            color: white;
            border-radius: 50%;
            font-weight: 600;
            margin-right: 0.75rem;
        }

        .feature-list {
            list-style: none;
            padding-left: 0;
        }

        .feature-list li {
            padding: 0.75rem 0;
            padding-left: 2rem;
            position: relative;
        }

        .feature-list li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: var(--success-color);
            font-weight: bold;
            font-size: 1.25rem;
        }

        .btn-return {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }

        .bug-report-card {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            border: 2px solid var(--danger-color);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            margin-top: 3rem;
        }

        .floating-bug-button {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
            }
            50% {
                box-shadow: 0 6px 20px rgba(239, 68, 68, 0.6);
            }
        }

        .badge-example {
            display: inline-block;
            margin: 0.25rem;
        }

        ol, ul {
            margin: 1rem 0;
        }

        ol li, ul li {
            margin: 0.5rem 0;
        }

        @media (max-width: 768px) {
            .header-section h1 {
                font-size: 1.75rem;
            }

            .container {
                padding: 1rem 0.5rem;
            }

            .floating-bug-button {
                bottom: 1rem;
                right: 1rem;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        
        <!-- Botón Volver -->
        <a href="../../modules/hr/adjust-balances.html" class="btn btn-outline-primary btn-return">
            <i class="bi bi-arrow-left"></i>
            <span>Volver al Módulo</span>
        </a>

        <!-- Encabezado -->
        <div class="header-section">
            <h1>
                <i class="bi bi-calculator me-3"></i>
                Manual: Ajustar Saldos
            </h1>
            <p>Módulo de Talento Humano - Gestión de Saldos de Ausencias</p>
        </div>

        <!-- ¿Qué es? -->
        <div class="section-card">
            <h2>
                <i class="bi bi-info-circle me-2"></i>
                ¿Qué es esta función?
            </h2>
            <p>
                La función <strong>"Ajustar Saldos"</strong> es una herramienta administrativa especializada 
                que permite al personal de Talento Humano modificar manualmente los saldos de horas personales 
                y días de calamidad de los trabajadores. Esta función es esencial para mantener el equilibrio 
                correcto de los beneficios de ausencias de cada empleado.
            </p>
            <p>
                Los saldos de ausencias funcionan como una "cuenta bancaria" de tiempo. Los trabajadores 
                tienen un límite anual de horas personales y días de calamidad que pueden usar. Cuando 
                solicitan y se les aprueba una ausencia de esos tipos, el tiempo se "gasta" de su saldo. 
                Esta función te permite agregar o restar manualmente de esos saldos cuando sea necesario.
            </p>

            <div class="danger-box">
                <strong><i class="bi bi-shield-exclamation me-2"></i>ACCESO RESTRINGIDO:</strong>
                Esta es una función de alto privilegio exclusiva para personal de Talento Humano. 
                Solo personas con el permiso "Ajustar saldos de ausencias" pueden acceder. Los ajustes 
                incorrectos pueden afectar los derechos laborales de los trabajadores.
            </div>
        </div>

        <!-- Características -->
        <div class="section-card">
            <h2>
                <i class="bi bi-star me-2"></i>
                Características Principales
            </h2>
            <ul class="feature-list">
                <li><strong>Búsqueda rápida de trabajadores:</strong> Busca por nombre, apellido o número de documento</li>
                <li><strong>Vista completa de saldos actuales:</strong> Visualiza en tiempo real el saldo disponible de cada trabajador</li>
                <li><strong>Ajustes positivos y negativos:</strong> Agrega o resta horas/días según sea necesario</li>
                <li><strong>Dos tipos de ajuste:</strong> Horas personales o días de calamidad</li>
                <li><strong>Documentación obligatoria:</strong> Cada ajuste requiere una razón detallada</li>
                <li><strong>Historial completo y auditable:</strong> Registro permanente de todos los ajustes con fecha, usuario y razón</li>
                <li><strong>Cálculo automático:</strong> El sistema calcula los saldos combinando ajustes manuales y consumo por ausencias</li>
                <li><strong>Visualización de consumo:</strong> Ve las últimas 20 solicitudes de ausencias del trabajador</li>
                <li><strong>Botones rápidos:</strong> Atajo para agregar rápidamente cantidades comunes (ej: +10 horas)</li>
                <li><strong>Indicadores visuales de color:</strong> Verde para saldos positivos, rojo para negativos, gris para cero</li>
            </ul>
        </div>

        <!-- Antes de Comenzar -->
        <div class="section-card">
            <h2>
                <i class="bi bi-clipboard-check me-2"></i>
                Antes de Comenzar
            </h2>

            <h3>Requisitos Previos</h3>
            <ol>
                <li><strong>Permisos administrativos:</strong> Debes tener el permiso "Ajustar saldos de ausencias"</li>
                <li><strong>Rol en Talento Humano:</strong> Generalmente solo personal autorizado de RRHH</li>
                <li><strong>Conocimiento de políticas:</strong> Entender las políticas institucionales sobre límites de ausencias</li>
                <li><strong>Usuario asociado a trabajador:</strong> Tu usuario debe estar vinculado a un registro de trabajador para registrar quién hace el ajuste</li>
            </ol>

            <h3>Conceptos Clave</h3>
            
            <div class="step-card">
                <strong><i class="bi bi-clock-history me-2"></i>Horas Personales</strong>
                <p class="mb-0 mt-2">
                    Tiempo libre remunerado que los trabajadores pueden usar para asuntos personales. 
                    Generalmente hay un límite anual (ejemplo: 24 horas por año). El saldo se calcula como: 
                    <code>Ajustes Manuales - Ausencias Aprobadas de categorías que consumen horas personales</code>
                </p>
            </div>

            <div class="step-card">
                <strong><i class="bi bi-heart-pulse me-2"></i>Días de Calamidad</strong>
                <p class="mb-0 mt-2">
                    Días especiales para emergencias familiares o situaciones de calamidad. También tienen 
                    un límite anual (ejemplo: 5 días por año). El saldo se calcula como: 
                    <code>Ajustes Manuales - Ausencias Aprobadas de categorías que consumen días de calamidad</code>
                </p>
            </div>

            <h3>Cuándo Ajustar Saldos</h3>
            <p>Los ajustes de saldo son necesarios en situaciones como:</p>
            <ul>
                <li><strong>Inicio de año:</strong> Asignar el saldo anual completo a todos los trabajadores</li>
                <li><strong>Nuevos ingresos:</strong> Dar saldo proporcional a empleados que ingresan durante el año</li>
                <li><strong>Corrección de errores:</strong> Ajustar si hubo un error en cálculos previos</li>
                <li><strong>Beneficios adicionales:</strong> Otorgar horas/días extras por políticas especiales</li>
                <li><strong>Ajuste por salida:</strong> Restar saldo si un trabajador se retira con ausencias pendientes de descontar</li>
                <li><strong>Compensación:</strong> Ajustar por tiempo trabajado extra o situaciones especiales aprobadas</li>
            </ul>

            <div class="warning-box">
                <strong><i class="bi bi-exclamation-triangle me-2"></i>Responsabilidad Importante:</strong>
                Los ajustes de saldo afectan directamente los derechos y beneficios de los trabajadores. 
                Cada ajuste debe estar debidamente justificado y documentado. Todos los movimientos quedan 
                registrados permanentemente con tu identificación de usuario.
            </div>

            <h3>Cómo se Calculan los Saldos</h3>
            <p>Es importante entender que el "saldo disponible" que se muestra es el resultado de:</p>
            <ol>
                <li><strong>SUMA:</strong> Todos los ajustes manuales positivos que se han hecho al trabajador</li>
                <li><strong>RESTA:</strong> Todos los ajustes manuales negativos que se han hecho</li>
                <li><strong>RESTA:</strong> Las horas/días consumidos por ausencias APROBADAS de categorías que controlan ese tipo de saldo</li>
            </ol>
            <p>
                Por ejemplo: Si un trabajador tiene +24 horas de ajustes manuales, y ha usado 10 horas en 
                ausencias aprobadas, su saldo disponible será de 14 horas.
            </p>
        </div>

        <!-- Guía Paso a Paso -->
        <div class="section-card">
            <h2>
                <i class="bi bi-list-ol me-2"></i>
                Guía Paso a Paso
            </h2>

            <div class="step-card">
                <h3>
                    <span class="step-number">1</span>
                    Accede a Ajustar Saldos
                </h3>
                <p>
                    Desde el menú principal o dashboard de SchoolNet:
                </p>
                <ol>
                    <li>Ve al módulo <strong>Talento Humano</strong></li>
                    <li>Haz clic en <strong>Ajustar Saldos</strong></li>
                    <li>El sistema verificará que tienes los permisos necesarios</li>
                    <li>Verás la interfaz principal con el campo de búsqueda de trabajadores</li>
                </ol>
            </div>

            <div class="step-card">
                <h3>
                    <span class="step-number">2</span>
                    Busca al Trabajador
                </h3>
                <p>
                    Para encontrar al empleado cuyo saldo necesitas ajustar:
                </p>
                <ol>
                    <li>En el campo "Buscar trabajador", comienza a escribir:
                        <ul>
                            <li>Cualquier parte del nombre</li>
                            <li>Cualquier parte del apellido</li>
                            <li>O el número de documento completo o parcial</li>
                        </ul>
                    </li>
                    <li>Escribe al menos 2 caracteres</li>
                    <li>El sistema buscará automáticamente después de 300 milisegundos</li>
                    <li>Aparecerá una lista desplegable con los resultados</li>
                    <li>Cada resultado muestra: Nombre completo y número de documento</li>
                </ol>

                <div class="info-box">
                    <strong><i class="bi bi-info-circle me-2"></i>Nota sobre búsqueda:</strong>
                    Solo se muestran trabajadores con estado "Activo". Si buscas un trabajador que ya no 
                    está activo y no aparece, no podrás ajustar su saldo desde esta función.
                </div>
            </div>

            <div class="step-card">
                <h3>
                    <span class="step-number">3</span>
                    Selecciona al Trabajador
                </h3>
                <p>
                    Una vez tengas los resultados:
                </p>
                <ol>
                    <li>Haz clic sobre el trabajador que necesitas en la lista de resultados</li>
                    <li>La búsqueda se cerrará y el campo se limpiará</li>
                    <li>Aparecerá una sección completa con toda la información del trabajador</li>
                    <li>La página hará scroll automáticamente a esa sección</li>
                </ol>
            </div>

            <div class="step-card">
                <h3>
                    <span class="step-number">4</span>
                    Revisa la Información del Trabajador
                </h3>
                <p>
                    En la tarjeta azul superior verás:
                </p>

                <h4>Datos básicos:</h4>
                <ul>
                    <li><strong>Nombre completo</strong> (en el encabezado)</li>
                    <li><strong>Documento:</strong> Número de identificación</li>
                    <li><strong>Email:</strong> Correo electrónico</li>
                </ul>

                <h4>Saldos actuales (en tiempo real):</h4>
                <ul>
                    <li><strong>Horas Personales Disponibles:</strong> Con indicador de color
                        <ul>
                            <li><span class="badge bg-success badge-example">Verde</span> si es positivo</li>
                            <li><span class="badge bg-danger badge-example">Rojo</span> si es negativo</li>
                            <li><span class="badge bg-secondary badge-example">Gris</span> si es cero</li>
                        </ul>
                    </li>
                    <li><strong>Días de Calamidad Disponibles:</strong> Con los mismos indicadores de color</li>
                </ul>

                <div class="success-box">
                    <strong><i class="bi bi-lightbulb me-2"></i>Interpretando los saldos:</strong>
                    <ul class="mt-2 mb-0">
                        <li><strong>Positivo (verde):</strong> El trabajador tiene tiempo disponible</li>
                        <li><strong>Cero (gris):</strong> Ha usado exactamente su límite</li>
                        <li><strong>Negativo (rojo):</strong> Ha usado más de lo asignado (situación que debe resolverse)</li>
                    </ul>
                </div>
            </div>

            <div class="step-card">
                <h3>
                    <span class="step-number">5</span>
                    Completa el Formulario de Ajuste
                </h3>
                <p>
                    Para realizar un ajuste, llena los siguientes campos:
                </p>

                <h4>1. Tipo de Ajuste (obligatorio):</h4>
                <ul>
                    <li><strong>Horas Personales:</strong> Selecciona para ajustar el saldo de horas personales</li>
                    <li><strong>Días de Calamidad:</strong> Selecciona para ajustar el saldo de días de calamidad</li>
                </ul>

                <h4>2. Cantidad (obligatorio):</h4>
                <ul>
                    <li>Ingresa un número con hasta 2 decimales</li>
                    <li><strong>Número positivo:</strong> Para AGREGAR al saldo (ejemplo: 10 o 5.5)</li>
                    <li><strong>Número negativo:</strong> Para RESTAR del saldo (ejemplo: -3 o -2.5)</li>
                    <li>No puedes ingresar cero (el sistema no lo permitirá)</li>
                </ul>

                <h4>Botón rápido +10:</h4>
                <p>
                    Hay un botón verde con "+10" que automáticamente rellena el campo de cantidad con 10. 
                    Es un atajo útil para el caso común de asignar el saldo anual completo.
                </p>

                <h4>3. Razón del Ajuste (obligatorio):</h4>
                <p>
                    Escribe una explicación clara y detallada del porqué de este ajuste. Ejemplos:
                </p>
                <ul>
                    <li>"Asignación de saldo anual 2025 - 24 horas personales según política institucional"</li>
                    <li>"Ajuste proporcional por ingreso en junio - 12 horas (50% del año)"</li>
                    <li>"Corrección de error en cálculo anterior - se había descontado incorrectamente 2 horas"</li>
                    <li>"Compensación aprobada por trabajo en día festivo - 8 horas adicionales"</li>
                    <li>"Ajuste por retiro - descuento de ausencias pendientes de compensar"</li>
                </ul>

                <div class="danger-box">
                    <strong><i class="bi bi-shield-exclamation me-2"></i>IMPORTANTE sobre la razón:</strong>
                    La razón queda registrada permanentemente y es auditable. Sé específico y profesional. 
                    Esta información puede ser consultada en auditorías o revisiones legales.
                </div>
            </div>

            <div class="step-card">
                <h3>
                    <span class="step-number">6</span>
                    Aplica el Ajuste
                </h3>
                <p>
                    Una vez completos todos los campos:
                </p>
                <ol>
                    <li>Revisa cuidadosamente toda la información</li>
                    <li>Verifica especialmente:
                        <ul>
                            <li>Que seleccionaste el tipo correcto (horas vs días)</li>
                            <li>Que el signo de la cantidad es el correcto (+ para agregar, - para restar)</li>
                            <li>Que la razón está bien escrita y es clara</li>
                        </ul>
                    </li>
                    <li>Haz clic en el botón <strong>"Aplicar Ajuste"</strong></li>
                    <li>El sistema procesará el ajuste (verás un indicador de carga)</li>
                    <li>Verás un mensaje de éxito si todo salió bien</li>
                </ol>

                <h4>¿Qué sucede al aplicar?</h4>
                <ul>
                    <li>El ajuste se guarda en la base de datos permanentemente</li>
                    <li>Se registra tu identificación de usuario como quien hizo el ajuste</li>
                    <li>Se registra la fecha y hora exactas</li>
                    <li>Los saldos actuales se recalculan automáticamente</li>
                    <li>La pantalla se actualiza mostrando los nuevos saldos</li>
                    <li>El ajuste aparece en el historial del trabajador</li>
                    <li>El formulario se limpia automáticamente</li>
                </ul>
            </div>

            <div class="step-card">
                <h3>
                    <span class="step-number">7</span>
                    Revisa el Historial de Ajustes
                </h3>
                <p>
                    Debajo del formulario encontrarás la sección "Historial de Ajustes" que muestra:
                </p>
                <ul>
                    <li>Todos los ajustes realizados a este trabajador</li>
                    <li>Ordenados del más reciente al más antiguo</li>
                    <li>Cada tarjeta de ajuste muestra:
                        <ul>
                            <li><strong>Cantidad y tipo:</strong> (ejemplo: +24 Horas Personales)</li>
                            <li><strong>Razón:</strong> La explicación que se dio</li>
                            <li><strong>Usuario:</strong> Quién realizó el ajuste</li>
                            <li><strong>Fecha y hora:</strong> Cuándo se realizó</li>
                        </ul>
                    </li>
                    <li>Color de fondo:
                        <ul>
                            <li><span class="badge bg-success badge-example">Verde claro</span> para ajustes positivos</li>
                            <li><span class="badge bg-danger badge-example">Rojo claro</span> para ajustes negativos</li>
                        </ul>
                    </li>
                </ul>

                <h4>Para actualizar el historial:</h4>
                <ul>
                    <li>Haz clic en el botón "Actualizar" en la esquina superior derecha de la sección</li>
                    <li>Esto recarga la información desde el servidor</li>
                </ul>
            </div>

            <div class="step-card">
                <h3>
                    <span class="step-number">8</span>
                    Consulta las Solicitudes de Ausencias
                </h3>
                <p>
                    En la parte inferior verás una tabla con las últimas 20 solicitudes de ausencia del trabajador:
                </p>

                <h4>Información mostrada:</h4>
                <ul>
                    <li><strong>Fecha Solicitud:</strong> Cuándo se creó la solicitud</li>
                    <li><strong>Categoría:</strong> Tipo de ausencia (Incapacidad, Horas Personales, etc.)</li>
                    <li><strong>Período:</strong> Fechas y horarios de la ausencia</li>
                    <li><strong>Horas/Días:</strong> Cantidad solicitada</li>
                    <li><strong>Estado:</strong> Badge de color según estado:
                        <ul>
                            <li><span class="badge bg-warning badge-example">Amarillo</span> - Pendiente</li>
                            <li><span class="badge bg-success badge-example">Verde</span> - Aprobada</li>
                            <li><span class="badge bg-danger badge-example">Rojo</span> - Rechazada</li>
                            <li><span class="badge bg-secondary badge-example">Gris</span> - Cancelada</li>
                        </ul>
                    </li>
                </ul>

                <div class="info-box">
                    <strong><i class="bi bi-info-circle me-2"></i>Nota importante:</strong>
                    SOLO las solicitudes con estado "Aprobada" y de categorías que consumen del saldo 
                    afectan el cálculo del saldo disponible. Las pendientes, rechazadas o canceladas no se descuentan.
                </div>

                <h4>Para actualizar la tabla:</h4>
                <ul>
                    <li>Haz clic en el botón "Actualizar" en la esquina superior derecha de la tabla</li>
                </ul>
            </div>

            <div class="step-card">
                <h3>
                    <span class="step-number">9</span>
                    Cambia a Otro Trabajador
                </h3>
                <p>
                    Cuando termines con un trabajador y necesites ajustar otro:
                </p>
                <ol>
                    <li>Haz clic en el botón <strong>"Cambiar trabajador"</strong> (parte superior derecha de la tarjeta azul)</li>
                    <li>Se ocultará toda la información del trabajador actual</li>
                    <li>Volverás a la pantalla de búsqueda</li>
                    <li>Busca y selecciona el siguiente trabajador</li>
                </ol>

                <p>
                    Alternativamente, puedes usar el botón "X" junto al campo de búsqueda para limpiar 
                    la búsqueda sin cambiar de trabajador.
                </p>
            </div>

            <div class="step-card">
                <h3>
                    <span class="step-number">10</span>
                    Limpiar el Formulario
                </h3>
                <p>
                    Si cometiste un error al llenar el formulario y quieres empezar de nuevo:
                </p>
                <ul>
                    <li>Haz clic en el botón gris <strong>"Limpiar"</strong></li>
                    <li>Esto vaciará todos los campos del formulario</li>
                    <li>NO cambiará el trabajador seleccionado</li>
                    <li>Puedes volver a completar el formulario para ese mismo trabajador</li>
                </ul>
            </div>

        </div>

        <!-- Solución de Problemas -->
        <div class="section-card">
            <h2>
                <i class="bi bi-question-circle me-2"></i>
                Solución de Problemas Comunes
            </h2>

            <div class="step-card">
                <h3><i class="bi bi-x-circle me-2 text-danger"></i>Problema 1: "No tienes permisos para acceder"</h3>
                <p><strong>Causa:</strong> Tu usuario no tiene el permiso "Ajustar saldos de ausencias".</p>
                <p><strong>Solución:</strong></p>
                <ol>
                    <li>Contacta al administrador del sistema</li>
                    <li>Solicita que te asignen el permiso correspondiente</li>
                    <li>Este permiso debe otorgarse solo a personal autorizado de Talento Humano</li>
                </ol>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-x-circle me-2 text-danger"></i>Problema 2: No encuentro al trabajador en la búsqueda</h3>
                <p><strong>Posibles causas y soluciones:</strong></p>
                <ul>
                    <li><strong>El trabajador está inactivo:</strong> Solo se muestran trabajadores activos. Si necesitas ajustar un trabajador inactivo, contacta al administrador técnico</li>
                    <li><strong>Error en el nombre:</strong> Intenta con solo el apellido o parte del documento</li>
                    <li><strong>Escribiste menos de 2 caracteres:</strong> Necesitas al menos 2 para activar la búsqueda</li>
                    <li><strong>El trabajador no existe en el sistema:</strong> Verifica en la función de gestión de trabajadores</li>
                </ul>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-x-circle me-2 text-danger"></i>Problema 3: "No se pudo obtener el email del usuario"</h3>
                <p><strong>Causa:</strong> Tu cuenta de usuario no tiene un email asociado o no se pudo recuperar.</p>
                <p><strong>Solución:</strong></p>
                <ol>
                    <li>Contacta al administrador del sistema</li>
                    <li>Verifica que tu usuario tiene un email configurado</li>
                    <li>El email debe estar registrado en la tabla de usuarios</li>
                </ol>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-x-circle me-2 text-danger"></i>Problema 4: "No se encontró su registro como trabajador"</h3>
                <p><strong>Causa:</strong> Tu usuario no está vinculado a un registro de trabajador.</p>
                <p><strong>Solución:</strong></p>
                <ol>
                    <li>Esta función requiere que tu usuario esté asociado a un trabajador</li>
                    <li>Contacta al administrador para que vincule tu usuario con tu registro de trabajador</li>
                    <li>Se hace mediante el email (debe coincidir)</li>
                </ol>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-x-circle me-2 text-danger"></i>Problema 5: No puedo ingresar cero como cantidad</h3>
                <p><strong>Causa:</strong> El sistema no permite ajustes de cero por diseño.</p>
                <p><strong>Solución:</strong></p>
                <ul>
                    <li>Esto es intencional - no tiene sentido hacer un ajuste de cero</li>
                    <li>Si quieres registrar algo para historial sin afectar el saldo, no hay opción actualmente</li>
                    <li>Ingresa la cantidad mínima (0.01) si realmente necesitas registrar algo</li>
                </ul>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-x-circle me-2 text-danger"></i>Problema 6: El saldo mostrado no coincide con mis cálculos</h3>
                <p><strong>Causas posibles:</strong></p>
                <ul>
                    <li>No estás considerando TODAS las ausencias aprobadas del trabajador</li>
                    <li>Hay ajustes previos que desconocías - revisa el historial completo</li>
                    <li>Solo las ausencias con estado "Aprobada" afectan el saldo</li>
                    <li>Solo las categorías configuradas para "controlar saldo" afectan el cálculo</li>
                </ul>
                <p><strong>Solución:</strong></p>
                <ol>
                    <li>Revisa el historial de ajustes completo</li>
                    <li>Revisa la tabla de solicitudes de ausencias aprobadas</li>
                    <li>Verifica en la configuración de categorías cuáles consumen del saldo</li>
                    <li>Si aún no coincide, contacta al equipo técnico</li>
                </ol>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-x-circle me-2 text-danger"></i>Problema 7: Hice un ajuste incorrecto, ¿cómo lo revierto?</h3>
                <p><strong>Solución:</strong></p>
                <ol>
                    <li>No hay función de "deshacer" directa</li>
                    <li>Debes hacer un ajuste manual contrario</li>
                    <li>Por ejemplo, si agregaste +10 por error, haz un ajuste de -10</li>
                    <li>En la razón, explica que es una corrección del ajuste anterior</li>
                    <li>Ambos ajustes quedarán en el historial (auditable)</li>
                </ol>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-x-circle me-2 text-danger"></i>Problema 8: La búsqueda de trabajadores no se cierra</h3>
                <p><strong>Solución:</strong></p>
                <ul>
                    <li>Haz clic en cualquier parte fuera del campo de búsqueda</li>
                    <li>La lista de resultados se cerrará automáticamente</li>
                    <li>O haz clic en la "X" del campo de búsqueda</li>
                </ul>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-x-circle me-2 text-danger"></i>Problema 9: No veo todas las solicitudes del trabajador en la tabla</h3>
                <p><strong>Causa:</strong> La tabla solo muestra las últimas 20 solicitudes por rendimiento.</p>
                <p><strong>Solución:</strong></p>
                <ul>
                    <li>Esto es intencional para no sobrecargar la interfaz</li>
                    <li>Para ver el historial completo, usa la función "Gestionar Ausencias" con filtros</li>
                    <li>O consulta directamente la base de datos si tienes acceso técnico</li>
                </ul>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-x-circle me-2 text-danger"></i>Problema 10: El botón "Aplicar Ajuste" no hace nada</h3>
                <p><strong>Causas posibles:</strong></p>
                <ul>
                    <li>Hay campos obligatorios sin completar</li>
                    <li>El navegador bloquea la acción por seguridad</li>
                    <li>Hay un error de validación que no se muestra</li>
                </ul>
                <p><strong>Solución:</strong></p>
                <ol>
                    <li>Verifica que los tres campos (Tipo, Cantidad, Razón) estén completos</li>
                    <li>Verifica que la cantidad no sea cero</li>
                    <li>Abre la consola del navegador (F12) para ver si hay errores</li>
                    <li>Recarga la página y vuelve a intentar</li>
                </ol>
            </div>

        </div>

        <!-- Buenas Prácticas -->
        <div class="section-card">
            <h2>
                <i class="bi bi-award me-2"></i>
                Buenas Prácticas y Recomendaciones
            </h2>

            <div class="step-card">
                <h3><i class="bi bi-file-text me-2"></i>Documenta detalladamente</h3>
                <ul>
                    <li>Siempre escribe razones claras, específicas y completas</li>
                    <li>Incluye referencias a políticas, documentos o aprobaciones cuando aplique</li>
                    <li>Usa terminología profesional y formal</li>
                    <li>Piensa que tu razón puede ser leída en auditorías o revisiones legales</li>
                </ul>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-search me-2"></i>Verifica antes de aplicar</h3>
                <ul>
                    <li>Revisa el historial de ajustes antes de hacer uno nuevo</li>
                    <li>Verifica que no estés duplicando un ajuste ya hecho</li>
                    <li>Confirma que el trabajador es el correcto</li>
                    <li>Revisa dos veces el signo (+ o -) de la cantidad</li>
                </ul>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-calendar-check me-2"></i>Haz ajustes anuales sistemáticamente</h3>
                <ul>
                    <li>Al inicio de cada año, planifica la asignación de saldos anuales</li>
                    <li>Usa una lista de verificación para no olvidar ningún trabajador</li>
                    <li>Considera hacer ajustes en lote (todos el mismo día)</li>
                    <li>Usa razones consistentes para facilitar auditorías</li>
                </ul>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-calculator me-2"></i>Calcula proporcionales correctamente</h3>
                <ul>
                    <li>Para trabajadores que ingresan durante el año, calcula el proporcional</li>
                    <li>Fórmula: (Saldo anual / 12 meses) × Meses restantes</li>
                    <li>Ejemplo: Si ingresa en julio, corresponden 6 meses = 50% del saldo anual</li>
                    <li>Documenta claramente el cálculo en la razón</li>
                </ul>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-exclamation-triangle me-2"></i>Maneja saldos negativos proactivamente</h3>
                <ul>
                    <li>Si ves saldos negativos (en rojo), investiga por qué</li>
                    <li>Determina si es un error o una situación excepcional aprobada</li>
                    <li>Coordina con el trabajador y su jefe para regularizar</li>
                    <li>Documenta el plan de recuperación del saldo</li>
                </ul>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-people me-2"></i>Comunica con los trabajadores</h3>
                <ul>
                    <li>Informa a los trabajadores cuando hagas ajustes a sus saldos</li>
                    <li>Explica claramente el porqué del ajuste</li>
                    <li>Proporciona documentación si lo solicitan</li>
                    <li>Mantén registros paralelos en físico si es política institucional</li>
                </ul>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-graph-up me-2"></i>Monitorea patrones</h3>
                <ul>
                    <li>Identifica trabajadores que frecuentemente llegan a saldo cero</li>
                    <li>Detecta posibles abusos o malentendidos de la política</li>
                    <li>Reporta patrones inusuales a las directivas</li>
                    <li>Usa esta información para mejorar políticas</li>
                </ul>
            </div>

            <div class="step-card">
                <h3><i class="bi bi-shield-check me-2"></i>Mantén consistencia</h3>
                <ul>
                    <li>Aplica las mismas políticas a todos los trabajadores</li>
                    <li>No hagas excepciones sin documentación y aprobación formal</li>
                    <li>Usa el mismo formato de razones para situaciones similares</li>
                    <li>Mantén registros de decisiones especiales para referencia futura</li>
                </ul>
            </div>

        </div>

        <!-- Preguntas Frecuentes -->
        <div class="section-card">
            <h2>
                <i class="bi bi-chat-dots me-2"></i>
                Preguntas Frecuentes
            </h2>

            <div class="step-card">
                <h3>1. ¿Cuál es la diferencia entre un ajuste y una ausencia aprobada?</h3>
                <p>
                    <strong>Ajustes:</strong> Son modificaciones manuales del saldo "disponible" que haces desde 
                    esta función. Por ejemplo, asignar las 24 horas anuales al inicio de año.
                </p>
                <p>
                    <strong>Ausencias aprobadas:</strong> Son solicitudes de ausencias que los trabajadores hacen 
                    y que al aprobarse CONSUMEN del saldo. Por ejemplo, si usan 3 horas personales.
                </p>
                <p>
                    El <strong>saldo final</strong> = Ajustes - Ausencias Aprobadas
                </p>
            </div>

            <div class="step-card">
                <h3>2. ¿Puedo hacer ajustes retroactivos?</h3>
                <p>
                    <strong>Sí.</strong> Los ajustes no tienen fecha de vigencia futura, se aplican inmediatamente 
                    al saldo actual. Si necesitas registrar que un ajuste era para un período pasado, menciona 
                    la fecha en la razón (ejemplo: "Ajuste retroactivo correspondiente al período enero-marzo 2024").
                </p>
            </div>

            <div class="step-card">
                <h3>3. ¿Qué hago si un trabajador tiene saldo negativo?</h3>
                <p>
                    Un saldo negativo significa que el trabajador usó más tiempo del que tenía asignado. Opciones:
                </p>
                <ul>
                    <li><strong>Opción A:</strong> Hacer un ajuste positivo para regularizar (si está aprobado por dirección)</li>
                    <li><strong>Opción B:</strong> Descontar de nómina según políticas institucionales</li>
                    <li><strong>Opción C:</strong> Compensar con trabajo adicional (si lo permiten las políticas)</li>
                    <li><strong>Opción D:</strong> Dejar que se descuente del saldo del año siguiente</li>
                </ul>
            </div>

            <div class="step-card">
                <h3>4. ¿Los ajustes se pueden eliminar o editar?</h3>
                <p>
                    <strong>No directamente.</strong> Una vez aplicado, un ajuste queda permanente en el historial 
                    por temas de auditoría. Si cometiste un error, debes hacer un ajuste contrario (reversa) y 
                    documentar que es una corrección.
                </p>
            </div>

            <div class="step-card">
                <h3>5. ¿Todas las ausencias aprobadas descuentan del saldo?</h3>
                <p>
                    <strong>No.</strong> Solo las ausencias de categorías configuradas para controlar saldo:
                </p>
                <ul>
                    <li>Las que tienen "Acumula horas personales" activado descuentan de ese saldo</li>
                    <li>Las que tienen "Controla días de calamidad" activado descuentan de ese saldo</li>
                    <li>Incapacidades médicas típicamente NO descuentan (depende de la configuración)</li>
                </ul>
            </div>

            <div class="step-card">
                <h3>6. ¿Cuándo debo asignar el saldo anual?</h3>
                <p>
                    <strong>Recomendación:</strong> Al inicio de cada año (enero). Esto permite a los trabajadores 
                    planificar su uso durante todo el año. Algunas instituciones lo hacen en el aniversario de 
                    ingreso de cada trabajador, dependiendo de la política.
                </p>
            </div>

            <div class="step-card">
                <h3>7. ¿Puedo ver quién hizo cada ajuste en el historial?</h3>
                <p>
                    <strong>Sí.</strong> Cada entrada en el historial muestra el nombre del trabajador que realizó 
                    el ajuste (el nombre de usuario que estaba logueado). Esta información es crucial para auditorías.
                </p>
            </div>

            <div class="step-card">
                <h3>8. ¿Los saldos se transfieren al año siguiente?</h3>
                <p>
                    <strong>Depende de la política institucional.</strong> El sistema no borra automáticamente 
                    los saldos. Si la política dice que NO se transfieren:
                </p>
                <ul>
                    <li>Debes hacer ajustes negativos al final del año para llevar a cero</li>
                    <li>Luego hacer ajustes positivos al inicio del nuevo año</li>
                </ul>
                <p>Si SÍ se transfieren, simplemente agrega el nuevo saldo anual al existente.</p>
            </div>

            <div class="step-card">
                <h3>9. ¿Puedo ajustar saldos de trabajadores inactivos?</h3>
                <p>
                    <strong>No desde esta función.</strong> La búsqueda solo muestra trabajadores activos. 
                    Si necesitas ajustar un trabajador inactivo (por ejemplo, para liquidación final), 
                    deberás pedir al administrador técnico que lo haga directamente en la base de datos.
                </p>
            </div>

            <div class="step-card">
                <h3>10. ¿Hay un límite en cuánto puedo ajustar?</h3>
                <p>
                    <strong>No hay límite técnico.</strong> Puedes agregar o restar cualquier cantidad. 
                    Sin embargo, debes seguir las políticas institucionales y tener aprobación para 
                    ajustes inusuales o muy grandes.
                </p>
            </div>

            <div class="step-card">
                <h3>11. ¿Los trabajadores pueden ver sus propios saldos?</h3>
                <p>
                    <strong>Sí.</strong> Cuando un trabajador entra a "Solicitar Ausencias", ve sus saldos 
                    disponibles en tiempo real. Esto fomenta la transparencia y reduce consultas.
                </p>
            </div>

            <div class="step-card">
                <h3>12. ¿Qué pasa si dos personas ajustan el mismo trabajador simultáneamente?</h3>
                <p>
                    Ambos ajustes se aplicarán, ya que se suman algebraicamente. Por ejemplo, si una persona 
                    agrega +10 y otra agrega +5, el trabajador tendrá +15 total. Por eso es importante 
                    coordinarse en el equipo de RRHH.
                </p>
            </div>

            <div class="step-card">
                <h3>13. ¿Puedo exportar el historial de ajustes?</h3>
                <p>
                    <strong>No directamente desde esta función.</strong> Si necesitas un reporte de ajustes, 
                    deberás consultar la base de datos directamente o solicitar al equipo técnico que genere 
                    un reporte personalizado.
                </p>
            </div>

            <div class="step-card">
                <h3>14. ¿Los ajustes afectan a nómina automáticamente?</h3>
                <p>
                    <strong>No.</strong> Esta función solo gestiona los saldos para control de ausencias. 
                    Los aspectos de nómina (pagos, descuentos) se manejan en otros sistemas. Si una ausencia 
                    debe generar descuentos, es responsabilidad de RRHH hacer el proceso correspondiente en nómina.
                </p>
            </div>

            <div class="step-card">
                <h3>15. ¿Qué hago si el sistema muestra un saldo incorrecto incluso después de revisar todo?</h3>
                <p>
                    Si después de verificar el historial y las ausencias el saldo aún parece incorrecto:
                </p>
                <ol>
                    <li>Toma capturas de pantalla de las inconsistencias</li>
                    <li>Documenta exactamente qué esperabas vs qué muestra</li>
                    <li>Contacta al equipo de soporte técnico</li>
                    <li>Puede ser un error en la configuración de categorías o un bug del sistema</li>
                </ol>
            </div>

        </div>

        <!-- Tarjeta de Reporte de Bugs -->
        <div class="bug-report-card">
            <i class="bi bi-bug-fill" style="font-size: 3rem; color: #dc3545;"></i>
            <h3 class="mt-3 mb-3">¿Encontraste un problema o bug?</h3>
            <p class="mb-4">
                Si algo no funciona correctamente o tienes algún inconveniente con esta función, 
                puedes reportarlo a través de nuestro sistema de reporte de errores.
            </p>
            <a href="../report-bug.html" class="btn btn-light btn-lg">
                <i class="bi bi-exclamation-triangle me-2"></i>
                Reportar Bug o Problema
            </a>
        </div>

        <!-- Botón Flotante -->
        <a href="../report-bug.html" class="btn btn-danger btn-lg floating-bug-button" 
           title="Reportar un problema">
            <i class="bi bi-bug-fill me-2"></i>
            Reportar Bug
        </a>

    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Configuración de la página para futuras funcionalidades
        const PAGE_CONFIG = {
            moduleName: 'Talento Humano',
            modulePath: 'hr',
            pageTitle: 'Ajustar Saldos',
            pagePath: 'adjust-balances.html',
            moduleDescription: 'Gestión manual de saldos de horas personales y días de calamidad'
        };

        // Log de carga de la página
        console.log('📖 Manual cargado:', PAGE_CONFIG.pageTitle);
        console.log('📂 Módulo:', PAGE_CONFIG.moduleName);
    </script>
</body>
</html>
