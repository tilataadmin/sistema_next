<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- VERSIÓN DE LA PÁGINA -->
    <meta name="page-version" content="25.06.11.20.30">
    
    <title>Manual - Indicadores - Tablero de Mejora - SchoolNet</title>
    
    <!-- Bootstrap CSS - VERSIÓN FIJA PROBADA -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-overlay.hidden {
            display: none;
        }
        
        .loading-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Encabezado discreto */
        .manual-header {
            background: #f8f9fa;
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding: 1.5rem 0;
            margin-bottom: 2rem;
        }

        .manual-header h1 {
            font-size: 1.75rem;
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 0.25rem;
        }

        .manual-header .subtitle {
            color: #6c757d;
            font-size: 0.95rem;
        }

        /* Info card */
        .info-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Tarjeta para reportar bugs */
        .bug-report-card {
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .bug-report-card h5 {
            color: white;
        }

        /* Botón flotante para reportar bugs */
        .floating-bug-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            background: var(--system-primary-color, #dc3545) !important;
            border-color: var(--system-primary-color, #dc3545) !important;
        }

        .floating-bug-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
            opacity: 0.9;
        }

        .icon-large {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        /* Estilos para el contenido del manual */
        .section-title {
            color: var(--system-primary-color, #1B365D);
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            margin-top: 2rem;
        }

        .step-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 0.75rem;
        }

        .feature-list li {
            margin-bottom: 0.5rem;
        }

        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #0d6efd;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .success-box {
            background: #d1e7dd;
            border-left: 4px solid #198754;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        /* KPI Cards Preview */
        .kpi-card-preview {
            background: white;
            border-radius: 12px;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            text-align: center;
            height: 100%;
        }

        .kpi-icon-preview {
            font-size: 1.5rem;
            margin-bottom: 0.25rem;
        }

        .kpi-value-preview {
            font-size: 1.75rem;
            font-weight: 700;
            margin: 0.25rem 0;
        }

        .kpi-label-preview {
            font-size: 0.75rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .kpi-trend-preview {
            font-size: 0.75rem;
            margin-top: 0.25rem;
        }

        .kpi-trend-preview.positive { color: #10b981; }
        .kpi-trend-preview.negative { color: #ef4444; }
        .kpi-trend-preview.neutral { color: #6b7280; }

        /* Chart placeholder */
        .chart-placeholder {
            height: 150px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
            margin: 0.5rem 0;
        }

        /* Activity timeline preview */
        .activity-timeline-preview {
            position: relative;
            padding-left: 2rem;
        }

        .activity-timeline-preview::before {
            content: '';
            position: absolute;
            left: 0.5rem;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #e2e8f0;
        }

        .activity-item-preview {
            position: relative;
            margin-bottom: 1rem;
            padding-left: 1rem;
        }

        .activity-item-preview::before {
            content: '';
            position: absolute;
            left: -1.35rem;
            top: 0.5rem;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #667eea;
        }

        .activity-icon-preview {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            margin-right: 0.5rem;
            font-size: 0.8rem;
        }

        .activity-icon-preview.plan { background: rgba(102, 126, 234, 0.1); color: #667eea; }
        .activity-icon-preview.note { background: rgba(16, 185, 129, 0.1); color: #10b981; }
        .activity-icon-preview.update { background: rgba(245, 158, 11, 0.1); color: #f59e0b; }

        .faq-item {
            margin-bottom: 1rem;
        }

        .faq-item h6 {
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 0.5rem;
        }
    </style>
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="mb-0">Cargando...</p>
        </div>
    </div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="container-fluid">

        <!-- ENCABEZADO DISCRETO -->
        <div class="manual-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1>
                            <i class="bi bi-book me-2"></i>
                            Manual: Indicadores
                        </h1>
                        <p class="subtitle mb-0">Tablero de Mejora</p>
                    </div>
                    <div class="col-md-4 text-md-end mt-3 mt-md-0">
                        <a href="../../modules/indicators/improvement-dashboard.html" class="btn btn-outline-primary">
                            <i class="bi bi-arrow-left me-1"></i>Volver al Módulo
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- CONTENEDOR DE ALERTAS -->
        <div id="alertContainer"></div>

        <div class="row">
            <div class="col-lg-8 mx-auto">

                <!-- INFORMACIÓN CONTEXTUAL -->
                <div class="info-card">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h6 class="text-muted mb-2">Manual de:</h6>
                            <h5 class="mb-1"><strong id="display-module">Indicadores</strong></h5>
                            <p class="text-muted mb-0 small" id="display-page">Tablero de Mejora</p>
                        </div>
                        <div class="col-md-6 text-md-end mt-3 mt-md-0">
                            <p class="small text-muted mb-0">
                                <i class="bi bi-info-circle me-1"></i>
                                Si tienes dudas o encuentras algún problema,<br>
                                puedes reportarlo usando el botón de abajo.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ========================================== -->
                <!-- CONTENIDO DEL MANUAL -->
                <!-- ========================================== -->

                <!-- SECCIÓN 1: ¿QUÉ ES? -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-clipboard-data me-2"></i>
                        ¿Qué es el Tablero de Mejora?
                    </h2>
                    
                    <div class="step-card">
                        <p class="lead">
                            El Tablero de Mejora es un <strong>dashboard analítico</strong> que presenta 
                            una vista consolidada del estado de todos los planes de mejora, la actividad 
                            reciente y las métricas clave del proceso de mejora continua.
                        </p>
                        
                        <p>
                            A diferencia de "Gestión de Mejora" donde creas y trabajas con planes 
                            individuales, este tablero te ofrece una <strong>visión ejecutiva</strong> 
                            del estado general: cuántos planes están activos, cuántos se han completado, 
                            quiénes son los principales contribuidores y cómo ha evolucionado la 
                            actividad en el tiempo.
                        </p>

                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>¿Para quién es útil?</strong>
                            <ul class="mb-0 mt-2">
                                <li><strong>Directivos:</strong> Para monitorear el progreso institucional de mejora</li>
                                <li><strong>Coordinadores:</strong> Para identificar indicadores que necesitan atención</li>
                                <li><strong>Equipos de calidad:</strong> Para preparar informes de seguimiento</li>
                                <li><strong>Cualquier usuario:</strong> Para tener contexto general antes de trabajar en mejoras</li>
                            </ul>
                        </div>

                        <p>
                            Este es un tablero de <strong>solo lectura</strong>. Para crear planes, 
                            agregar notas o realizar acciones, debes ir a "Gestión de Mejora".
                        </p>
                    </div>
                </section>

                <!-- SECCIÓN 2: CARACTERÍSTICAS PRINCIPALES -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-star me-2"></i>
                        Características principales
                    </h2>
                    
                    <div class="step-card">
                        <ul class="feature-list">
                            <li>
                                <strong>KPIs con tendencias:</strong> 4 indicadores clave que comparan 
                                el período actual con el anterior
                            </li>
                            <li>
                                <strong>Gráficos interactivos:</strong> Visualización de estado de planes, 
                                actividad en el tiempo y rankings
                            </li>
                            <li>
                                <strong>Timeline de actividad:</strong> Historial cronológico de las 
                                últimas acciones realizadas
                            </li>
                            <li>
                                <strong>Tabla de planes:</strong> Listado completo con acceso rápido 
                                a detalles
                            </li>
                            <li>
                                <strong>Filtros flexibles:</strong> Por período, indicador o estado 
                                del plan
                            </li>
                            <li>
                                <strong>Actualización en tiempo real:</strong> Botón para refrescar 
                                los datos sin recargar la página
                            </li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN 3: LOS 4 KPIs -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-speedometer2 me-2"></i>
                        Los 4 indicadores clave (KPIs)
                    </h2>
                    
                    <div class="step-card">
                        <p>
                            En la parte superior del tablero encontrarás 4 tarjetas con métricas 
                            principales. Cada una muestra el valor actual y una tendencia comparativa:
                        </p>

                        <div class="row g-2 mb-3">
                            <div class="col-6 col-md-3">
                                <div class="kpi-card-preview">
                                    <div class="kpi-icon-preview text-primary">
                                        <i class="bi bi-play-circle-fill"></i>
                                    </div>
                                    <div class="kpi-value-preview text-primary">8</div>
                                    <div class="kpi-label-preview">Planes Activos</div>
                                    <div class="kpi-trend-preview positive">
                                        <i class="bi bi-arrow-up"></i> +2 (33%)
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md-3">
                                <div class="kpi-card-preview">
                                    <div class="kpi-icon-preview text-success">
                                        <i class="bi bi-check-circle-fill"></i>
                                    </div>
                                    <div class="kpi-value-preview text-success">12</div>
                                    <div class="kpi-label-preview">Completados</div>
                                    <div class="kpi-trend-preview positive">
                                        <i class="bi bi-arrow-up"></i> +3 (25%)
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md-3">
                                <div class="kpi-card-preview">
                                    <div class="kpi-icon-preview text-info">
                                        <i class="bi bi-speedometer2"></i>
                                    </div>
                                    <div class="kpi-value-preview text-info">15</div>
                                    <div class="kpi-label-preview">Con Planes</div>
                                    <div class="kpi-trend-preview neutral">
                                        <i class="bi bi-dash"></i> Sin cambios
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md-3">
                                <div class="kpi-card-preview">
                                    <div class="kpi-icon-preview text-warning">
                                        <i class="bi bi-list-task"></i>
                                    </div>
                                    <div class="kpi-value-preview text-warning">24</div>
                                    <div class="kpi-label-preview">Tareas</div>
                                    <div class="kpi-trend-preview negative">
                                        <i class="bi bi-arrow-down"></i> -5 (17%)
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead class="table-light">
                                    <tr>
                                        <th>KPI</th>
                                        <th>Qué mide</th>
                                        <th>Acción al hacer clic</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><span class="text-primary"><i class="bi bi-play-circle-fill me-1"></i></span>Planes Activos</td>
                                        <td>Cantidad de planes en estado "Activo"</td>
                                        <td>Filtra la tabla para mostrar solo activos</td>
                                    </tr>
                                    <tr>
                                        <td><span class="text-success"><i class="bi bi-check-circle-fill me-1"></i></span>Planes Completados</td>
                                        <td>Planes que se han marcado como completados</td>
                                        <td>Filtra la tabla para mostrar solo completados</td>
                                    </tr>
                                    <tr>
                                        <td><span class="text-info"><i class="bi bi-speedometer2 me-1"></i></span>Indicadores con Planes</td>
                                        <td>Cuántos indicadores tienen al menos un plan</td>
                                        <td>Sin acción</td>
                                    </tr>
                                    <tr>
                                        <td><span class="text-warning"><i class="bi bi-list-task me-1"></i></span>Tareas Vinculadas</td>
                                        <td>Total de tareas asociadas a planes de mejora</td>
                                        <td>Sin acción</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>¿Cómo se calcula la tendencia?</strong>
                            <p class="mb-0 mt-2">
                                La tendencia compara el período actual con el período anterior de igual duración. 
                                Por ejemplo, si seleccionas "Últimos 90 días", se compara con los 90 días anteriores 
                                a ese rango. Los colores indican:
                            </p>
                            <ul class="mb-0 mt-2">
                                <li><span class="text-success">Verde con flecha arriba:</span> Aumento respecto al período anterior</li>
                                <li><span class="text-danger">Rojo con flecha abajo:</span> Disminución respecto al período anterior</li>
                                <li><span class="text-muted">Gris:</span> Sin cambios o sin datos para comparar</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN 4: LOS GRÁFICOS -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-bar-chart me-2"></i>
                        Los 4 gráficos del tablero
                    </h2>
                    
                    <div class="step-card">
                        <p>
                            El tablero incluye 4 gráficos que se actualizan automáticamente 
                            según los filtros aplicados:
                        </p>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="card h-100">
                                    <div class="card-header">
                                        <i class="bi bi-pie-chart me-2"></i>Estado de Planes
                                    </div>
                                    <div class="card-body">
                                        <div class="chart-placeholder">
                                            <i class="bi bi-pie-chart" style="font-size: 2rem;"></i>
                                        </div>
                                        <p class="small text-muted mb-0">
                                            <strong>Gráfico de dona</strong> que muestra la distribución 
                                            de planes por estado: Activo, Completado, Borrador, Cancelado.
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="card h-100">
                                    <div class="card-header">
                                        <i class="bi bi-graph-up me-2"></i>Actividad en el Tiempo
                                    </div>
                                    <div class="card-body">
                                        <div class="chart-placeholder">
                                            <i class="bi bi-graph-up" style="font-size: 2rem;"></i>
                                        </div>
                                        <p class="small text-muted mb-0">
                                            <strong>Gráfico de líneas</strong> con 3 series: Notas agregadas, 
                                            Actualizaciones y Planes creados, por los últimos 6 meses.
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="card h-100">
                                    <div class="card-header">
                                        <i class="bi bi-bar-chart me-2"></i>Top 5 Indicadores
                                    </div>
                                    <div class="card-body">
                                        <div class="chart-placeholder">
                                            <i class="bi bi-bar-chart-steps" style="font-size: 2rem;"></i>
                                        </div>
                                        <p class="small text-muted mb-0">
                                            <strong>Barras horizontales</strong> mostrando los 5 indicadores 
                                            que tienen más planes de mejora asociados.
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="card h-100">
                                    <div class="card-header">
                                        <i class="bi bi-people-fill me-2"></i>Top 5 Contribuidores
                                    </div>
                                    <div class="card-body">
                                        <div class="chart-placeholder">
                                            <i class="bi bi-people" style="font-size: 2rem;"></i>
                                        </div>
                                        <p class="small text-muted mb-0">
                                            <strong>Barras horizontales</strong> mostrando los 5 usuarios 
                                            con más contribuciones (notas, actualizaciones, planes).
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN 5: ANTES DE COMENZAR -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-clipboard-check me-2"></i>
                        Antes de comenzar
                    </h2>
                    
                    <div class="step-card">
                        <h5>Requisitos previos:</h5>
                        <ul>
                            <li>Tener acceso al módulo de Indicadores</li>
                            <li>Tener el permiso "Tablero de mejora" asignado</li>
                        </ul>

                        <h5 class="mt-4">Ten en cuenta:</h5>
                        <ul>
                            <li>Este tablero es de <strong>solo lectura</strong></li>
                            <li>Los datos se cargan automáticamente al entrar</li>
                            <li>Puedes usar el botón "Actualizar" para refrescar sin recargar</li>
                            <li>Para realizar acciones, usa el botón "Ir a Gestión de Mejora"</li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN 6: GUÍA PASO A PASO -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-list-ol me-2"></i>
                        Guía paso a paso
                    </h2>

                    <!-- Paso 1 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">1</span>
                            Ajustar los filtros
                        </h4>
                        
                        <p>En la parte superior encontrarás 3 filtros:</p>

                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label class="form-label fw-bold">Período de Análisis</label>
                                <select class="form-select form-select-sm" disabled>
                                    <option>Últimos 90 días</option>
                                </select>
                                <small class="text-muted">30, 60, 90, 180 días, 1 año o todo</small>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-bold">Indicador</label>
                                <select class="form-select form-select-sm" disabled>
                                    <option>Todos los indicadores</option>
                                </select>
                                <small class="text-muted">Filtra planes de un indicador específico</small>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-bold">Estado del Plan</label>
                                <select class="form-select form-select-sm" disabled>
                                    <option>Todos los estados</option>
                                </select>
                                <small class="text-muted">Borrador, Activo, Completado, Cancelado</small>
                            </div>
                        </div>

                        <p>
                            Al cambiar cualquier filtro, todo el tablero se actualiza automáticamente: 
                            KPIs, gráficos, timeline y tabla de planes.
                        </p>

                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>Tip:</strong>
                            El período seleccionado afecta cómo se calculan las tendencias. Un período 
                            más largo dará una visión más estable, mientras que uno corto mostrará 
                            cambios más recientes.
                        </div>
                    </div>

                    <!-- Paso 2 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">2</span>
                            Revisar los KPIs
                        </h4>
                        
                        <p>
                            Los 4 KPIs en la parte superior te dan un resumen ejecutivo inmediato:
                        </p>

                        <ul>
                            <li>El <strong>número grande</strong> es el valor actual</li>
                            <li>La <strong>tendencia</strong> muestra el cambio respecto al período anterior</li>
                            <li>Haz clic en "Planes Activos" o "Completados" para filtrar la tabla</li>
                        </ul>

                        <div class="warning-box">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Interpretación:</strong>
                            Un aumento en "Planes Activos" puede significar que hay mucho trabajo en progreso, 
                            mientras que un aumento en "Completados" indica que los equipos están cerrando 
                            sus planes de mejora exitosamente.
                        </div>
                    </div>

                    <!-- Paso 3 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">3</span>
                            Analizar los gráficos
                        </h4>
                        
                        <p><strong>Estado de Planes (Dona):</strong></p>
                        <ul>
                            <li>Muestra la proporción de planes en cada estado</li>
                            <li>Ideal para ver si hay muchos planes estancados en "Borrador"</li>
                        </ul>

                        <p><strong>Actividad en el Tiempo (Líneas):</strong></p>
                        <ul>
                            <li>Identifica tendencias: ¿está aumentando la actividad?</li>
                            <li>Compara los 3 tipos de actividad mes a mes</li>
                            <li>Útil para detectar meses con poca participación</li>
                        </ul>

                        <p><strong>Top 5 Indicadores:</strong></p>
                        <ul>
                            <li>Muestra qué indicadores tienen más planes de mejora</li>
                            <li>Útil para identificar áreas con mayor foco institucional</li>
                        </ul>

                        <p><strong>Top 5 Contribuidores:</strong></p>
                        <ul>
                            <li>Reconoce a los usuarios más activos</li>
                            <li>Útil para identificar líderes de mejora continua</li>
                        </ul>
                    </div>

                    <!-- Paso 4 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">4</span>
                            Revisar la actividad reciente
                        </h4>
                        
                        <p>
                            El timeline muestra las últimas 15 acciones realizadas en el sistema:
                        </p>

                        <div class="activity-timeline-preview">
                            <div class="activity-item-preview">
                                <div class="d-flex align-items-start">
                                    <span class="activity-icon-preview note">
                                        <i class="bi bi-chat-left-text-fill"></i>
                                    </span>
                                    <div>
                                        <div class="small">
                                            <strong>María García</strong> agregó una nota en Tasa de Aprobación
                                        </div>
                                        <div class="text-muted" style="font-size: 0.75rem;">hace 2 horas</div>
                                    </div>
                                </div>
                            </div>
                            <div class="activity-item-preview">
                                <div class="d-flex align-items-start">
                                    <span class="activity-icon-preview update">
                                        <i class="bi bi-pencil-square"></i>
                                    </span>
                                    <div>
                                        <div class="small">
                                            <strong>Juan Pérez</strong> actualizó el plan "Plan Q1 2025"
                                        </div>
                                        <div class="text-muted" style="font-size: 0.75rem;">hace 5 horas</div>
                                    </div>
                                </div>
                            </div>
                            <div class="activity-item-preview">
                                <div class="d-flex align-items-start">
                                    <span class="activity-icon-preview plan">
                                        <i class="bi bi-plus-circle-fill"></i>
                                    </span>
                                    <div>
                                        <div class="small">
                                            <strong>Ana López</strong> creó el plan "Mejora Deserción"
                                        </div>
                                        <div class="text-muted" style="font-size: 0.75rem;">ayer</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <p class="mt-3"><strong>Tipos de actividad:</strong></p>
                        <ul>
                            <li><span class="activity-icon-preview note me-1"><i class="bi bi-chat-left-text-fill"></i></span> <strong>Notas:</strong> Cuando alguien agrega una nota de análisis</li>
                            <li><span class="activity-icon-preview update me-1"><i class="bi bi-pencil-square"></i></span> <strong>Actualizaciones:</strong> Cuando se reporta progreso en un plan</li>
                            <li><span class="activity-icon-preview plan me-1"><i class="bi bi-plus-circle-fill"></i></span> <strong>Planes:</strong> Cuando se crea un nuevo plan de mejora</li>
                        </ul>
                    </div>

                    <!-- Paso 5 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">5</span>
                            Explorar la tabla de planes
                        </h4>
                        
                        <p>
                            La tabla en la parte inferior lista todos los planes según los filtros:
                        </p>

                        <div class="table-responsive">
                            <table class="table table-bordered table-sm">
                                <thead class="table-light">
                                    <tr>
                                        <th>Plan</th>
                                        <th>Indicador</th>
                                        <th>Estado</th>
                                        <th>Tareas</th>
                                        <th>Actualización</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>Plan Q1 2025</strong></td>
                                        <td>Tasa de Aprobación</td>
                                        <td><span class="badge bg-primary">Activo</span></td>
                                        <td class="text-center">3</td>
                                        <td>10/06/2025</td>
                                        <td><button class="btn btn-sm btn-outline-primary" disabled><i class="bi bi-eye"></i></button></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Reducir Deserción</strong></td>
                                        <td>Tasa de Deserción</td>
                                        <td><span class="badge bg-success">Completado</span></td>
                                        <td class="text-center">5</td>
                                        <td>05/06/2025</td>
                                        <td><button class="btn btn-sm btn-outline-primary" disabled><i class="bi bi-eye"></i></button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <p class="mt-3">
                            <strong>Acciones disponibles:</strong>
                        </p>
                        <ul>
                            <li>Haz clic en cualquier fila para ver los detalles del plan</li>
                            <li>El botón <i class="bi bi-eye"></i> abre un modal con información completa</li>
                        </ul>
                    </div>

                    <!-- Paso 6 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">6</span>
                            Ver detalles de un plan
                        </h4>
                        
                        <p>
                            Al hacer clic en un plan, se abre un modal con información detallada:
                        </p>

                        <ul>
                            <li>Nombre del plan y estado</li>
                            <li>Indicador asociado</li>
                            <li>Meta vinculada (período y valor)</li>
                            <li>Objetivo del plan</li>
                            <li>Estrategia definida</li>
                            <li>Cantidad de tareas vinculadas</li>
                            <li>Creador y fecha</li>
                        </ul>

                        <p>
                            Desde el modal puedes hacer clic en <strong>"Ir a Gestión de Mejora"</strong> 
                            para trabajar directamente con ese plan.
                        </p>
                    </div>
                </section>

                <!-- SECCIÓN 7: SOLUCIÓN DE PROBLEMAS -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-question-circle me-2"></i>
                        Solución de problemas comunes
                    </h2>

                    <div class="step-card">
                        <h5>Los gráficos no muestran datos</h5>
                        <ul>
                            <li>Verifica que existan planes de mejora en el sistema</li>
                            <li>Revisa los filtros aplicados (pueden estar muy restrictivos)</li>
                            <li>Usa el botón "Actualizar" para refrescar los datos</li>
                        </ul>

                        <h5 class="mt-4">Las tendencias dicen "Sin datos previos"</h5>
                        <ul>
                            <li>No hay suficientes datos históricos para comparar</li>
                            <li>El período seleccionado es muy largo (prueba con uno más corto)</li>
                            <li>El sistema es nuevo y no hay período anterior</li>
                        </ul>

                        <h5 class="mt-4">La tabla está vacía</h5>
                        <ul>
                            <li>No hay planes que coincidan con los filtros</li>
                            <li>Haz clic en "Limpiar" para resetear los filtros</li>
                            <li>Verifica que existan planes en "Gestión de Mejora"</li>
                        </ul>

                        <h5 class="mt-4">El timeline dice "No hay actividad reciente"</h5>
                        <ul>
                            <li>No se han realizado acciones en el período seleccionado</li>
                            <li>Amplía el período de análisis</li>
                            <li>Los usuarios no han agregado notas ni actualizaciones</li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN 8: BUENAS PRÁCTICAS -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-check2-circle me-2"></i>
                        Buenas prácticas
                    </h2>

                    <div class="step-card">
                        <ul class="feature-list">
                            <li>
                                <strong>Revisa regularmente:</strong> Consulta el tablero al menos 
                                una vez por semana para monitorear el progreso
                            </li>
                            <li>
                                <strong>Usa diferentes períodos:</strong> Compara vista de 30 días 
                                (corto plazo) con 90 días (mediano plazo) para diferentes perspectivas
                            </li>
                            <li>
                                <strong>Identifica patrones:</strong> Usa el gráfico de actividad 
                                para detectar meses con poca participación
                            </li>
                            <li>
                                <strong>Reconoce contribuidores:</strong> El ranking de contribuidores 
                                puede usarse para reconocer el esfuerzo del equipo
                            </li>
                            <li>
                                <strong>Filtra por indicador:</strong> Si eres responsable de un 
                                indicador específico, filtra para ver solo sus planes
                            </li>
                            <li>
                                <strong>Complementa con Gestión:</strong> Este tablero es para 
                                visualizar; usa "Gestión de Mejora" para actuar
                            </li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN 9: PREGUNTAS FRECUENTES -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-chat-dots me-2"></i>
                        Preguntas frecuentes
                    </h2>

                    <div class="step-card">
                        <div class="faq-item">
                            <h6>¿Puedo crear planes desde este tablero?</h6>
                            <p>
                                No, este tablero es de solo lectura. Para crear planes, 
                                ve a "Gestión de Mejora" usando el botón en la esquina superior.
                            </p>
                        </div>

                        <div class="faq-item">
                            <h6>¿Cada cuánto se actualizan los datos?</h6>
                            <p>
                                Los datos se cargan cuando entras a la página. Para obtener datos 
                                más recientes, usa el botón "Actualizar" en la parte superior.
                            </p>
                        </div>

                        <div class="faq-item">
                            <h6>¿Qué significa "Sin datos previos" en la tendencia?</h6>
                            <p>
                                Significa que no hay datos del período anterior para comparar. 
                                Esto ocurre cuando el sistema es nuevo o cuando seleccionas 
                                "Todo el tiempo" como período.
                            </p>
                        </div>

                        <div class="faq-item">
                            <h6>¿Por qué algunos indicadores no aparecen en el Top 5?</h6>
                            <p>
                                Solo aparecen los 5 indicadores con más planes asociados. 
                                Si un indicador no tiene planes o tiene muy pocos, 
                                no aparecerá en el ranking.
                            </p>
                        </div>

                        <div class="faq-item">
                            <h6>¿Las tareas vinculadas incluyen las canceladas?</h6>
                            <p>
                                No, el conteo de tareas excluye las que están en estado "Cancelado". 
                                Solo cuenta tareas pendientes, en progreso, completadas o bloqueadas.
                            </p>
                        </div>

                        <div class="faq-item">
                            <h6>¿Puedo exportar los datos del tablero?</h6>
                            <p>
                                Actualmente no hay función de exportación directa. 
                                Puedes tomar capturas de pantalla o copiar datos manualmente.
                            </p>
                        </div>

                        <div class="faq-item">
                            <h6>¿Por qué la actividad solo muestra los últimos 6 meses?</h6>
                            <p>
                                El gráfico de líneas está diseñado para mostrar tendencias recientes. 
                                Para análisis de períodos más largos, revisa los KPIs con 
                                el filtro en "Todo el tiempo".
                            </p>
                        </div>

                        <div class="faq-item">
                            <h6>¿Cómo se calcula quién es "contribuidor"?</h6>
                            <p>
                                Se suman todas las acciones de un usuario: notas agregadas, 
                                actualizaciones de planes y planes creados. El total determina 
                                su posición en el ranking.
                            </p>
                        </div>
                    </div>
                </section>

                <!-- ========================================== -->
                <!-- FIN DEL CONTENIDO DEL MANUAL -->
                <!-- ========================================== -->

                <!-- TARJETA PARA REPORTAR BUGS -->
                <div class="bug-report-card">
                    <i class="bi bi-bug-fill icon-large"></i>
                    <h4 class="mb-3">¿Encontraste un problema o tienes una sugerencia?</h4>
                    <p class="mb-4">
                        Si experimentaste un error, algo no funciona como esperas, o tienes 
                        una sugerencia para mejorar el sistema, repórtalo aquí.
                    </p>
                    <a href="../report-bug.html" class="btn btn-light btn-lg">
                        <i class="bi bi-exclamation-triangle me-2"></i>Reportar Bug o Problema
                    </a>
                </div>

            </div>
        </div>

    </div>

    <!-- BOTÓN FLOTANTE PARA REPORTAR BUGS -->
    <a href="../report-bug.html" class="btn btn-danger btn-lg floating-bug-button" title="Reportar Bug">
        <i class="bi bi-bug-fill me-2"></i>Reportar Bug
    </a>

    <!-- SCRIPTS - ORDEN CRÍTICO -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/js/config.js"></script>
    
    <script>
        // ==========================================
        // VARIABLES GLOBALES
        // ==========================================
        let currentUser = null;

        // ==========================================
        // CONFIGURACIÓN DE LA PÁGINA
        // ==========================================
        const PAGE_CONFIG = {
            moduleName: 'Indicadores',
            modulePath: 'indicators',
            pageTitle: 'Tablero de Mejora',
            pagePath: 'improvement-dashboard.html',
            moduleDescription: 'Dashboard analítico de planes de mejora y actividad de indicadores'
        };

        // ==========================================
        // INICIALIZACIÓN
        // ==========================================
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('📖 Iniciando página de manual...');
            
            try {
                // Verificar si existe la función de colores corporativos
                if (typeof loadAndApplyBrandColors === 'function') {
                    await loadAndApplyBrandColors();
                }
                
                // Verificar sesión si la función existe
                if (typeof getStoredSession === 'function') {
                    const session = getStoredSession();
                    if (session && session.user) {
                        currentUser = session.user;
                    }
                }
                
                // Actualizar información en la página
                updatePageInfo();
                
                console.log('✅ Página de manual lista');
                
            } catch (error) {
                console.error('❌ Error inicializando página:', error);
                if (typeof showMessage === 'function') {
                    showMessage('Error al cargar la página: ' + error.message, 'danger');
                }
            }
        });

        // ==========================================
        // ACTUALIZAR INFORMACIÓN DE LA PÁGINA
        // ==========================================
        function updatePageInfo() {
            document.title = `Manual - ${PAGE_CONFIG.moduleName} - ${PAGE_CONFIG.pageTitle} - SchoolNet`;
        }

        // ==========================================
        // UTILIDADES DE LOADING
        // ==========================================
        function showLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.remove('hidden');
            }
        }

        function hideLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.add('hidden');
            }
        }

        // ==========================================
        // FUNCIÓN DE MENSAJES
        // ==========================================
        function showMessage(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            if (!alertContainer) return;
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertContainer.appendChild(alertDiv);
            
            // Auto-remove después de 5 segundos
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

    </script>
</body>
</html>
