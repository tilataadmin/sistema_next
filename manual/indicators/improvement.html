<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- VERSIÓN DE LA PÁGINA -->
    <meta name="page-version" content="25.06.11.20.00">
    
    <title>Manual - Indicadores - Gestión de Mejora - SchoolNet</title>
    
    <!-- Bootstrap CSS - VERSIÓN FIJA PROBADA -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-overlay.hidden {
            display: none;
        }
        
        .loading-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Encabezado discreto */
        .manual-header {
            background: #f8f9fa;
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding: 1.5rem 0;
            margin-bottom: 2rem;
        }

        .manual-header h1 {
            font-size: 1.75rem;
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 0.25rem;
        }

        .manual-header .subtitle {
            color: #6c757d;
            font-size: 0.95rem;
        }

        /* Info card */
        .info-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Tarjeta para reportar bugs */
        .bug-report-card {
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .bug-report-card h5 {
            color: white;
        }

        /* Botón flotante para reportar bugs */
        .floating-bug-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            background: var(--system-primary-color, #dc3545) !important;
            border-color: var(--system-primary-color, #dc3545) !important;
        }

        .floating-bug-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
            opacity: 0.9;
        }

        .icon-large {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        /* Estilos para el contenido del manual */
        .section-title {
            color: var(--system-primary-color, #1B365D);
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            margin-top: 2rem;
        }

        .step-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 0.75rem;
        }

        .feature-list li {
            margin-bottom: 0.5rem;
        }

        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #0d6efd;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .success-box {
            background: #d1e7dd;
            border-left: 4px solid #198754;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .danger-box {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        /* Preview de tarjeta de indicador */
        .indicator-card-preview {
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 1.25rem;
            margin: 1rem 0;
            background: white;
        }

        .indicator-card-preview.selected {
            border-color: #1B365D;
            background: rgba(102, 126, 234, 0.05);
        }

        /* Timeline de notas */
        .notes-timeline-preview {
            position: relative;
            padding-left: 2rem;
            margin: 1rem 0;
        }

        .notes-timeline-preview::before {
            content: '';
            position: absolute;
            left: 0.5rem;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #e2e8f0;
        }

        .note-item-preview {
            position: relative;
            margin-bottom: 1rem;
            padding-left: 1rem;
        }

        .note-item-preview::before {
            content: '';
            position: absolute;
            left: -1.35rem;
            top: 0.5rem;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #667eea;
            border: 2px solid white;
            box-shadow: 0 0 0 2px #667eea;
        }

        .note-text-preview {
            background: #f8f9fa;
            padding: 0.75rem;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }

        /* Plan card preview */
        .plan-card-preview {
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 1.25rem;
            margin: 1rem 0;
            background: white;
        }

        .plan-meta-preview {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            margin: 0.75rem 0;
        }

        .plan-meta-item-preview {
            text-align: center;
        }

        .plan-meta-label-preview {
            font-size: 0.7rem;
            color: #64748b;
            text-transform: uppercase;
        }

        .plan-meta-value-preview {
            font-weight: 600;
            color: #1B365D;
            font-size: 0.9rem;
        }

        /* Update item preview */
        .update-item-preview {
            padding: 0.75rem;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            border-left: 3px solid #764ba2;
        }

        /* Task item preview */
        .task-item-preview {
            padding: 0.5rem;
            border-bottom: 1px solid #e2e8f0;
        }

        .faq-item {
            margin-bottom: 1rem;
        }

        .faq-item h6 {
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 0.5rem;
        }

        .tab-preview {
            display: inline-block;
            padding: 0.5rem 1rem;
            border: 1px solid #dee2e6;
            border-bottom: none;
            border-radius: 8px 8px 0 0;
            margin-right: 0.25rem;
            font-size: 0.9rem;
        }

        .tab-preview.active {
            background: white;
            border-bottom: 2px solid white;
            margin-bottom: -1px;
            color: #667eea;
            font-weight: 600;
        }
    </style>
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="mb-0">Cargando...</p>
        </div>
    </div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="container-fluid">

        <!-- ENCABEZADO DISCRETO -->
        <div class="manual-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1>
                            <i class="bi bi-book me-2"></i>
                            Manual: Indicadores
                        </h1>
                        <p class="subtitle mb-0">Gestión de Mejora</p>
                    </div>
                    <div class="col-md-4 text-md-end mt-3 mt-md-0">
                        <a href="../../modules/indicators/improvement.html" class="btn btn-outline-primary">
                            <i class="bi bi-arrow-left me-1"></i>Volver al Módulo
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- CONTENEDOR DE ALERTAS -->
        <div id="alertContainer"></div>

        <div class="row">
            <div class="col-lg-8 mx-auto">

                <!-- INFORMACIÓN CONTEXTUAL -->
                <div class="info-card">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h6 class="text-muted mb-2">Manual de:</h6>
                            <h5 class="mb-1"><strong id="display-module">Indicadores</strong></h5>
                            <p class="text-muted mb-0 small" id="display-page">Gestión de Mejora</p>
                        </div>
                        <div class="col-md-6 text-md-end mt-3 mt-md-0">
                            <p class="small text-muted mb-0">
                                <i class="bi bi-info-circle me-1"></i>
                                Si tienes dudas o encuentras algún problema,<br>
                                puedes reportarlo usando el botón de abajo.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ========================================== -->
                <!-- CONTENIDO DEL MANUAL -->
                <!-- ========================================== -->

                <!-- SECCIÓN 1: ¿QUÉ ES? -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-graph-up-arrow me-2"></i>
                        ¿Qué es la Gestión de Mejora?
                    </h2>
                    
                    <div class="step-card">
                        <p class="lead">
                            La Gestión de Mejora es un módulo <strong>colaborativo</strong> donde los 
                            usuarios pueden analizar el desempeño de los indicadores, documentar 
                            observaciones y crear planes de acción para mejorar los resultados.
                        </p>
                        
                        <p>
                            A diferencia de otras pantallas donde solo el propietario puede actuar, 
                            aquí <strong>todos los usuarios</strong> pueden participar agregando 
                            notas de análisis y actualizaciones de progreso. Sin embargo, solo el 
                            propietario del indicador puede crear planes de mejora formales.
                        </p>

                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>¿Por qué es importante?</strong>
                            <ul class="mb-0 mt-2">
                                <li>Permite documentar hallazgos y preocupaciones de forma estructurada</li>
                                <li>Facilita la comunicación entre equipos sobre el estado de los indicadores</li>
                                <li>Vincula planes de mejora con metas específicas</li>
                                <li>Conecta con el módulo de Tareas para dar seguimiento a las acciones</li>
                            </ul>
                        </div>

                        <p>
                            Este módulo es especialmente útil para reuniones de seguimiento, 
                            comités de calidad o cualquier proceso de mejora continua institucional.
                        </p>
                    </div>
                </section>

                <!-- SECCIÓN 2: CARACTERÍSTICAS PRINCIPALES -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-star me-2"></i>
                        Características principales
                    </h2>
                    
                    <div class="step-card">
                        <ul class="feature-list">
                            <li>
                                <strong>Notas de análisis colaborativas:</strong> Cualquier usuario 
                                puede documentar observaciones sobre cualquier indicador
                            </li>
                            <li>
                                <strong>Planes de mejora estructurados:</strong> El propietario 
                                puede crear planes vinculados a metas específicas
                            </li>
                            <li>
                                <strong>Actualizaciones de progreso:</strong> Cualquier usuario 
                                puede reportar avances en los planes existentes
                            </li>
                            <li>
                                <strong>Integración con Tareas:</strong> Los planes se conectan 
                                con el módulo de Tareas para gestión detallada
                            </li>
                            <li>
                                <strong>Timeline visual:</strong> Historial cronológico de notas 
                                y actualizaciones
                            </li>
                            <li>
                                <strong>Filtros avanzados:</strong> Busca por texto, estado o 
                                filtra solo tus indicadores
                            </li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN 3: PERMISOS Y ROLES -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-shield-check me-2"></i>
                        Permisos según tu rol
                    </h2>
                    
                    <div class="step-card">
                        <p>
                            Es importante entender qué acciones puedes realizar según tu 
                            relación con cada indicador:
                        </p>

                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead class="table-light">
                                    <tr>
                                        <th>Acción</th>
                                        <th class="text-center">Cualquier usuario</th>
                                        <th class="text-center">Propietario</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Ver indicadores y sus detalles</td>
                                        <td class="text-center"><i class="bi bi-check-circle-fill text-success"></i></td>
                                        <td class="text-center"><i class="bi bi-check-circle-fill text-success"></i></td>
                                    </tr>
                                    <tr>
                                        <td>Agregar notas de análisis</td>
                                        <td class="text-center"><i class="bi bi-check-circle-fill text-success"></i></td>
                                        <td class="text-center"><i class="bi bi-check-circle-fill text-success"></i></td>
                                    </tr>
                                    <tr>
                                        <td>Ver planes de mejora</td>
                                        <td class="text-center"><i class="bi bi-check-circle-fill text-success"></i></td>
                                        <td class="text-center"><i class="bi bi-check-circle-fill text-success"></i></td>
                                    </tr>
                                    <tr>
                                        <td>Agregar actualizaciones a planes</td>
                                        <td class="text-center"><i class="bi bi-check-circle-fill text-success"></i></td>
                                        <td class="text-center"><i class="bi bi-check-circle-fill text-success"></i></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Crear planes de mejora</strong></td>
                                        <td class="text-center"><i class="bi bi-x-circle-fill text-danger"></i></td>
                                        <td class="text-center"><i class="bi bi-check-circle-fill text-success"></i></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Editar planes de mejora</strong></td>
                                        <td class="text-center"><i class="bi bi-x-circle-fill text-danger"></i></td>
                                        <td class="text-center"><i class="bi bi-check-circle-fill text-success"></i></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="warning-box">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Importante:</strong>
                            Las notas y actualizaciones que agregues serán visibles para 
                            <strong>todos los usuarios</strong> con acceso al módulo. Asegúrate 
                            de que el contenido sea profesional y constructivo.
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN 4: TIPOS DE NOTAS -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-chat-left-text me-2"></i>
                        Tipos de notas de análisis
                    </h2>
                    
                    <div class="step-card">
                        <p>
                            Al agregar una nota, debes seleccionar un tipo que ayuda a 
                            categorizar la información:
                        </p>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-body">
                                        <h6><span class="badge bg-primary me-2">Análisis</span></h6>
                                        <p class="small mb-0">
                                            Interpretación de datos, tendencias identificadas, 
                                            conclusiones basadas en los resultados del indicador.
                                        </p>
                                        <p class="small text-muted mt-2 mb-0">
                                            <em>Ejemplo: "El indicador muestra una tendencia positiva 
                                            en los últimos 3 meses, correlacionada con la implementación 
                                            del nuevo programa."</em>
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-body">
                                        <h6><span class="badge bg-info me-2">Observación</span></h6>
                                        <p class="small mb-0">
                                            Hechos o situaciones relevantes sin necesariamente 
                                            implicar un problema o conclusión.
                                        </p>
                                        <p class="small text-muted mt-2 mb-0">
                                            <em>Ejemplo: "Los datos del mes de febrero no incluyen 
                                            la sede norte debido a cierre temporal."</em>
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-body">
                                        <h6><span class="badge bg-warning text-dark me-2">Preocupación</span></h6>
                                        <p class="small mb-0">
                                            Alertas sobre posibles problemas, riesgos identificados 
                                            o situaciones que requieren atención.
                                        </p>
                                        <p class="small text-muted mt-2 mb-0">
                                            <em>Ejemplo: "Si continúa la tendencia actual, no se 
                                            alcanzará la meta del período."</em>
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-body">
                                        <h6><span class="badge bg-success me-2">Hallazgo</span></h6>
                                        <p class="small mb-0">
                                            Descubrimientos importantes, patrones significativos 
                                            o información clave encontrada.
                                        </p>
                                        <p class="small text-muted mt-2 mb-0">
                                            <em>Ejemplo: "Se identificó que el 80% de la mejora 
                                            proviene de un solo departamento."</em>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN 5: ANTES DE COMENZAR -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-clipboard-check me-2"></i>
                        Antes de comenzar
                    </h2>
                    
                    <div class="step-card">
                        <h5>Requisitos previos:</h5>
                        <ul>
                            <li>Tener acceso al módulo de Indicadores</li>
                            <li>Tener el permiso "Gestión de mejora" asignado</li>
                        </ul>

                        <h5 class="mt-4">Para crear planes de mejora necesitas:</h5>
                        <ul>
                            <li>Ser el propietario del indicador</li>
                            <li>Que el indicador tenga al menos una meta configurada</li>
                        </ul>

                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>Tip:</strong>
                            Antes de crear un plan de mejora, asegúrate de que el indicador 
                            tenga metas configuradas en la pantalla de "Gestión de Indicadores". 
                            Los planes siempre deben estar vinculados a una meta específica.
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN 6: GUÍA PASO A PASO -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-list-ol me-2"></i>
                        Guía paso a paso
                    </h2>

                    <!-- Paso 1 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">1</span>
                            Buscar y seleccionar un indicador
                        </h4>
                        
                        <p>Al entrar, verás una lista de todos los indicadores del sistema:</p>

                        <p><strong>Filtros disponibles:</strong></p>
                        <ul>
                            <li><strong>Buscar:</strong> Por nombre o descripción del indicador</li>
                            <li><strong>Estado:</strong> Activos, Inactivos o En Pruebas</li>
                            <li><strong>Filtro especial:</strong>
                                <ul>
                                    <li>Todos los indicadores</li>
                                    <li>Mis indicadores (donde eres propietario)</li>
                                    <li>Con planes activos</li>
                                    <li>Sin planes</li>
                                </ul>
                            </li>
                        </ul>

                        <p><strong>Ejemplo de tarjeta de indicador:</strong></p>
                        <div class="indicator-card-preview">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <h6 class="mb-0" style="color: #1B365D;">Tasa de Aprobación</h6>
                                <div>
                                    <span class="badge bg-success">Activo</span>
                                    <span class="badge bg-primary">Propietario</span>
                                </div>
                            </div>
                            <div class="d-flex gap-3 text-muted small mb-2">
                                <span><i class="bi bi-person me-1"></i>María García</span>
                                <span><i class="bi bi-calendar me-1"></i>15/01/2025</span>
                            </div>
                            <p class="text-muted small mb-2">Porcentaje de estudiantes que aprueban el año escolar</p>
                            <button class="btn btn-sm btn-primary" disabled>
                                <i class="bi bi-eye me-1"></i>Ver Detalles
                            </button>
                        </div>

                        <p>
                            Haz clic en cualquier tarjeta o en "Ver Detalles" para abrir 
                            el panel de detalle del indicador.
                        </p>
                    </div>

                    <!-- Paso 2 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">2</span>
                            Entender el panel de detalle
                        </h4>
                        
                        <p>
                            Al seleccionar un indicador, se abre un panel con dos pestañas:
                        </p>

                        <div class="mb-3" style="border-bottom: 1px solid #dee2e6; padding-bottom: 0.5rem;">
                            <span class="tab-preview active">
                                <i class="bi bi-chat-left-text me-1"></i>Notas de Análisis
                            </span>
                            <span class="tab-preview">
                                <i class="bi bi-list-check me-1"></i>Planes de Mejora
                            </span>
                        </div>

                        <ul>
                            <li>
                                <strong>Notas de Análisis:</strong> Timeline con todas las 
                                notas agregadas por cualquier usuario
                            </li>
                            <li>
                                <strong>Planes de Mejora:</strong> Lista de planes formales 
                                creados por el propietario
                            </li>
                        </ul>
                    </div>

                    <!-- Paso 3 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">3</span>
                            Agregar una nota de análisis
                        </h4>
                        
                        <ol>
                            <li>En la pestaña "Notas de Análisis", haz clic en <strong>"Agregar Nota"</strong></li>
                            <li>Selecciona el tipo de nota (Análisis, Observación, Preocupación o Hallazgo)</li>
                            <li>Escribe el contenido de tu nota</li>
                            <li>Haz clic en "Guardar Nota"</li>
                        </ol>

                        <p><strong>Ejemplo de timeline de notas:</strong></p>
                        <div class="notes-timeline-preview">
                            <div class="note-item-preview">
                                <div class="d-flex justify-content-between mb-1">
                                    <div>
                                        <strong style="color: #1B365D;">María García</strong>
                                        <span class="badge bg-warning text-dark ms-2" style="font-size: 0.7rem;">Preocupación</span>
                                    </div>
                                    <small class="text-muted">11/06/2025 10:30</small>
                                </div>
                                <div class="note-text-preview">
                                    La tendencia del último trimestre muestra un descenso del 3%. 
                                    Se recomienda revisar las causas antes del cierre del período.
                                </div>
                            </div>
                            <div class="note-item-preview">
                                <div class="d-flex justify-content-between mb-1">
                                    <div>
                                        <strong style="color: #1B365D;">Juan Pérez</strong>
                                        <span class="badge bg-primary ms-2" style="font-size: 0.7rem;">Análisis</span>
                                    </div>
                                    <small class="text-muted">10/06/2025 15:45</small>
                                </div>
                                <div class="note-text-preview">
                                    El indicador se mantiene estable respecto al mes anterior. 
                                    Los datos están completos y validados.
                                </div>
                            </div>
                        </div>

                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>Recuerda:</strong>
                            Tus notas serán visibles para todos los usuarios con acceso al módulo. 
                            Escribe de forma clara y profesional.
                        </div>
                    </div>

                    <!-- Paso 4 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">4</span>
                            Crear un plan de mejora (solo propietarios)
                        </h4>
                        
                        <p>
                            Si eres el propietario del indicador, puedes crear planes de mejora:
                        </p>

                        <ol>
                            <li>Ve a la pestaña "Planes de Mejora"</li>
                            <li>Haz clic en <strong>"Crear Plan de Mejora"</strong></li>
                            <li>Selecciona la <strong>meta asociada</strong> (obligatorio)</li>
                            <li>Completa los campos:
                                <ul>
                                    <li><strong>Nombre del Plan:</strong> Identificador corto</li>
                                    <li><strong>Objetivo:</strong> Qué se quiere lograr</li>
                                    <li><strong>Estrategia:</strong> Acciones generales planeadas</li>
                                    <li><strong>Estado:</strong> Borrador, Activo, Completado o Cancelado</li>
                                </ul>
                            </li>
                            <li>Haz clic en "Crear Plan"</li>
                        </ol>

                        <div class="warning-box">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Requisito:</strong>
                            El indicador debe tener al menos una meta configurada para poder 
                            crear un plan de mejora. Si no hay metas, el sistema mostrará una 
                            advertencia.
                        </div>

                        <p><strong>Ejemplo de tarjeta de plan:</strong></p>
                        <div class="plan-card-preview">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <h6 class="mb-0" style="color: #1B365D;">Plan de Mejora Q1 2025</h6>
                                <span class="badge" style="background: #10b981; color: white;">Activo</span>
                            </div>
                            
                            <div class="plan-meta-preview">
                                <div class="plan-meta-item-preview">
                                    <div class="plan-meta-label-preview">Meta Asociada</div>
                                    <div class="plan-meta-value-preview">2025 | Meta: 85%</div>
                                </div>
                                <div class="plan-meta-item-preview">
                                    <div class="plan-meta-label-preview">Creado por</div>
                                    <div class="plan-meta-value-preview">María García</div>
                                </div>
                                <div class="plan-meta-item-preview">
                                    <div class="plan-meta-label-preview">Fecha</div>
                                    <div class="plan-meta-value-preview">01/01/2025</div>
                                </div>
                            </div>
                            
                            <div class="mb-2">
                                <strong>Objetivo:</strong>
                                <p class="mb-0 small">Incrementar la tasa de aprobación del 82% actual al 85% mediante 
                                intervención temprana en estudiantes con bajo rendimiento.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Paso 5 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">5</span>
                            Agregar actualizaciones de progreso
                        </h4>
                        
                        <p>
                            Cualquier usuario puede reportar avances en un plan existente:
                        </p>

                        <ol>
                            <li>En la tarjeta del plan, busca la sección "Actualizaciones de Progreso"</li>
                            <li>Haz clic en <strong>"Agregar"</strong></li>
                            <li>Describe los avances, logros o dificultades encontradas</li>
                            <li>Haz clic en "Guardar Actualización"</li>
                        </ol>

                        <p><strong>Ejemplo de actualizaciones:</strong></p>
                        <div class="update-item-preview">
                            <div class="d-flex justify-content-between small mb-1">
                                <strong style="color: #1B365D;">Juan Pérez</strong>
                                <span class="text-muted">10/06/2025 14:30</span>
                            </div>
                            <p class="mb-0 small">Se completó la identificación de estudiantes en riesgo. 
                            Se inicia el programa de tutorías la próxima semana.</p>
                        </div>
                        <div class="update-item-preview">
                            <div class="d-flex justify-content-between small mb-1">
                                <strong style="color: #1B365D;">María García</strong>
                                <span class="text-muted">05/06/2025 09:15</span>
                            </div>
                            <p class="mb-0 small">Se han asignado los tutores para el programa. 
                            Pendiente definir horarios con coordinación.</p>
                        </div>
                    </div>

                    <!-- Paso 6 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">6</span>
                            Gestionar tareas vinculadas
                        </h4>
                        
                        <p>
                            Los planes de mejora pueden tener tareas específicas que se 
                            gestionan desde el módulo de Tareas:
                        </p>

                        <ol>
                            <li>En la tarjeta del plan, busca la sección "Tareas Vinculadas"</li>
                            <li>Haz clic en <strong>"Gestionar Tareas"</strong></li>
                            <li>Serás redirigido al módulo de Tareas filtrado por este plan</li>
                            <li>Desde allí puedes crear, asignar y dar seguimiento a las tareas</li>
                        </ol>

                        <p><strong>Ejemplo de tareas vinculadas:</strong></p>
                        <div class="border rounded p-2">
                            <div class="task-item-preview">
                                <div class="d-flex align-items-center gap-2">
                                    <span>⏳</span>
                                    <strong class="small">Identificar estudiantes en riesgo</strong>
                                    <span class="badge bg-warning text-dark" style="font-size: 0.65rem;">Alta</span>
                                </div>
                                <div class="d-flex gap-3 text-muted" style="font-size: 0.75rem;">
                                    <span><i class="bi bi-person-circle me-1"></i>Juan Pérez</span>
                                    <span><i class="bi bi-calendar me-1"></i>15/06/2025</span>
                                    <span>Pendiente</span>
                                </div>
                            </div>
                            <div class="task-item-preview">
                                <div class="d-flex align-items-center gap-2">
                                    <span>✅</span>
                                    <strong class="small">Asignar tutores al programa</strong>
                                    <span class="badge bg-primary" style="font-size: 0.65rem;">Media</span>
                                </div>
                                <div class="d-flex gap-3 text-muted" style="font-size: 0.75rem;">
                                    <span><i class="bi bi-person-circle me-1"></i>María García</span>
                                    <span><i class="bi bi-calendar me-1"></i>10/06/2025</span>
                                    <span>Completado</span>
                                </div>
                            </div>
                        </div>

                        <div class="info-box mt-3">
                            <strong><i class="bi bi-info-circle me-2"></i>Integración:</strong>
                            Las tareas creadas desde el módulo de Tareas con un plan de mejora 
                            asociado aparecerán automáticamente en esta sección.
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN 7: SOLUCIÓN DE PROBLEMAS -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-question-circle me-2"></i>
                        Solución de problemas comunes
                    </h2>

                    <div class="step-card">
                        <h5>No puedo crear planes de mejora</h5>
                        <ul>
                            <li>Verifica que seas el propietario del indicador</li>
                            <li>Si ves el mensaje "Solo el propietario puede crear planes", 
                                contacta al propietario del indicador</li>
                        </ul>

                        <h5 class="mt-4">No hay metas disponibles al crear el plan</h5>
                        <ul>
                            <li>El indicador no tiene metas configuradas</li>
                            <li>Ve a "Gestión de Indicadores" y agrega al menos una meta</li>
                            <li>Las metas se configuran por año académico</li>
                        </ul>

                        <h5 class="mt-4">No veo el botón "Agregar Nota"</h5>
                        <ul>
                            <li>Asegúrate de tener seleccionado un indicador</li>
                            <li>El botón aparece en la pestaña "Notas de Análisis"</li>
                        </ul>

                        <h5 class="mt-4">Las tareas no aparecen en el plan</h5>
                        <ul>
                            <li>Las tareas deben crearse desde el módulo de Tareas</li>
                            <li>Al crear la tarea, debe seleccionarse el plan de mejora correspondiente</li>
                            <li>Las tareas canceladas no se muestran</li>
                        </ul>

                        <h5 class="mt-4">No encuentro un indicador específico</h5>
                        <ul>
                            <li>Usa el campo de búsqueda para filtrar por nombre</li>
                            <li>Verifica que el filtro de estado incluya el indicador buscado</li>
                            <li>Limpia los filtros con el botón "Limpiar"</li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN 8: BUENAS PRÁCTICAS -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-check2-circle me-2"></i>
                        Buenas prácticas
                    </h2>

                    <div class="step-card">
                        <ul class="feature-list">
                            <li>
                                <strong>Documenta regularmente:</strong> Agrega notas de análisis 
                                cada vez que revises un indicador, especialmente después de reuniones
                            </li>
                            <li>
                                <strong>Usa el tipo correcto:</strong> Categoriza tus notas 
                                correctamente para facilitar el filtrado posterior
                            </li>
                            <li>
                                <strong>Sé específico:</strong> Incluye fechas, porcentajes y 
                                datos concretos en tus observaciones
                            </li>
                            <li>
                                <strong>Vincula planes a metas:</strong> Cada plan debe tener 
                                una meta clara que se busca alcanzar
                            </li>
                            <li>
                                <strong>Actualiza el progreso:</strong> Reporta avances 
                                regularmente para mantener a todos informados
                            </li>
                            <li>
                                <strong>Usa el módulo de Tareas:</strong> Para acciones 
                                específicas, crea tareas vinculadas al plan
                            </li>
                            <li>
                                <strong>Mantén el profesionalismo:</strong> Recuerda que 
                                todo lo que escribas es visible para otros usuarios
                            </li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN 9: PREGUNTAS FRECUENTES -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-chat-dots me-2"></i>
                        Preguntas frecuentes
                    </h2>

                    <div class="step-card">
                        <div class="faq-item">
                            <h6>¿Puedo eliminar una nota que agregué?</h6>
                            <p>
                                Actualmente no es posible eliminar notas una vez guardadas. 
                                Esto garantiza la integridad del historial de análisis.
                            </p>
                        </div>

                        <div class="faq-item">
                            <h6>¿Quién puede ver mis notas?</h6>
                            <p>
                                Todos los usuarios con acceso al módulo de Gestión de Mejora 
                                pueden ver todas las notas de todos los indicadores.
                            </p>
                        </div>

                        <div class="faq-item">
                            <h6>¿Puedo crear múltiples planes para un indicador?</h6>
                            <p>
                                Sí, puedes crear varios planes de mejora para un mismo indicador, 
                                cada uno vinculado a una meta diferente o a la misma meta.
                            </p>
                        </div>

                        <div class="faq-item">
                            <h6>¿Qué pasa si cambio el estado de un plan a "Completado"?</h6>
                            <p>
                                El plan se marcará como completado pero seguirá visible en el 
                                historial. Las tareas asociadas no cambian automáticamente.
                            </p>
                        </div>

                        <div class="faq-item">
                            <h6>¿Cómo vinculo tareas a un plan de mejora?</h6>
                            <p>
                                Las tareas se crean desde el módulo de Tareas. Al crear una 
                                nueva tarea, existe un campo para seleccionar el plan de mejora 
                                al que se vincula.
                            </p>
                        </div>

                        <div class="faq-item">
                            <h6>¿Puedo exportar el historial de notas?</h6>
                            <p>
                                Actualmente no hay una función de exportación directa. 
                                Puedes copiar el contenido manualmente si lo necesitas.
                            </p>
                        </div>

                        <div class="faq-item">
                            <h6>¿Qué significa cada estado del plan?</h6>
                            <p>
                                <strong>Borrador:</strong> Plan en preparación, no iniciado.<br>
                                <strong>Activo:</strong> Plan en ejecución.<br>
                                <strong>Completado:</strong> Plan finalizado exitosamente.<br>
                                <strong>Cancelado:</strong> Plan abandonado o descartado.
                            </p>
                        </div>

                        <div class="faq-item">
                            <h6>¿Las notificaciones llegan cuando alguien agrega una nota?</h6>
                            <p>
                                Actualmente no hay notificaciones automáticas. Se recomienda 
                                revisar el módulo periódicamente o coordinarse con el equipo.
                            </p>
                        </div>
                    </div>
                </section>

                <!-- ========================================== -->
                <!-- FIN DEL CONTENIDO DEL MANUAL -->
                <!-- ========================================== -->

                <!-- TARJETA PARA REPORTAR BUGS -->
                <div class="bug-report-card">
                    <i class="bi bi-bug-fill icon-large"></i>
                    <h4 class="mb-3">¿Encontraste un problema o tienes una sugerencia?</h4>
                    <p class="mb-4">
                        Si experimentaste un error, algo no funciona como esperas, o tienes 
                        una sugerencia para mejorar el sistema, repórtalo aquí.
                    </p>
                    <a href="../report-bug.html" class="btn btn-light btn-lg">
                        <i class="bi bi-exclamation-triangle me-2"></i>Reportar Bug o Problema
                    </a>
                </div>

            </div>
        </div>

    </div>

    <!-- BOTÓN FLOTANTE PARA REPORTAR BUGS -->
    <a href="../report-bug.html" class="btn btn-danger btn-lg floating-bug-button" title="Reportar Bug">
        <i class="bi bi-bug-fill me-2"></i>Reportar Bug
    </a>

    <!-- SCRIPTS - ORDEN CRÍTICO -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/js/config.js"></script>
    
    <script>
        // ==========================================
        // VARIABLES GLOBALES
        // ==========================================
        let currentUser = null;

        // ==========================================
        // CONFIGURACIÓN DE LA PÁGINA
        // ==========================================
        const PAGE_CONFIG = {
            moduleName: 'Indicadores',
            modulePath: 'indicators',
            pageTitle: 'Gestión de Mejora',
            pagePath: 'improvement.html',
            moduleDescription: 'Analiza indicadores, documenta observaciones y crea planes de acción'
        };

        // ==========================================
        // INICIALIZACIÓN
        // ==========================================
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('📖 Iniciando página de manual...');
            
            try {
                // Verificar si existe la función de colores corporativos
                if (typeof loadAndApplyBrandColors === 'function') {
                    await loadAndApplyBrandColors();
                }
                
                // Verificar sesión si la función existe
                if (typeof getStoredSession === 'function') {
                    const session = getStoredSession();
                    if (session && session.user) {
                        currentUser = session.user;
                    }
                }
                
                // Actualizar información en la página
                updatePageInfo();
                
                console.log('✅ Página de manual lista');
                
            } catch (error) {
                console.error('❌ Error inicializando página:', error);
                if (typeof showMessage === 'function') {
                    showMessage('Error al cargar la página: ' + error.message, 'danger');
                }
            }
        });

        // ==========================================
        // ACTUALIZAR INFORMACIÓN DE LA PÁGINA
        // ==========================================
        function updatePageInfo() {
            document.title = `Manual - ${PAGE_CONFIG.moduleName} - ${PAGE_CONFIG.pageTitle} - SchoolNet`;
        }

        // ==========================================
        // UTILIDADES DE LOADING
        // ==========================================
        function showLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.remove('hidden');
            }
        }

        function hideLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.add('hidden');
            }
        }

        // ==========================================
        // FUNCIÓN DE MENSAJES
        // ==========================================
        function showMessage(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            if (!alertContainer) return;
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertContainer.appendChild(alertDiv);
            
            // Auto-remove después de 5 segundos
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

    </script>
</body>
</html>
