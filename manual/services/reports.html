<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- VERSIÓN DE LA PÁGINA -->
    <meta name="page-version" content="26.02.08.20.00">
    
    <title>Manual - Servicios - Reportes - SchoolNet</title>
    
    <!-- Bootstrap CSS - VERSIÓN FIJA PROBADA -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-overlay.hidden {
            display: none;
        }
        
        .loading-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Encabezado discreto */
        .manual-header {
            background: #f8f9fa;
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding: 1.5rem 0;
            margin-bottom: 2rem;
        }

        .manual-header h1 {
            font-size: 1.75rem;
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 0.25rem;
        }

        .manual-header .subtitle {
            color: #6c757d;
            font-size: 0.95rem;
        }

        /* Info card */
        .info-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Secciones del manual */
        .section-title {
            color: var(--system-primary-color, #1B365D);
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding-bottom: 0.5rem;
            margin-top: 2.5rem;
            margin-bottom: 1.5rem;
        }

        .step-card {
            background: #f8f9fa;
            border-left: 4px solid var(--system-primary-color, #1B365D);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-radius: 4px;
        }

        .step-number {
            background: var(--system-primary-color, #1B365D);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 0.75rem;
        }

        .info-box {
            background: #d1ecf1;
            border-left: 4px solid #0dcaf0;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .tip-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .faq-item {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .faq-question {
            font-weight: 600;
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 0.75rem;
        }

        /* Tarjeta para reportar bugs - COLOR PRIMARIO */
        .bug-report-card {
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .bug-report-card h5 {
            color: white;
        }

        /* Botón flotante para reportar bugs - COLOR PRIMARIO */
        .floating-bug-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            background-color: var(--system-primary-color, #1B365D) !important;
            border-color: var(--system-primary-color, #1B365D) !important;
            color: white !important;
        }

        .floating-bug-button:hover,
        .floating-bug-button:focus,
        .floating-bug-button:active {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
            opacity: 0.9;
            background-color: var(--system-primary-color, #1B365D) !important;
            border-color: var(--system-primary-color, #1B365D) !important;
            color: white !important;
        }

        .icon-large {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        /* Lista de características */
        .feature-list {
            list-style: none;
            padding-left: 0;
        }

        .feature-list li {
            padding: 0.5rem 0;
            padding-left: 2rem;
            position: relative;
        }

        .feature-list li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* Subsecciones */
        .subsection-title {
            color: var(--system-primary-color, #1B365D);
            font-size: 1.1rem;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            padding-left: 1rem;
            border-left: 3px solid var(--system-primary-color, #1B365D);
        }
    </style>
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="mb-0">Cargando...</p>
        </div>
    </div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="container-fluid">

        <!-- ENCABEZADO DISCRETO -->
        <div class="manual-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1>
                            <i class="bi bi-book me-2"></i>
                            Manual: Servicios
                        </h1>
                        <p class="subtitle mb-0">Reportes de Servicios</p>
                    </div>
                    <div class="col-md-4 text-md-end mt-3 mt-md-0">
                        <a href="../../modules/services/reports.html" class="btn btn-outline-primary">
                            <i class="bi bi-arrow-left me-1"></i>Volver al Módulo
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- CONTENEDOR DE ALERTAS -->
        <div id="alertContainer"></div>

        <div class="row">
            <div class="col-lg-10 mx-auto">

                <!-- INFORMACIÓN CONTEXTUAL -->
                <div class="info-card">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h6 class="text-muted mb-2">Manual de:</h6>
                            <h5 class="mb-1"><strong id="display-module">Servicios</strong></h5>
                            <p class="text-muted mb-0 small" id="display-page">Reportes de Servicios</p>
                        </div>
                        <div class="col-md-6 text-md-end mt-3 mt-md-0">
                            <p class="small text-muted mb-0">
                                <i class="bi bi-info-circle me-1"></i>
                                Si tienes dudas o encuentras algún problema,<br>
                                puedes reportarlo usando el botón de abajo.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- CONTENIDO DEL MANUAL -->
                <!-- ============================================ -->

                <!-- SECCIÓN 1: ¿Qué es? -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-info-circle me-2"></i>
                        ¿Qué son los Reportes de Servicios?
                    </h2>
                    
                    <div class="step-card">
                        <p class="lead">
                            Los <strong>Reportes de Servicios</strong> son herramientas de análisis y control que te permiten 
                            generar consolidados, soportes de pago y reportes operativos de todos los servicios del módulo.
                        </p>
                        
                        <p>
                            Esta página centraliza 4 tipos de reportes diferentes, cada uno diseñado para un propósito específico:
                        </p>

                        <ol>
                            <li><strong>Consolidado de Transporte:</strong> Resumen mensual por tipo de servicio (pedagógicas, 
                                deportivas, extracurriculares, personal). Ideal para validar facturas del proveedor de transporte.</li>
                            
                            <li><strong>Detalle de Transporte:</strong> Listado detallado de cada recorrido individual con fechas, 
                                destinos, vehículos, pasajeros y costos. Para auditorías o análisis detallados.</li>
                            
                            <li><strong>Eventos Internos:</strong> Reporte de eventos institucionales con costos de refrigerios 
                                y servicios de apoyo. Para control presupuestal de eventos.</li>
                            
                            <li><strong>Solicitudes:</strong> Seguimiento de todas las solicitudes de aprobación (salidas, eventos) 
                                con estados, aprobadores y fechas. Para control de flujos de autorización.</li>
                        </ol>

                        <div class="info-box">
                            <i class="bi bi-lightbulb text-info me-2"></i>
                            <strong>Todos los reportes se pueden exportar:</strong>
                            <p class="mb-0 mt-2">
                                Cada reporte tiene botones de exportación a <strong>Excel</strong> (para análisis en hoja de cálculo) 
                                y <strong>PDF</strong> (para imprimir o archivar). Los botones se habilitan solo después de generar 
                                el reporte.
                            </p>
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN 2: Características principales -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-star me-2"></i>
                        Características principales
                    </h2>
                    
                    <div class="step-card">
                        <ul class="feature-list">
                            <li><strong>4 reportes especializados:</strong> Cada uno diseñado para un propósito diferente 
                                (consolidados, detalles, eventos, solicitudes).</li>
                            
                            <li><strong>Filtros flexibles:</strong> Por mes/año, rango de fechas, tipo de servicio, estado, 
                                según el reporte.</li>
                            
                            <li><strong>Resúmenes visuales:</strong> Tarjetas con métricas clave antes de la tabla detallada.</li>
                            
                            <li><strong>Totales automáticos:</strong> Cada tabla incluye fila de totales calculada automáticamente.</li>
                            
                            <li><strong>Exportación dual:</strong> Todos los reportes se pueden exportar a Excel y PDF con un solo clic.</li>
                            
                            <li><strong>Formato profesional:</strong> Los archivos exportados incluyen encabezados, totales y 
                                marca de agua con fecha de generación.</li>
                            
                            <li><strong>Datos en tiempo real:</strong> Los reportes consultan directamente la base de datos 
                                actualizada al momento de generarlos.</li>
                            
                            <li><strong>Navegación por pestañas:</strong> Cambio rápido entre tipos de reporte sin recargar la página.</li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN 3: Antes de comenzar -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-clipboard-check me-2"></i>
                        Antes de comenzar
                    </h2>
                    
                    <div class="step-card">
                        <h5 class="mb-3">Requisitos previos:</h5>
                        
                        <ul>
                            <li><strong>Permiso necesario:</strong> Debes tener el permiso "Reportes de servicios" activo.</li>
                            
                            <li><strong>Datos existentes:</strong> Para generar reportes significativos, debe haber salidas, eventos 
                                o solicitudes registradas en el sistema.</li>
                            
                            <li><strong>Navegador actualizado:</strong> Los reportes usan librerías modernas de exportación que 
                                requieren navegadores actualizados (Chrome, Firefox, Edge, Safari).</li>
                            
                            <li><strong>Habilitar descargas:</strong> Asegúrate de que tu navegador permita descargas desde 
                                SchoolNet para poder exportar archivos.</li>
                        </ul>

                        <div class="info-box">
                            <i class="bi bi-info-circle text-info me-2"></i>
                            <strong>Sobre los datos:</strong> Los reportes muestran datos tal como están registrados en el sistema. 
                            Si un costo está pendiente de registro (por ejemplo, servicios de apoyo de eventos), aparecerá como 
                            "Pendiente" en el reporte.
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN 4: Reporte 1 - Consolidado Transporte -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-bar-chart me-2"></i>
                        Reporte 1: Consolidado de Transporte
                    </h2>

                    <div class="step-card">
                        <h5 class="mb-3">¿Para qué sirve?</h5>
                        <p>
                            El reporte consolidado agrupa TODOS los recorridos de transporte del mes seleccionado por tipo de 
                            servicio, mostrando: cuántos recorridos hubo, cuántos se realizaron, cuántos se cancelaron, y el 
                            valor total por cada tipo.
                        </p>

                        <p><strong>Usa este reporte para:</strong></p>
                        <ul>
                            <li>Validar la factura mensual del proveedor de transporte</li>
                            <li>Entender la distribución de costos entre diferentes tipos de servicio</li>
                            <li>Control presupuestal mensual de transporte</li>
                            <li>Estadísticas de uso de transporte institucional</li>
                        </ul>

                        <h5 class="mt-4 mb-3">Cómo generar el reporte:</h5>
                        <ol>
                            <li>Haz clic en la pestaña "<strong>Consolidado Transporte</strong>"</li>
                            <li>Selecciona el <strong>Mes</strong> (ejemplo: Enero, Febrero, etc.)</li>
                            <li>Selecciona el <strong>Año</strong> (ejemplo: 2026)</li>
                            <li>Haz clic en el botón <strong>"Generar"</strong></li>
                            <li>El sistema consulta la base de datos y muestra:
                                <ul>
                                    <li>4 tarjetas resumen en la parte superior (Total, Recorridos, Realizados, Cancelados)</li>
                                    <li>Tabla detallada por tipo de servicio</li>
                                    <li>Fila de totales al final</li>
                                </ul>
                            </li>
                        </ol>

                        <h5 class="mt-4 mb-3">Tipos de servicio incluidos:</h5>
                        <ul>
                            <li><strong>Salidas Pedagógicas:</strong> Visitas educativas (museos, parques, empresas, etc.)</li>
                            <li><strong>Salidas Deportivas:</strong> Competencias, entrenamientos, torneos fuera del colegio</li>
                            <li><strong>Extracurriculares:</strong> Transporte recurrente para actividades extracurriculares 
                                (deportes, artes, clubes)</li>
                            <li><strong>Transporte de Personal:</strong> Rutas regulares de trabajadores del colegio</li>
                        </ul>

                        <div class="warning-box">
                            <i class="bi bi-exclamation-triangle text-warning me-2"></i>
                            <strong>Importante sobre cancelados:</strong> Los recorridos cancelados NO generan costo. Por eso, 
                            si una salida pedagógica se canceló, aparecerá en "Recorridos" pero no en "Realizados" ni en "Valor". 
                            Esto es correcto: solo se pagan los recorridos que efectivamente se realizaron.
                        </div>

                        <h5 class="mt-4 mb-3">Exportar el reporte:</h5>
                        <p>Una vez generado el reporte, los botones de exportación se habilitan:</p>
                        <ul>
                            <li><strong>Excel:</strong> Genera un archivo .xlsx con los mismos datos de la tabla. 
                                Útil para hacer análisis adicionales, gráficos, o comparaciones con otros meses.</li>
                            <li><strong>PDF:</strong> Genera un archivo .pdf listo para imprimir o enviar. 
                                Útil como soporte para pago al proveedor o para archivar.</li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN 5: Reporte 2 - Detalle Transporte -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-list-columns me-2"></i>
                        Reporte 2: Detalle de Transporte
                    </h2>

                    <div class="step-card">
                        <h5 class="mb-3">¿Para qué sirve?</h5>
                        <p>
                            El reporte detallado muestra CADA recorrido individual: fecha, tipo, destino, modalidad (ida/vuelta), 
                            vehículos, capacidad, pasajeros y valor. Es como ver el "libro diario" de transporte.
                        </p>

                        <p><strong>Usa este reporte para:</strong></p>
                        <ul>
                            <li>Auditorías detalladas de transporte</li>
                            <li>Verificar un recorrido específico que aparece en una factura</li>
                            <li>Análisis de eficiencia (¿estamos llenando bien los vehículos?)</li>
                            <li>Respaldo de costos ante solicitudes de reembolso o ajustes</li>
                        </ul>

                        <h5 class="mt-4 mb-3">Cómo generar el reporte:</h5>
                        <ol>
                            <li>Haz clic en la pestaña "<strong>Detalle Transporte</strong>"</li>
                            <li>Selecciona la <strong>Fecha Desde</strong> (inicio del rango)</li>
                            <li>Selecciona la <strong>Fecha Hasta</strong> (fin del rango)</li>
                            <li>Opcionalmente, filtra por <strong>Tipo</strong>:
                                <ul>
                                    <li>"Todos los tipos" → Muestra todos los servicios</li>
                                    <li>"Salidas pedagógicas" → Solo salidas educativas</li>
                                    <li>"Salidas deportivas" → Solo salidas deportivas</li>
                                    <li>"Extracurriculares" → Solo extracurriculares</li>
                                    <li>"Transporte de personal" → Solo rutas de personal</li>
                                </ul>
                            </li>
                            <li>Haz clic en <strong>"Generar"</strong></li>
                        </ol>

                        <h5 class="mt-4 mb-3">Información mostrada:</h5>
                        <p>Cada fila de la tabla muestra:</p>
                        <ul>
                            <li><strong>Fecha:</strong> Cuándo ocurrió el recorrido</li>
                            <li><strong>Tipo:</strong> Pedagógica, Deportiva, Extracurricular o Personal</li>
                            <li><strong>Detalle:</strong> Destino o descripción del recorrido</li>
                            <li><strong>Modalidad:</strong> Ida, Regreso, o Ida y vuelta (solo aplica a salidas)</li>
                            <li><strong>Veh.:</strong> Número de vehículos utilizados</li>
                            <li><strong>Cap.:</strong> Capacidad de los vehículos</li>
                            <li><strong>Pax:</strong> Número de pasajeros (estudiantes + adultos)</li>
                            <li><strong>Valor:</strong> Costo del recorrido</li>
                        </ul>

                        <div class="tip-box">
                            <i class="bi bi-lightbulb text-success me-2"></i>
                            <strong>Recorridos cancelados:</strong> Aparecen en la tabla con fondo amarillo (advertencia). 
                            Su valor es $0 porque no se cobraron. La columna "Detalle" explica el motivo de cancelación.
                        </div>

                        <h5 class="mt-4 mb-3">Exportar el reporte:</h5>
                        <p>Igual que el consolidado, puedes exportar a Excel o PDF una vez generado.</p>
                    </div>
                </section>

                <!-- SECCIÓN 6: Reporte 3 - Eventos Internos -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-calendar-event me-2"></i>
                        Reporte 3: Eventos Internos
                    </h2>

                    <div class="step-card">
                        <h5 class="mb-3">¿Para qué sirve?</h5>
                        <p>
                            Este reporte consolida los eventos institucionales internos del colegio (cafecitos, primeras comuniones, 
                            día de la familia, etc.) mostrando participantes, costos de refrigerios, costos de servicios de apoyo, 
                            y total por evento.
                        </p>

                        <p><strong>Usa este reporte para:</strong></p>
                        <ul>
                            <li>Control presupuestal de eventos internos</li>
                            <li>Justificar costos de eventos ante dirección o consejo directivo</li>
                            <li>Planificación de eventos futuros (costos históricos de referencia)</li>
                            <li>Verificar que las áreas de apoyo registraron sus costos</li>
                        </ul>

                        <h5 class="mt-4 mb-3">Cómo generar el reporte:</h5>
                        <ol>
                            <li>Haz clic en la pestaña "<strong>Eventos Internos</strong>"</li>
                            <li>Selecciona <strong>Fecha Desde</strong> y <strong>Fecha Hasta</strong></li>
                            <li>Opcionalmente, filtra por <strong>Estado</strong>:
                                <ul>
                                    <li>"Todos" → Muestra eventos en cualquier estado</li>
                                    <li>"Programados" → Solo eventos que aún no se han realizado</li>
                                    <li>"Realizados" → Solo eventos completados</li>
                                    <li>"Suspendidos" → Solo eventos que se suspendieron</li>
                                    <li>"Cancelados" → Solo eventos cancelados</li>
                                </ul>
                            </li>
                            <li>Haz clic en <strong>"Generar"</strong></li>
                        </ol>

                        <h5 class="mt-4 mb-3">Información mostrada:</h5>
                        <p>El reporte incluye:</p>

                        <p><strong>Tarjetas resumen:</strong></p>
                        <ul>
                            <li>Total de eventos</li>
                            <li>Costo total de refrigerios</li>
                            <li>Costo total general</li>
                        </ul>

                        <p><strong>Tabla detallada con columnas:</strong></p>
                        <ul>
                            <li><strong>Fecha:</strong> Cuándo se realizó (o realizará) el evento</li>
                            <li><strong>Evento:</strong> Nombre del evento</li>
                            <li><strong>Ubicación:</strong> Dónde se realizó (cancha, auditorio, etc.)</li>
                            <li><strong>Participantes:</strong> Suma de estudiantes + adultos</li>
                            <li><strong>Estado:</strong> Programado, Realizado, Suspendido, Cancelado</li>
                            <li><strong>Refrigerios:</strong> Costo total de refrigerios (si se incluyeron)</li>
                            <li><strong>Servicios:</strong> Costo total de servicios de apoyo (staffing, comunicaciones, tecnología, etc.)</li>
                            <li><strong>Total:</strong> Suma de refrigerios + servicios</li>
                        </ul>

                        <div class="warning-box">
                            <i class="bi bi-exclamation-triangle text-warning me-2"></i>
                            <strong>Costos pendientes:</strong> Si en la columna "Servicios" aparece "Pendientes", significa que 
                            las áreas de apoyo (tecnología, comunicaciones, etc.) aún NO han registrado el costo de su servicio 
                            para ese evento. El total mostrado será INCOMPLETO hasta que todas las áreas registren sus costos.
                        </div>

                        <h5 class="mt-4 mb-3">Exportar el reporte:</h5>
                        <p>Exporta a Excel para análisis detallado o a PDF para presentaciones/respaldo.</p>
                    </div>
                </section>

                <!-- SECCIÓN 7: Reporte 4 - Solicitudes -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-clipboard-check me-2"></i>
                        Reporte 4: Solicitudes de Aprobación
                    </h2>

                    <div class="step-card">
                        <h5 class="mb-3">¿Para qué sirve?</h5>
                        <p>
                            Este reporte lista todas las solicitudes de aprobación de servicios (salidas pedagógicas, deportivas, 
                            eventos internos) mostrando quién solicitó, quién debe aprobar, el estado, y la fecha de resolución.
                        </p>

                        <p><strong>Usa este reporte para:</strong></p>
                        <ul>
                            <li>Control de flujos de aprobación: ¿hay solicitudes atrasadas?</li>
                            <li>Auditoría de autorizaciones: ¿quién aprobó qué y cuándo?</li>
                            <li>Estadísticas de aprobaciones/rechazos</li>
                            <li>Seguimiento de solicitudes pendientes por aprobador</li>
                        </ul>

                        <h5 class="mt-4 mb-3">Cómo generar el reporte:</h5>
                        <ol>
                            <li>Haz clic en la pestaña "<strong>Solicitudes</strong>"</li>
                            <li>Selecciona <strong>Fecha Desde</strong> y <strong>Fecha Hasta</strong> (rango de fechas de solicitud)</li>
                            <li>Opcionalmente, filtra por <strong>Tipo</strong>:
                                <ul>
                                    <li>"Todos" → Muestra todo tipo de solicitudes</li>
                                    <li>"Pedagógicas" → Solo solicitudes de salidas pedagógicas</li>
                                    <li>"Deportivas" → Solo solicitudes de salidas deportivas</li>
                                    <li>"Eventos" → Solo solicitudes de eventos internos</li>
                                </ul>
                            </li>
                            <li>Opcionalmente, filtra por <strong>Estado</strong>:
                                <ul>
                                    <li>"Todos" → Muestra todo estado</li>
                                    <li>"Pendientes" → Solo solicitudes que aún no se resuelven</li>
                                    <li>"Aprobadas" → Solo solicitudes autorizadas</li>
                                    <li>"Rechazadas" → Solo solicitudes no autorizadas</li>
                                </ul>
                            </li>
                            <li>Haz clic en <strong>"Generar"</strong></li>
                        </ol>

                        <h5 class="mt-4 mb-3">Información mostrada:</h5>

                        <p><strong>Tarjetas resumen:</strong></p>
                        <ul>
                            <li>Total de solicitudes</li>
                            <li>Cantidad de pendientes</li>
                            <li>Cantidad de aprobadas</li>
                            <li>Cantidad de rechazadas</li>
                        </ul>

                        <p><strong>Tabla detallada con columnas:</strong></p>
                        <ul>
                            <li><strong>Fecha Solicitud:</strong> Cuándo se creó la solicitud (fecha y hora)</li>
                            <li><strong>Tipo:</strong> Salida Pedagógica, Salida Deportiva, o Evento Interno</li>
                            <li><strong>Solicitante:</strong> Quién creó la solicitud</li>
                            <li><strong>Aprobador:</strong> Quién debe/debió aprobarla</li>
                            <li><strong>Estado:</strong> Pendiente, Aprobada, o Rechazada</li>
                            <li><strong>Fecha Resolución:</strong> Cuándo se aprobó/rechazó (o "-" si aún está pendiente)</li>
                        </ul>

                        <div class="tip-box">
                            <i class="bi bi-lightbulb text-success me-2"></i>
                            <strong>Seguimiento de pendientes:</strong> Filtra por Estado = "Pendientes" para ver qué solicitudes 
                            están esperando aprobación. Si hay solicitudes muy antiguas pendientes, podría indicar que un 
                            aprobador está retrasado o no ha revisado su bandeja.
                        </div>

                        <h5 class="mt-4 mb-3">Exportar el reporte:</h5>
                        <p>Exporta a Excel para análisis de tiempos de aprobación o a PDF para auditorías.</p>
                    </div>
                </section>

                <!-- SECCIÓN 8: Solución de problemas -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-question-circle me-2"></i>
                        Solución de problemas comunes
                    </h2>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-exclamation-circle me-2"></i>
                            No aparecen datos después de generar el reporte
                        </div>
                        <p><strong>Causas posibles:</strong></p>
                        <ul>
                            <li>No hay datos registrados en el rango de fechas seleccionado</li>
                            <li>Los filtros aplicados son muy restrictivos</li>
                            <li>Error de conexión con la base de datos</li>
                        </ul>
                        <p><strong>Solución:</strong></p>
                        <ul>
                            <li>Amplía el rango de fechas</li>
                            <li>Quita o cambia los filtros opcionales</li>
                            <li>Verifica que haya datos registrados en el módulo (salidas, eventos, etc.)</li>
                            <li>Si el mensaje dice "No se encontraron...", es normal: significa que no hay datos para ese criterio</li>
                            <li>Si sale un mensaje de error rojo, contacta al administrador</li>
                        </ul>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-exclamation-circle me-2"></i>
                            Los botones de exportar están deshabilitados (grises)
                        </div>
                        <p><strong>Causa:</strong></p>
                        <p>Los botones de exportación solo se habilitan DESPUÉS de generar el reporte exitosamente.</p>
                        <p><strong>Solución:</strong></p>
                        <ul>
                            <li>Primero genera el reporte haciendo clic en "Generar"</li>
                            <li>Espera a que aparezca la tabla con datos</li>
                            <li>Entonces los botones Excel y PDF se habilitarán automáticamente</li>
                        </ul>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-exclamation-circle me-2"></i>
                            Al exportar a Excel o PDF no pasa nada
                        </div>
                        <p><strong>Causas posibles:</strong></p>
                        <ul>
                            <li>Bloqueador de pop-ups activo</li>
                            <li>Navegador bloqueando descargas automáticas</li>
                            <li>Librerías de exportación no cargaron</li>
                        </ul>
                        <p><strong>Solución:</strong></p>
                        <ul>
                            <li>Verifica que tu navegador permita descargas automáticas desde SchoolNet</li>
                            <li>Desactiva temporalmente bloqueadores de pop-ups para este sitio</li>
                            <li>Revisa la carpeta de descargas de tu navegador, el archivo pudo haberse descargado</li>
                            <li>Intenta con otro navegador (Chrome, Firefox, Edge)</li>
                        </ul>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-exclamation-circle me-2"></i>
                            El reporte muestra valores en $0 aunque sé que hay costos registrados
                        </div>
                        <p><strong>Causas posibles:</strong></p>
                        <ul>
                            <li>Los recorridos/eventos fueron cancelados o suspendidos (cancelados = $0)</li>
                            <li>Los costos aún no se han registrado en el sistema</li>
                            <li>Estás filtrando por un estado que excluye los que tienen costo</li>
                        </ul>
                        <p><strong>Solución:</strong></p>
                        <ul>
                            <li>Verifica el estado de los registros en las páginas operativas</li>
                            <li>Confirma que los costos estén efectivamente registrados (ej: servicios de apoyo de eventos)</li>
                            <li>Si filtraste por estado "Cancelado" o "Suspendido", es normal que muestren $0</li>
                        </ul>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-exclamation-circle me-2"></i>
                            Los números del consolidado no cuadran con el detalle
                        </div>
                        <p><strong>Causa más común:</strong></p>
                        <p>Estás comparando períodos diferentes. El consolidado es mensual, el detalle es por rango personalizado.</p>
                        <p><strong>Solución:</strong></p>
                        <ul>
                            <li>Asegúrate de usar el mismo período en ambos reportes</li>
                            <li>Ejemplo: Si generas consolidado de Enero 2026, genera el detalle desde 2026-01-01 hasta 2026-01-31</li>
                            <li>Verifica que en el detalle no hayas filtrado por tipo específico (debe ser "Todos los tipos")</li>
                        </ul>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-exclamation-circle me-2"></i>
                            El archivo Excel se descarga pero no abre correctamente
                        </div>
                        <p><strong>Causa:</strong></p>
                        <p>Problema de compatibilidad de versión de Excel o configuración regional.</p>
                        <p><strong>Solución:</strong></p>
                        <ul>
                            <li>Intenta abrir con Excel 2016 o superior</li>
                            <li>Si tienes LibreOffice o Google Sheets, ábrelo ahí</li>
                            <li>Al abrir, si Excel pregunta, confirma que confías en el archivo</li>
                            <li>Como alternativa, usa la exportación a PDF que es más compatible</li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN 9: Buenas prácticas -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-award me-2"></i>
                        Buenas prácticas
                    </h2>

                    <div class="step-card">
                        <h5 class="mb-3">Recomendaciones para aprovechar mejor los reportes:</h5>

                        <div class="tip-box mb-3">
                            <strong>1. Genera el consolidado de transporte al final de cada mes</strong>
                            <p class="mb-0">
                                Antes de pagar la factura del proveedor de transporte, genera el consolidado del mes. Compara 
                                la fila de TOTAL con el monto facturado. Si no cuadran, genera el detalle para identificar 
                                discrepancias.
                            </p>
                        </div>

                        <div class="tip-box mb-3">
                            <strong>2. Exporta siempre a Excel para análisis profundos</strong>
                            <p class="mb-0">
                                Si necesitas hacer cálculos adicionales, gráficos, o comparaciones, exporta a Excel. Puedes 
                                generar reportes de varios meses y consolidarlos manualmente en una hoja de cálculo maestra.
                            </p>
                        </div>

                        <div class="tip-box mb-3">
                            <strong>3. Usa PDF para archivar y presentar</strong>
                            <p class="mb-0">
                                Los PDF son ideales para imprimir, enviar por correo como respaldo, o archivar físicamente. 
                                Incluyen fecha de generación, lo que los hace trazables.
                            </p>
                        </div>

                        <div class="tip-box mb-3">
                            <strong>4. Filtra por tipo en el detalle para análisis específicos</strong>
                            <p class="mb-0">
                                Si necesitas analizar solo un tipo de servicio (ej: cuánto se gastó en extracurriculares el 
                                trimestre), filtra por ese tipo en el detalle. Es más claro que ver todo mezclado.
                            </p>
                        </div>

                        <div class="tip-box mb-3">
                            <strong>5. Revisa pendientes de solicitudes semanalmente</strong>
                            <p class="mb-0">
                                Genera el reporte de solicitudes filtrando por "Pendientes" una vez por semana. Si hay 
                                solicitudes muy antiguas sin resolver, contacta al aprobador correspondiente.
                            </p>
                        </div>

                        <div class="tip-box mb-3">
                            <strong>6. Verifica costos pendientes en eventos antes de cerrar mes</strong>
                            <p class="mb-0">
                                Antes de cerrar el mes, genera el reporte de eventos. Si hay "Pendientes" en servicios, 
                                recuerda a las áreas que registren sus costos. Sin esto, el total será incompleto.
                            </p>
                        </div>

                        <div class="tip-box mb-3">
                            <strong>7. Guarda copias históricas</strong>
                            <p class="mb-0">
                                Exporta y guarda los reportes mensuales (al menos el consolidado) en una carpeta organizada 
                                por año. Esto te ayudará en auditorías futuras o análisis de tendencias anuales.
                            </p>
                        </div>

                        <div class="tip-box mb-0">
                            <strong>8. Compara mes a mes</strong>
                            <p class="mb-0">
                                Genera consolidados de varios meses consecutivos y compáralos. ¿El costo de transporte subió 
                                mucho? ¿Hay más salidas este mes que el anterior? Esto ayuda a tomar decisiones presupuestales.
                            </p>
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN 10: Preguntas frecuentes -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-chat-dots me-2"></i>
                        Preguntas frecuentes
                    </h2>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¿Los reportes incluyen datos de años anteriores?
                        </div>
                        <p>
                            Sí. Puedes generar reportes de cualquier período desde que se implementó SchoolNet. Solo selecciona 
                            el año correspondiente (en consolidado) o el rango de fechas (en detalle, eventos, solicitudes).
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¿Por qué el consolidado solo permite filtro mensual y no rango personalizado?
                        </div>
                        <p>
                            El consolidado está diseñado específicamente para validar facturas mensuales del proveedor, que 
                            siempre se facturan por mes completo. Si necesitas un rango personalizado, usa el reporte de "Detalle" 
                            y suma manualmente los totales por tipo.
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¿Puedo filtrar el detalle de transporte por destino específico?
                        </div>
                        <p>
                            No directamente. El reporte detalle solo filtra por tipo de servicio. Sin embargo, puedes exportar 
                            a Excel y usar las funciones de filtro de Excel para buscar por destino en la columna "Detalle".
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¿Los costos en los reportes incluyen IVA?
                        </div>
                        <p>
                            Los reportes muestran los valores tal como están registrados en el sistema. Si el tarifario de 
                            transporte o menús de refrigerios incluyen IVA, entonces sí. Si no lo incluyen, no. Consulta con 
                            el administrador cómo están configurados los tarifarios.
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¿Puedo programar que los reportes se envíen automáticamente por correo?
                        </div>
                        <p>
                            No en la versión actual. Los reportes deben generarse manualmente. Sin embargo, puedes exportar 
                            y enviar por correo el archivo resultante a quien necesites.
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¿El reporte de solicitudes muestra el motivo de rechazo?
                        </div>
                        <p>
                            La información de motivo de rechazo está en la base de datos, pero NO se muestra en la tabla del 
                            reporte por espacio. Si necesitas ver motivos de rechazo, consulta directamente la solicitud en 
                            la página de "Aprobaciones de Servicios" donde sí se muestra.
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¿Qué pasa si cambio el tarifario de transporte a mitad de mes?
                        </div>
                        <p>
                            Los reportes muestran las tarifas <strong>congeladas</strong> que se usaron en cada salida/recorrido. 
                            Es decir, cada salida guarda la tarifa que estaba vigente al momento de crearla. Cambios posteriores 
                            en el tarifario NO afectan salidas ya registradas. Por eso el reporte siempre mostrará costos 
                            consistentes con lo que efectivamente se cobró en su momento.
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¿Puedo ver en el reporte quién registró cada costo de servicios de eventos?
                        </div>
                        <p>
                            No. El reporte de eventos solo muestra si el costo está registrado (número) o pendiente ("Pendientes"). 
                            Si necesitas saber quién registró qué, esa información está en los logs del sistema (consulta con 
                            el administrador).
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¿Los reportes se pueden imprimir directamente sin exportar?
                        </div>
                        <p>
                            Técnicamente sí (Ctrl+P o Cmd+P), pero NO es recomendable. La página web no está optimizada para 
                            impresión. Es mejor exportar a PDF primero, que genera un formato profesional listo para imprimir.
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¿Cuánto tiempo tarda en generar un reporte?
                        </div>
                        <p>
                            Depende de la cantidad de datos:
                        </p>
                        <ul>
                            <li>Reporte pequeño (1 mes con pocos recorridos): 1-3 segundos</li>
                            <li>Reporte mediano (varios meses, muchos recorridos): 5-10 segundos</li>
                            <li>Reporte grande (todo un año escolar): hasta 30 segundos</li>
                        </ul>
                        <p>
                            Mientras carga, verás un spinner (círculo girando). NO cierres la página mientras genera.
                        </p>
                    </div>
                </section>

                <!-- TARJETA PARA REPORTAR BUGS -->
                <div class="bug-report-card">
                    <i class="bi bi-bug-fill icon-large"></i>
                    <h4 class="mb-3">¿Encontraste un problema o tienes una sugerencia?</h4>
                    <p class="mb-4">
                        Si experimentaste un error, algo no funciona como esperas, o tienes 
                        una sugerencia para mejorar el sistema, repórtalo aquí.
                    </p>
                    <a href="../report-bug.html" class="btn btn-light btn-lg">
                        <i class="bi bi-exclamation-triangle me-2"></i>Reportar Bug o Problema
                    </a>
                </div>

            </div>
        </div>

    </div>

    <!-- BOTÓN FLOTANTE PARA REPORTAR BUGS -->
    <a href="../report-bug.html" class="btn btn-lg floating-bug-button" title="Reportar Bug">
        <i class="bi bi-bug-fill me-2"></i>Reportar Bug
    </a>

    <!-- SCRIPTS - ORDEN CRÍTICO -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/js/config.js"></script>
    
    <script>
        // ==========================================
        // VARIABLES GLOBALES
        // ==========================================
        let currentUser = null;

        // ==========================================
        // CONFIGURACIÓN DE LA PÁGINA
        // ==========================================
        const PAGE_CONFIG = {
            moduleName: 'Servicios',
            modulePath: 'services',
            pageTitle: 'Reportes de Servicios',
            pagePath: 'reports.html',
            moduleDescription: 'Consolidados, soportes de pago y reportes operativos'
        };

        // ==========================================
        // INICIALIZACIÓN
        // ==========================================
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('📖 Iniciando página de manual...');
            
            try {
                // Verificar si existe la función de colores corporativos
                if (typeof loadAndApplyBrandColors === 'function') {
                    await loadAndApplyBrandColors();
                }
                
                // Verificar sesión si la función existe
                if (typeof getStoredSession === 'function') {
                    const session = getStoredSession();
                    if (session && session.user) {
                        currentUser = session.user;
                    }
                }
                
                // Actualizar información en la página
                updatePageInfo();
                
                console.log('✅ Página de manual lista');
                
            } catch (error) {
                console.error('❌ Error inicializando página:', error);
                if (typeof showMessage === 'function') {
                    showMessage('Error al cargar la página: ' + error.message, 'danger');
                }
            }
        });

        // ==========================================
        // ACTUALIZAR INFORMACIÓN DE LA PÁGINA
        // ==========================================
        function updatePageInfo() {
            // Actualizar title
            document.title = `Manual - ${PAGE_CONFIG.moduleName} - ${PAGE_CONFIG.pageTitle} - SchoolNet`;
        }

        // ==========================================
        // UTILIDADES DE LOADING
        // ==========================================
        function showLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.remove('hidden');
            }
        }

        function hideLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.add('hidden');
            }
        }

        // ==========================================
        // FUNCIÓN DE MENSAJES
        // ==========================================
        function showMessage(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            if (!alertContainer) return;
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertContainer.appendChild(alertDiv);
            
            // Auto-remove después de 5 segundos
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

    </script>
</body>
</html>
