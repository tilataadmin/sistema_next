<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- VERSI√ìN DE LA P√ÅGINA -->
    <meta name="page-version" content="26.02.08.18.00">
    
    <title>Manual - Servicios - Extracurriculares - SchoolNet</title>
    
    <!-- Bootstrap CSS - VERSI√ìN FIJA PROBADA -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-overlay.hidden {
            display: none;
        }
        
        .loading-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Encabezado discreto */
        .manual-header {
            background: #f8f9fa;
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding: 1.5rem 0;
            margin-bottom: 2rem;
        }

        .manual-header h1 {
            font-size: 1.75rem;
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 0.25rem;
        }

        .manual-header .subtitle {
            color: #6c757d;
            font-size: 0.95rem;
        }

        /* Info card */
        .info-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Secciones del manual */
        .section-title {
            color: var(--system-primary-color, #1B365D);
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding-bottom: 0.5rem;
            margin-top: 2.5rem;
            margin-bottom: 1.5rem;
        }

        .step-card {
            background: #f8f9fa;
            border-left: 4px solid var(--system-primary-color, #1B365D);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-radius: 4px;
        }

        .step-number {
            background: var(--system-primary-color, #1B365D);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 0.75rem;
        }

        .info-box {
            background: #d1ecf1;
            border-left: 4px solid #0dcaf0;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .tip-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .faq-item {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .faq-question {
            font-weight: 600;
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 0.75rem;
        }

        /* Tarjeta para reportar bugs */
        .bug-report-card {
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .bug-report-card h5 {
            color: white;
        }

        /* Bot√≥n flotante para reportar bugs */
        .floating-bug-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            background: var(--system-primary-color, #1B365D) !important;
            border-color: var(--system-primary-color, #1B365D) !important;
        }

        .floating-bug-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
            opacity: 0.9;
        }

        .icon-large {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        /* Lista de caracter√≠sticas */
        .feature-list {
            list-style: none;
            padding-left: 0;
        }

        .feature-list li {
            padding: 0.5rem 0;
            padding-left: 2rem;
            position: relative;
        }

        .feature-list li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* Subsecciones */
        .subsection-title {
            color: var(--system-primary-color, #1B365D);
            font-size: 1.1rem;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            padding-left: 1rem;
            border-left: 3px solid var(--system-primary-color, #1B365D);
        }
    </style>
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="mb-0">Cargando...</p>
        </div>
    </div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="container-fluid">

        <!-- ENCABEZADO DISCRETO -->
        <div class="manual-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1>
                            <i class="bi bi-book me-2"></i>
                            Manual: Servicios
                        </h1>
                        <p class="subtitle mb-0">Transporte Extracurriculares</p>
                    </div>
                    <div class="col-md-4 text-md-end mt-3 mt-md-0">
                        <a href="../../modules/services/extracurricular.html" class="btn btn-outline-primary">
                            <i class="bi bi-arrow-left me-1"></i>Volver al M√≥dulo
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- CONTENEDOR DE ALERTAS -->
        <div id="alertContainer"></div>

        <div class="row">
            <div class="col-lg-10 mx-auto">

                <!-- INFORMACI√ìN CONTEXTUAL -->
                <div class="info-card">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h6 class="text-muted mb-2">Manual de:</h6>
                            <h5 class="mb-1"><strong id="display-module">Servicios</strong></h5>
                            <p class="text-muted mb-0 small" id="display-page">Transporte Extracurriculares</p>
                        </div>
                        <div class="col-md-6 text-md-end mt-3 mt-md-0">
                            <p class="small text-muted mb-0">
                                <i class="bi bi-info-circle me-1"></i>
                                Si tienes dudas o encuentras alg√∫n problema,<br>
                                puedes reportarlo usando el bot√≥n de abajo.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- CONTENIDO DEL MANUAL -->
                <!-- ============================================ -->

                <!-- SECCI√ìN 1: ¬øQu√© es? -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-info-circle me-2"></i>
                        ¬øQu√© es Transporte Extracurriculares?
                    </h2>
                    
                    <div class="step-card">
                        <p class="lead">
                            La p√°gina de <strong>Transporte Extracurriculares</strong> es el sistema de gesti√≥n completo 
                            para el transporte de actividades extracurriculares del colegio. Maneja todo el ciclo: desde 
                            la configuraci√≥n semestral hasta el registro diario y la liquidaci√≥n mensual.
                        </p>
                        
                        <p>
                            A diferencia de las salidas pedag√≥gicas (que son eventos √∫nicos a destinos espec√≠ficos), 
                            las extracurriculares son actividades recurrentes (deportes, artes, clubes) que requieren 
                            transporte regular a destinos conocidos y en d√≠as fijos de la semana.
                        </p>

                        <p><strong>El sistema se organiza en 4 m√≥dulos principales:</strong></p>
                        
                        <ol>
                            <li><strong>Ciclos Semestrales:</strong> Define per√≠odos acad√©micos (semestres) con fechas 
                                de inicio/fin y d√≠as de la semana programados</li>
                            <li><strong>Configuraci√≥n de Veh√≠culos:</strong> Por cada ciclo y d√≠a de la semana, define 
                                cu√°ntos veh√≠culos se necesitan, de qu√© capacidad, y congela la tarifa</li>
                            <li><strong>Registro Diario:</strong> Cada d√≠a, registra si los veh√≠culos programados se 
                                realizaron o no, cu√°ntos pasajeros llevaron, o por qu√© se cancelaron</li>
                            <li><strong>Resumen Mensual:</strong> Consolida los registros del mes para generar la 
                                liquidaci√≥n y el total a pagar al proveedor</li>
                        </ol>

                        <div class="info-box">
                            <i class="bi bi-lightbulb text-info me-2"></i>
                            <strong>Ejemplo pr√°ctico:</strong>
                            <p class="mb-0 mt-2">
                                Ciclo: "Primer Semestre 2025-2026" (enero a junio)<br>
                                D√≠as programados: Lunes, Mi√©rcoles, Viernes<br>
                                Configuraci√≥n Lunes: 2 veh√≠culos de 30 pasajeros a $180,000 c/u<br>
                                Registro 27 enero (lunes): Veh√≠culo 1 realizado (28 pasajeros), Veh√≠culo 2 no realizado (lluvia)<br>
                                Resumen enero: 8 recorridos realizados √ó $180,000 = $1,440,000
                            </p>
                        </div>
                    </div>
                </section>

                <!-- SECCI√ìN 2: Caracter√≠sticas principales -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-star me-2"></i>
                        Caracter√≠sticas principales
                    </h2>
                    
                    <div class="step-card">
                        <ul class="feature-list">
                            <li><strong>Gesti√≥n por ciclos acad√©micos:</strong> Organiza el transporte por semestres 
                                o per√≠odos acad√©micos, cada uno con sus propias fechas y d√≠as programados.</li>
                            
                            <li><strong>Configuraci√≥n flexible de veh√≠culos:</strong> Define diferentes configuraciones 
                                para cada d√≠a de la semana, con cambios vigentes desde fechas espec√≠ficas.</li>
                            
                            <li><strong>Congelamiento de tarifas:</strong> Al configurar un veh√≠culo, se congela la 
                                tarifa del tarifario en ese momento, protegiendo de cambios futuros en precios.</li>
                            
                            <li><strong>Registro diario simplificado:</strong> Marca cada veh√≠culo como realizado o no, 
                                registra pasajeros o motivo de cancelaci√≥n con pocos clics.</li>
                            
                            <li><strong>Validaci√≥n autom√°tica:</strong> El sistema solo permite registrar d√≠as que est√°n 
                                dentro del ciclo activo y que son d√≠as programados.</li>
                            
                            <li><strong>Liquidaci√≥n mensual autom√°tica:</strong> Consolida todos los registros del mes 
                                y calcula el total a pagar bas√°ndose en recorridos completados.</li>
                            
                            <li><strong>Hist√≥rico completo:</strong> Mantiene registro de todos los recorridos realizados, 
                                cancelados, pasajeros transportados y motivos de cancelaci√≥n.</li>
                        </ul>
                    </div>
                </section>

                <!-- SECCI√ìN 3: Antes de comenzar -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-clipboard-check me-2"></i>
                        Antes de comenzar
                    </h2>
                    
                    <div class="step-card">
                        <h5 class="mb-3">Requisitos previos:</h5>
                        
                        <ul>
                            <li><strong>Permiso necesario:</strong> Debes tener el permiso "Extracurriculares" activo 
                                en tu usuario.</li>
                            
                            <li><strong>Tarifario configurado:</strong> Debe existir un tarifario de extracurriculares 
                                activo en la p√°gina de Configuraci√≥n de Servicios.</li>
                            
                            <li><strong>A√±o acad√©mico vigente:</strong> Debe haber al menos un a√±o acad√©mico registrado 
                                en el sistema.</li>
                            
                            <li><strong>Entender la secuencia:</strong> Primero crea ciclos, luego configura veh√≠culos 
                                para esos ciclos, despu√©s registra diariamente, finalmente liquida mensualmente.</li>
                        </ul>

                        <div class="warning-box">
                            <i class="bi bi-exclamation-triangle text-warning me-2"></i>
                            <strong>Secuencia obligatoria:</strong>
                            <p class="mb-0 mt-2">
                                No puedes saltarte pasos. Necesitas un ciclo activo antes de configurar veh√≠culos. 
                                Necesitas veh√≠culos configurados antes de registrar diariamente. Esta secuencia 
                                garantiza que cada registro tenga toda la informaci√≥n necesaria (tarifa, capacidad, 
                                fecha vigente).
                            </p>
                        </div>
                    </div>
                </section>

                <!-- SECCI√ìN 4: Gu√≠a paso a paso -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-list-ol me-2"></i>
                        Gu√≠a paso a paso
                    </h2>

                    <!-- SUBSECCI√ìN: Ciclos Semestrales -->
                    <div class="subsection-title">
                        <i class="bi bi-calendar-range me-2"></i>Paso 1: Crear Ciclos Semestrales
                    </div>

                    <div class="step-card">
                        <h5>¬øQu√© son los ciclos?</h5>
                        <p>
                            Un ciclo semestral define un per√≠odo acad√©mico durante el cual habr√° transporte extracurricular. 
                            Normalmente coincide con un semestre acad√©mico.
                        </p>

                        <h6 class="mt-3">Crear un nuevo ciclo:</h6>
                        <ol>
                            <li>Abre la secci√≥n <strong>"Ciclos Semestrales"</strong> (primer acorde√≥n)</li>
                            <li>Haz clic en <strong>"Nuevo Ciclo"</strong></li>
                            <li>Completa el formulario:
                                <ul>
                                    <li><strong>A√±o acad√©mico:</strong> Selecciona el a√±o acad√©mico correspondiente</li>
                                    <li><strong>Nombre del ciclo:</strong> Ejemplo: "Primer semestre 2025-2026"</li>
                                    <li><strong>Fecha inicio:</strong> Primer d√≠a del ciclo</li>
                                    <li><strong>Fecha fin:</strong> √öltimo d√≠a del ciclo</li>
                                    <li><strong>D√≠as programados:</strong> Marca los d√≠as de la semana que tendr√°n 
                                        transporte (ejemplo: Lunes, Mi√©rcoles, Viernes)</li>
                                    <li><strong>Activo:</strong> Deja marcado</li>
                                </ul>
                            </li>
                            <li>Haz clic en <strong>"Guardar"</strong></li>
                        </ol>

                        <div class="tip-box">
                            <i class="bi bi-lightbulb text-success me-2"></i>
                            <strong>Buena pr√°ctica:</strong> Crea el ciclo antes de que inicie el semestre. As√≠ puedes 
                            configurar los veh√≠culos con anticipaci√≥n y el registro diario funcionar√° desde el primer d√≠a.
                        </div>

                        <h6 class="mt-3">Editar un ciclo:</h6>
                        <p>
                            Puedes editar fechas, d√≠as programados o el estado activo/inactivo. Sin embargo, si ya hay 
                            veh√≠culos configurados y registros diarios, ten cuidado al modificar d√≠as programados.
                        </p>
                    </div>

                    <!-- SUBSECCI√ìN: Configuraci√≥n de Veh√≠culos -->
                    <div class="subsection-title">
                        <i class="bi bi-truck me-2"></i>Paso 2: Configurar Veh√≠culos por D√≠a
                    </div>

                    <div class="step-card">
                        <h5>¬øQu√© es la configuraci√≥n de veh√≠culos?</h5>
                        <p>
                            Para cada d√≠a programado del ciclo, defines cu√°ntos veh√≠culos se necesitan, de qu√© capacidad, 
                            y desde qu√© fecha es vigente esa configuraci√≥n. La tarifa del tarifario se congela al crear 
                            la configuraci√≥n.
                        </p>

                        <h6 class="mt-3">Crear una configuraci√≥n de veh√≠culos:</h6>
                        <ol>
                            <li>Ve a la secci√≥n <strong>"Configuraci√≥n de Veh√≠culos"</strong></li>
                            <li>En el selector de arriba, elige el ciclo para el que vas a configurar</li>
                            <li>Haz clic en <strong>"Nueva Configuraci√≥n"</strong></li>
                            <li>Completa el formulario:
                                <ul>
                                    <li><strong>D√≠a de la semana:</strong> Selecciona uno de los d√≠as programados del ciclo 
                                        (ejemplo: Lunes)</li>
                                    <li><strong>Vigente desde:</strong> Fecha desde la cual aplica esta configuraci√≥n. 
                                        Normalmente es el inicio del ciclo, pero puede ser una fecha posterior si hubo cambios</li>
                                    <li><strong>Tipo de veh√≠culo:</strong> Selecciona del tarifario (ejemplo: 30 pasajeros). 
                                        Ver√°s la capacidad y tarifa actual</li>
                                    <li><strong>Cantidad de veh√≠culos:</strong> Cu√°ntos veh√≠culos de ese tipo se necesitan 
                                        ese d√≠a (ejemplo: 2)</li>
                                    <li><strong>Activa:</strong> Deja marcado</li>
                                </ul>
                            </li>
                            <li>Haz clic en <strong>"Guardar"</strong></li>
                        </ol>

                        <div class="info-box">
                            <i class="bi bi-info-circle text-info me-2"></i>
                            <strong>Congelamiento de tarifa:</strong>
                            <p class="mb-0 mt-2">
                                Al guardar la configuraci√≥n, el sistema congela la tarifa que tiene el tarifario en ese momento. 
                                Aunque despu√©s cambies las tarifas en Configuraci√≥n de Servicios, esta configuraci√≥n mantendr√° 
                                la tarifa original. Esto protege el presupuesto de cambios inesperados.
                            </p>
                        </div>

                        <h6 class="mt-3">Cambiar configuraci√≥n a mitad de ciclo:</h6>
                        <p>
                            Si a mitad del ciclo necesitas m√°s o menos veh√≠culos, o cambiar la capacidad:
                        </p>
                        <ol>
                            <li>No edites la configuraci√≥n existente</li>
                            <li>Crea una <strong>nueva configuraci√≥n</strong> para el mismo d√≠a</li>
                            <li>Pon como "Vigente desde" la fecha del cambio</li>
                            <li>El sistema usar√° autom√°ticamente la configuraci√≥n m√°s reciente para cada fecha</li>
                        </ol>

                        <div class="warning-box">
                            <i class="bi bi-exclamation-triangle text-warning me-2"></i>
                            <strong>Importante:</strong> Puedes tener m√∫ltiples configuraciones para el mismo d√≠a de la 
                            semana, cada una vigente desde fechas diferentes. El sistema siempre usa la configuraci√≥n m√°s 
                            reciente que sea v√°lida para la fecha que est√°s registrando.
                        </div>
                    </div>

                    <!-- SUBSECCI√ìN: Registro Diario -->
                    <div class="subsection-title">
                        <i class="bi bi-calendar-check me-2"></i>Paso 3: Registrar Diariamente
                    </div>

                    <div class="step-card">
                        <h5>¬øQu√© es el registro diario?</h5>
                        <p>
                            Cada d√≠a que hay transporte programado, debes registrar si cada veh√≠culo configurado se realiz√≥ 
                            o no. Si se realiz√≥, registras cu√°ntos pasajeros llev√≥. Si no se realiz√≥, registras el motivo.
                        </p>

                        <h6 class="mt-3">Hacer el registro de un d√≠a:</h6>
                        <ol>
                            <li>Ve a la secci√≥n <strong>"Registro Diario"</strong></li>
                            <li>Selecciona la fecha que quieres registrar (puede ser hoy u otro d√≠a)</li>
                            <li>El sistema autom√°ticamente:
                                <ul>
                                    <li>Verifica que esa fecha est√© dentro de un ciclo activo</li>
                                    <li>Verifica que el d√≠a de la semana est√© programado en el ciclo</li>
                                    <li>Carga la configuraci√≥n de veh√≠culos vigente para esa fecha</li>
                                    <li>Muestra una tarjeta por cada veh√≠culo configurado</li>
                                </ul>
                            </li>
                            <li>Para cada veh√≠culo:
                                <ul>
                                    <li><strong>Si se realiz√≥:</strong> Deja el interruptor en "‚úÖ Realizado" y escribe 
                                        cu√°ntos pasajeros llev√≥</li>
                                    <li><strong>Si NO se realiz√≥:</strong> Cambia el interruptor a "‚ùå No realizado" y 
                                        escribe el motivo (ejemplo: "Lluvia torrencial", "Festivo", "Mantenimiento veh√≠culo")</li>
                                </ul>
                            </li>
                            <li>Haz clic en <strong>"Guardar Registro del D√≠a"</strong></li>
                        </ol>

                        <div class="tip-box">
                            <i class="bi bi-lightbulb text-success me-2"></i>
                            <strong>Registro en tiempo real:</strong> Puedes registrar el mismo d√≠a (en tiempo real) o 
                            d√≠as pasados. El sistema permite editar registros previos en caso de correcciones.
                        </div>

                        <div class="warning-box">
                            <i class="bi bi-exclamation-triangle text-warning me-2"></i>
                            <strong>Validaciones del sistema:</strong>
                            <ul class="mb-0 mt-2">
                                <li>Si la fecha no est√° dentro de ning√∫n ciclo activo, no permitir√° registrar</li>
                                <li>Si el d√≠a de la semana no es uno de los d√≠as programados, no permitir√° registrar</li>
                                <li>Si no hay configuraci√≥n de veh√≠culos para ese d√≠a, no permitir√° registrar</li>
                                <li>Si un veh√≠culo no se realiz√≥, el motivo es obligatorio</li>
                            </ul>
                        </div>
                    </div>

                    <!-- SUBSECCI√ìN: Resumen Mensual -->
                    <div class="subsection-title">
                        <i class="bi bi-bar-chart me-2"></i>Paso 4: Consultar Resumen Mensual (Liquidaci√≥n)
                    </div>

                    <div class="step-card">
                        <h5>¬øQu√© es el resumen mensual?</h5>
                        <p>
                            Es la liquidaci√≥n mensual que muestra todos los recorridos realizados en el mes, agrupados 
                            por configuraci√≥n, con el total de pasajeros transportados y el monto total a pagar al proveedor.
                        </p>

                        <h6 class="mt-3">Ver el resumen de un mes:</h6>
                        <ol>
                            <li>Ve a la secci√≥n <strong>"Resumen Mensual"</strong></li>
                            <li>Selecciona el mes y a√±o que quieres consultar</li>
                            <li>El sistema muestra:
                                <ul>
                                    <li>Cada configuraci√≥n que tuvo recorridos ese mes</li>
                                    <li>Cu√°ntos recorridos se completaron</li>
                                    <li>Total de pasajeros transportados</li>
                                    <li>Tarifa congelada de esa configuraci√≥n</li>
                                    <li>Subtotal (recorridos √ó tarifa)</li>
                                    <li><strong>Total del mes:</strong> Suma de todos los subtotales</li>
                                </ul>
                            </li>
                        </ol>

                        <div class="info-box">
                            <i class="bi bi-info-circle text-info me-2"></i>
                            <strong>Ejemplo de resumen:</strong>
                            <table class="table table-sm mt-2 mb-0">
                                <thead>
                                    <tr>
                                        <th>Configuraci√≥n</th>
                                        <th>Recorridos</th>
                                        <th>Pasajeros</th>
                                        <th>Tarifa</th>
                                        <th>Subtotal</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Ciclo 1 ‚Äî Lunes (30 pas.)</td>
                                        <td>8</td>
                                        <td>220</td>
                                        <td>$180,000</td>
                                        <td>$1,440,000</td>
                                    </tr>
                                    <tr>
                                        <td>Ciclo 1 ‚Äî Mi√©rcoles (30 pas.)</td>
                                        <td>9</td>
                                        <td>248</td>
                                        <td>$180,000</td>
                                        <td>$1,620,000</td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr class="fw-bold">
                                        <td colspan="4">Total del mes:</td>
                                        <td>$3,060,000</td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>

                        <div class="tip-box">
                            <i class="bi bi-lightbulb text-success me-2"></i>
                            <strong>Uso del resumen:</strong> Este reporte es ideal para validar la factura del proveedor 
                            de transporte. El total del mes debe coincidir con lo que el proveedor cobra (considerando solo 
                            los recorridos efectivamente realizados).
                        </div>
                    </div>
                </section>

                <!-- SECCI√ìN 5: Soluci√≥n de problemas -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-question-circle me-2"></i>
                        Soluci√≥n de problemas comunes
                    </h2>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-exclamation-circle me-2"></i>
                            No puedo crear una configuraci√≥n de veh√≠culos
                        </div>
                        <p><strong>Causa m√°s probable:</strong></p>
                        <p>No has seleccionado un ciclo en el selector de arriba.</p>
                        <p><strong>Soluci√≥n:</strong></p>
                        <ul>
                            <li>Aseg√∫rate de seleccionar un ciclo activo en el selector antes de hacer clic en "Nueva Configuraci√≥n"</li>
                            <li>Si no hay ciclos en el selector, primero crea un ciclo semestral</li>
                        </ul>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-exclamation-circle me-2"></i>
                            Al seleccionar una fecha para registro, dice "No hay ciclo activo que cubra esta fecha"
                        </div>
                        <p><strong>Causas posibles:</strong></p>
                        <ul>
                            <li>La fecha est√° fuera de los rangos de todos los ciclos</li>
                            <li>El ciclo que cubre esa fecha est√° marcado como inactivo</li>
                        </ul>
                        <p><strong>Soluci√≥n:</strong></p>
                        <ul>
                            <li>Verifica que exista un ciclo cuyas fechas de inicio y fin cubran la fecha que seleccionaste</li>
                            <li>Verifica que ese ciclo est√© activo</li>
                            <li>Si no existe, crea el ciclo correspondiente</li>
                        </ul>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-exclamation-circle me-2"></i>
                            Dice "Lunes no es d√≠a programado en este ciclo"
                        </div>
                        <p><strong>Causa:</strong></p>
                        <p>El d√≠a de la semana de la fecha seleccionada no est√° marcado como d√≠a programado en el ciclo.</p>
                        <p><strong>Soluci√≥n:</strong></p>
                        <ul>
                            <li>Edita el ciclo y agrega ese d√≠a a los d√≠as programados</li>
                            <li>O selecciona otra fecha que s√≠ sea un d√≠a programado</li>
                        </ul>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-exclamation-circle me-2"></i>
                            Dice "No hay veh√≠culos configurados para este d√≠a"
                        </div>
                        <p><strong>Causa:</strong></p>
                        <p>Aunque el d√≠a est√° programado en el ciclo, no hay ninguna configuraci√≥n de veh√≠culos para ese d√≠a.</p>
                        <p><strong>Soluci√≥n:</strong></p>
                        <ul>
                            <li>Ve a Configuraci√≥n de Veh√≠culos</li>
                            <li>Selecciona el ciclo correspondiente</li>
                            <li>Crea una configuraci√≥n para ese d√≠a de la semana</li>
                        </ul>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-exclamation-circle me-2"></i>
                            No me deja guardar el registro porque falta el motivo de cancelaci√≥n
                        </div>
                        <p><strong>Esto es correcto:</strong></p>
                        <p>Si marcas un veh√≠culo como "No realizado", el motivo de cancelaci√≥n es obligatorio. Esto asegura 
                            que siempre haya documentaci√≥n de por qu√© no se realiz√≥ un recorrido programado.</p>
                        <p><strong>Soluci√≥n:</strong></p>
                        <ul>
                            <li>Escribe un motivo claro: "Lluvia fuerte", "Festivo", "Mantenimiento veh√≠culo", etc.</li>
                        </ul>
                    </div>
                </section>

                <!-- SECCI√ìN 6: Buenas pr√°cticas -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-award me-2"></i>
                        Buenas pr√°cticas
                    </h2>

                    <div class="step-card">
                        <h5 class="mb-3">Recomendaciones para una gesti√≥n eficiente:</h5>

                        <div class="tip-box mb-3">
                            <strong>1. Planifica los ciclos con anticipaci√≥n</strong>
                            <p class="mb-0">
                                Crea el ciclo semestral al menos 2 semanas antes de que inicie. Esto te da tiempo para 
                                configurar veh√≠culos y coordinar con el proveedor.
                            </p>
                        </div>

                        <div class="tip-box mb-3">
                            <strong>2. Registra diariamente, no al final del mes</strong>
                            <p class="mb-0">
                                Aunque el sistema permite registrar fechas pasadas, es mejor registrar cada d√≠a en tiempo 
                                real. Esto evita olvidos y asegura precisi√≥n en los datos.
                            </p>
                        </div>

                        <div class="tip-box mb-3">
                            <strong>3. S√© espec√≠fico en los motivos de cancelaci√≥n</strong>
                            <p class="mb-0">
                                En lugar de escribir solo "no se hizo", documenta el motivo real: "Lluvia torrencial 
                                8am-11am", "Festivo: D√≠a de la Independencia", "Mantenimiento correctivo veh√≠culo matr√≠cula ABC123". 
                                Esto ayuda a an√°lisis futuros y justificaciones presupuestales.
                            </p>
                        </div>

                        <div class="tip-box mb-3">
                            <strong>4. Revisa el resumen mensual antes de pagar la factura</strong>
                            <p class="mb-0">
                                Antes de aprobar el pago al proveedor, compara el resumen mensual del sistema con la factura. 
                                El total debe coincidir exactamente (solo recorridos realizados).
                            </p>
                        </div>

                        <div class="tip-box mb-3">
                            <strong>5. No borres configuraciones antiguas, m√°rcalas como inactivas</strong>
                            <p class="mb-0">
                                Si una configuraci√≥n ya no se usa, en lugar de editarla o "sobrescribirla", cr√©ala de nuevo 
                                con "vigente desde" la fecha del cambio. Esto mantiene el hist√≥rico de todas las configuraciones 
                                y sus tarifas congeladas.
                            </p>
                        </div>

                        <div class="tip-box mb-3">
                            <strong>6. Verifica los d√≠as programados del ciclo al inicio del semestre</strong>
                            <p class="mb-0">
                                Antes de crear configuraciones de veh√≠culos, confirma con el √°rea acad√©mica cu√°les ser√°n 
                                realmente los d√≠as con extracurriculares. Cambiar d√≠as programados a mitad de semestre 
                                puede generar confusi√≥n.
                            </p>
                        </div>

                        <div class="tip-box mb-3">
                            <strong>7. Comunica cambios de configuraci√≥n al proveedor</strong>
                            <p class="mb-0">
                                Si a mitad del ciclo cambias la cantidad de veh√≠culos o la capacidad, comun√≠calo formalmente 
                                al proveedor de transporte para que ajuste su operaci√≥n.
                            </p>
                        </div>

                        <div class="tip-box mb-0">
                            <strong>8. Exporta el resumen mensual para tu respaldo</strong>
                            <p class="mb-0">
                                Aunque el sistema mantiene todo el hist√≥rico, es buena pr√°ctica tomar capturas de pantalla 
                                o exportar el resumen mensual para tus archivos financieros. Esto facilita auditor√≠as futuras.
                            </p>
                        </div>
                    </div>
                </section>

                <!-- SECCI√ìN 7: Preguntas frecuentes -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-chat-dots me-2"></i>
                        Preguntas frecuentes
                    </h2>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¬øPuedo tener varios ciclos activos al mismo tiempo?
                        </div>
                        <p>
                            S√≠, pero sus fechas no deber√≠an solaparse. Lo normal es tener un ciclo por semestre 
                            (enero-junio, julio-diciembre). Sin embargo, es posible tener ciclos m√°s cortos o con 
                            fechas espec√≠ficas si la necesidad acad√©mica lo requiere.
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¬øQu√© pasa si cambio el tarifario de extracurriculares?
                        </div>
                        <p>
                            Los cambios en el tarifario NO afectan las configuraciones ya creadas. Cada configuraci√≥n 
                            congela la tarifa al momento de su creaci√≥n. Esto significa:
                        </p>
                        <ul>
                            <li>Las configuraciones existentes mantienen su tarifa original</li>
                            <li>Las nuevas configuraciones usar√°n la tarifa actualizada del tarifario</li>
                            <li>El resumen mensual siempre usa las tarifas congeladas de cada configuraci√≥n</li>
                        </ul>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¬øPuedo editar un registro de un d√≠a ya guardado?
                        </div>
                        <p>
                            S√≠. Selecciona la fecha, el sistema cargar√° los registros existentes, modifica lo que 
                            necesites y guarda de nuevo. Esto sobrescribe el registro anterior.
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¬øPor qu√© se congela la tarifa al configurar un veh√≠culo?
                        </div>
                        <p>
                            El congelamiento de tarifas protege el presupuesto. Si configuras tus veh√≠culos al inicio 
                            del semestre, sabes exactamente cu√°nto costar√° cada recorrido durante todo el semestre, 
                            sin importar que el proveedor despu√©s cambie sus tarifas generales.
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¬øC√≥mo cambio la cantidad de veh√≠culos a mitad de semestre?
                        </div>
                        <p>
                            No edites la configuraci√≥n existente. En su lugar:
                        </p>
                        <ol>
                            <li>Crea una nueva configuraci√≥n para el mismo d√≠a</li>
                            <li>Pon la nueva cantidad de veh√≠culos</li>
                            <li>En "Vigente desde" pon la fecha del cambio</li>
                            <li>Guarda</li>
                        </ol>
                        <p>
                            El sistema autom√°ticamente usar√° la configuraci√≥n antigua para fechas anteriores al cambio, 
                            y la nueva configuraci√≥n para fechas posteriores.
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¬øLos pasajeros registrados afectan el costo?
                        </div>
                        <p>
                            No. El costo se calcula por recorrido realizado, no por pasajero. Si un veh√≠culo de 30 
                            pasajeros viaja con solo 10 estudiantes, el costo sigue siendo la tarifa completa del veh√≠culo. 
                            El registro de pasajeros es para estad√≠stica y control, no para c√°lculo de costos.
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¬øQu√© pasa con los recorridos cancelados?
                        </div>
                        <p>
                            Los recorridos marcados como "No realizado" NO se cobran. El resumen mensual solo suma 
                            los recorridos completados. Los cancelados aparecen en el hist√≥rico con su motivo, pero 
                            no se incluyen en el total a pagar.
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¬øPuedo tener diferentes tipos de veh√≠culos el mismo d√≠a?
                        </div>
                        <p>
                            No directamente en una sola configuraci√≥n. Cada configuraci√≥n define un solo tipo de veh√≠culo 
                            (capacidad) y una cantidad de veh√≠culos de ese tipo. Si necesitas 2 veh√≠culos de 20 pasajeros 
                            y 1 veh√≠culo de 30 pasajeros el mismo d√≠a, tendr√≠as que crear dos configuraciones separadas 
                            para ese d√≠a (aunque t√©cnicamente el sistema permite solo una configuraci√≥n vigente por d√≠a).
                        </p>
                        <p>
                            En la pr√°ctica, la recomendaci√≥n es usar un solo tipo de veh√≠culo por d√≠a para simplificar 
                            la operaci√≥n y el registro.
                        </p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            ¬øC√≥mo manejo festivos o d√≠as sin colegio?
                        </div>
                        <p>
                            Si un d√≠a programado cae en festivo o no hay colegio:
                        </p>
                        <ul>
                            <li>Selecciona esa fecha en el registro diario</li>
                            <li>Marca todos los veh√≠culos como "No realizado"</li>
                            <li>En motivo escribe "Festivo: [nombre del festivo]" o "No hay colegio"</li>
                            <li>Guarda</li>
                        </ul>
                        <p>
                            Esto documenta que el d√≠a estaba programado pero no se realiz√≥ por motivo justificado, 
                            y no se cobrar√° en la liquidaci√≥n.
                        </p>
                    </div>
                </section>

                <!-- TARJETA PARA REPORTAR BUGS -->
                <div class="bug-report-card">
                    <i class="bi bi-bug-fill icon-large"></i>
                    <h4 class="mb-3">¬øEncontraste un problema o tienes una sugerencia?</h4>
                    <p class="mb-4">
                        Si experimentaste un error, algo no funciona como esperas, o tienes 
                        una sugerencia para mejorar el sistema, rep√≥rtalo aqu√≠.
                    </p>
                    <a href="../report-bug.html" class="btn btn-light btn-lg">
                        <i class="bi bi-exclamation-triangle me-2"></i>Reportar Bug o Problema
                    </a>
                </div>

            </div>
        </div>

    </div>

    <!-- BOT√ìN FLOTANTE PARA REPORTAR BUGS -->
    <a href="../report-bug.html" class="btn btn-lg floating-bug-button" title="Reportar Bug">
        <i class="bi bi-bug-fill me-2"></i>Reportar Bug
    </a>

    <!-- SCRIPTS - ORDEN CR√çTICO -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/js/config.js"></script>
    
    <script>
        // ==========================================
        // VARIABLES GLOBALES
        // ==========================================
        let currentUser = null;

        // ==========================================
        // CONFIGURACI√ìN DE LA P√ÅGINA
        // ==========================================
        const PAGE_CONFIG = {
            moduleName: 'Servicios',
            modulePath: 'services',
            pageTitle: 'Transporte Extracurriculares',
            pagePath: 'extracurricular.html',
            moduleDescription: 'Gesti√≥n de transporte para actividades extracurriculares'
        };

        // ==========================================
        // INICIALIZACI√ìN
        // ==========================================
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üìñ Iniciando p√°gina de manual...');
            
            try {
                // Verificar si existe la funci√≥n de colores corporativos
                if (typeof loadAndApplyBrandColors === 'function') {
                    await loadAndApplyBrandColors();
                }
                
                // Verificar sesi√≥n si la funci√≥n existe
                if (typeof getStoredSession === 'function') {
                    const session = getStoredSession();
                    if (session && session.user) {
                        currentUser = session.user;
                    }
                }
                
                // Actualizar informaci√≥n en la p√°gina
                updatePageInfo();
                
                console.log('‚úÖ P√°gina de manual lista');
                
            } catch (error) {
                console.error('‚ùå Error inicializando p√°gina:', error);
                if (typeof showMessage === 'function') {
                    showMessage('Error al cargar la p√°gina: ' + error.message, 'danger');
                }
            }
        });

        // ==========================================
        // ACTUALIZAR INFORMACI√ìN DE LA P√ÅGINA
        // ==========================================
        function updatePageInfo() {
            // Actualizar title
            document.title = `Manual - ${PAGE_CONFIG.moduleName} - ${PAGE_CONFIG.pageTitle} - SchoolNet`;
        }

        // ==========================================
        // UTILIDADES DE LOADING
        // ==========================================
        function showLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.remove('hidden');
            }
        }

        function hideLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.add('hidden');
            }
        }

        // ==========================================
        // FUNCI√ìN DE MENSAJES
        // ==========================================
        function showMessage(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            if (!alertContainer) return;
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertContainer.appendChild(alertDiv);
            
            // Auto-remove despu√©s de 5 segundos
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

    </script>
</body>
</html>
