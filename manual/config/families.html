<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- VERSI√ìN DE LA P√ÅGINA -->
    <meta name="page-version" content="25.12.11.17.00">
    
    <title>Manual - Gestionar Familias - SchoolNet</title>
    
    <!-- Bootstrap CSS - VERSI√ìN FIJA PROBADA -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #1B365D;
            --secondary-color: #667eea;
            --tertiary-color: #f59e0b;
        }

        body {
            background-color: #f8f9fa;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-overlay.hidden {
            display: none;
        }
        
        .loading-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Encabezado del manual */
        .manual-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, #2a4a7a 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }

        .manual-header h1 {
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
        }

        .manual-header .subtitle {
            opacity: 0.9;
            font-size: 1rem;
        }

        /* Contenedor principal del contenido */
        .manual-content {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        /* Secciones del manual */
        .manual-section {
            margin-bottom: 2.5rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #e9ecef;
        }

        .manual-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .manual-section h2 {
            color: var(--primary-color);
            font-size: 1.4rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .manual-section h3 {
            color: #495057;
            font-size: 1.15rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }

        /* Tarjetas de pasos */
        .step-card {
            background: #f8f9fa;
            border-left: 4px solid var(--secondary-color);
            padding: 1rem 1.25rem;
            margin-bottom: 1rem;
            border-radius: 0 8px 8px 0;
        }

        .step-card h4 {
            color: var(--primary-color);
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            background: var(--secondary-color);
            color: white;
            border-radius: 50%;
            font-weight: bold;
            font-size: 0.85rem;
            margin-right: 0.5rem;
        }

        /* Cajas de informaci√≥n */
        .info-box {
            background: #e7f3ff;
            border: 1px solid #b8daff;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .success-box {
            background: #d4edda;
            border: 1px solid #28a745;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .danger-box {
            background: #f8d7da;
            border: 1px solid #dc3545;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        /* Lista de caracter√≠sticas */
        .feature-list {
            list-style: none;
            padding-left: 0;
        }

        .feature-list li {
            padding: 0.5rem 0;
            padding-left: 1.75rem;
            position: relative;
        }

        .feature-list li::before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
        }

        /* Preguntas frecuentes */
        .faq-item {
            margin-bottom: 1rem;
        }

        .faq-question {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.25rem;
        }

        .faq-answer {
            color: #495057;
            padding-left: 1rem;
            border-left: 2px solid #dee2e6;
        }

        /* ================================================
           SECCI√ìN DE REPORTAR BUGS - ALTO CONTRASTE
           ================================================ */
        .bug-report-card {
            background: #1a1a2e;
            color: #ffffff;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            text-align: center;
        }

        .bug-report-card h4 {
            color: #ffffff;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .bug-report-card p {
            color: #e0e0e0;
            margin-bottom: 1.5rem;
        }

        .bug-report-card .btn-report {
            background: #ff6b6b;
            border: none;
            color: #ffffff;
            font-weight: 600;
            padding: 0.75rem 2rem;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .bug-report-card .btn-report:hover {
            background: #ee5a5a;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
            color: #ffffff;
        }

        /* Bot√≥n flotante de reportar bugs - ALTO CONTRASTE */
        .floating-bug-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            background: #dc2626 !important;
            border: 2px solid #ffffff !important;
            color: #ffffff !important;
            font-weight: 600;
            padding: 0.75rem 1.25rem;
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.5);
            transition: all 0.3s ease;
        }

        .floating-bug-button:hover {
            background: #b91c1c !important;
            color: #ffffff !important;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(220, 38, 38, 0.6);
        }

        /* Tabla de campos */
        .fields-table {
            width: 100%;
            margin: 1rem 0;
        }

        .fields-table th {
            background: var(--primary-color);
            color: white;
            padding: 0.75rem;
            text-align: left;
        }

        .fields-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #dee2e6;
            vertical-align: top;
        }

        .fields-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .required-badge {
            background: #dc3545;
            color: white;
            font-size: 0.7rem;
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            margin-left: 0.5rem;
        }

        .optional-badge {
            background: #6c757d;
            color: white;
            font-size: 0.7rem;
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            margin-left: 0.5rem;
        }

        .readonly-badge {
            background: #17a2b8;
            color: white;
            font-size: 0.7rem;
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            margin-left: 0.5rem;
        }

        /* √çndice de contenido */
        .toc-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1.25rem;
            margin-bottom: 2rem;
        }

        .toc-card h5 {
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .toc-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .toc-list li {
            padding: 0.35rem 0;
        }

        .toc-list a {
            color: #495057;
            text-decoration: none;
            transition: color 0.2s;
        }

        .toc-list a:hover {
            color: var(--secondary-color);
        }

        /* Iconos de acci√≥n */
        .action-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 4px;
            margin-right: 0.25rem;
        }

        .action-icon.edit {
            background: #e7f3ff;
            color: #0d6efd;
        }

        .action-icon.toggle {
            background: #fff3cd;
            color: #ffc107;
        }

        /* Ejemplo visual de tabla */
        .table-example {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .table-example table {
            width: 100%;
            margin: 0;
            font-size: 0.9rem;
        }

        .table-example th {
            background: #f8f9fa;
            padding: 0.75rem;
            border-bottom: 1px solid #dee2e6;
            font-weight: 600;
        }

        .table-example td {
            padding: 0.75rem;
            border-bottom: 1px solid #dee2e6;
        }

        .table-example tr:last-child td {
            border-bottom: none;
        }

        /* Badge de estudiantes */
        .student-count-badge {
            background: #0d6efd;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.85rem;
        }

        /* Status badges */
        .status-active {
            background: #198754;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .status-inactive {
            background: #6c757d;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        /* Diagrama de relaci√≥n */
        .relation-diagram {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            text-align: center;
        }

        .relation-box {
            display: inline-block;
            padding: 0.75rem 1.25rem;
            border-radius: 8px;
            font-weight: 500;
            margin: 0.25rem;
        }

        .relation-box.family {
            background: #e8f5e9;
            color: #2e7d32;
            border: 2px solid #2e7d32;
        }

        .relation-box.student {
            background: #e3f2fd;
            color: #1565c0;
        }

        .relation-arrow {
            color: #6c757d;
            margin: 0 0.5rem;
            font-size: 1.25rem;
        }
    </style>
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="mb-0">Cargando...</p>
        </div>
    </div>

    <!-- ENCABEZADO DEL MANUAL -->
    <div class="manual-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1>
                        <i class="bi bi-book me-2"></i>
                        Manual: Gestionar Familias
                    </h1>
                    <p class="subtitle mb-0">
                        <i class="bi bi-house-heart me-1"></i>
                        Gu√≠a completa para administrar las familias del colegio
                    </p>
                </div>
                <div class="col-md-4 text-md-end mt-3 mt-md-0">
                    <a href="../../modules/config/families.html" class="btn btn-outline-light">
                        <i class="bi bi-arrow-left me-1"></i>Volver al M√≥dulo
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="container">

        <!-- CONTENEDOR DE ALERTAS -->
        <div id="alertContainer"></div>

        <div class="row">
            <div class="col-lg-10 mx-auto">

                <!-- √çNDICE DE CONTENIDO -->
                <div class="toc-card">
                    <h5><i class="bi bi-list-ul me-2"></i>Contenido de este manual</h5>
                    <ul class="toc-list">
                        <li><a href="#que-es"><i class="bi bi-arrow-right me-2"></i>¬øQu√© son las Familias?</a></li>
                        <li><a href="#antes-comenzar"><i class="bi bi-arrow-right me-2"></i>Antes de comenzar</a></li>
                        <li><a href="#pantalla-principal"><i class="bi bi-arrow-right me-2"></i>Conociendo la pantalla</a></li>
                        <li><a href="#crear-familia"><i class="bi bi-arrow-right me-2"></i>Crear una nueva familia</a></li>
                        <li><a href="#editar-familia"><i class="bi bi-arrow-right me-2"></i>Editar una familia</a></li>
                        <li><a href="#cambiar-estado"><i class="bi bi-arrow-right me-2"></i>Activar o inactivar una familia</a></li>
                        <li><a href="#campos-formulario"><i class="bi bi-arrow-right me-2"></i>Descripci√≥n de los campos</a></li>
                        <li><a href="#problemas-comunes"><i class="bi bi-arrow-right me-2"></i>Soluci√≥n de problemas</a></li>
                        <li><a href="#preguntas-frecuentes"><i class="bi bi-arrow-right me-2"></i>Preguntas frecuentes</a></li>
                    </ul>
                </div>

                <!-- CONTENIDO PRINCIPAL -->
                <div class="manual-content">

                    <!-- ¬øQU√â ES? -->
                    <section class="manual-section" id="que-es">
                        <h2><i class="bi bi-info-circle"></i> ¬øQu√© son las Familias?</h2>
                        
                        <p>
                            Las <strong>Familias</strong> son grupos que permiten asociar estudiantes que pertenecen 
                            a un mismo n√∫cleo familiar. Cada familia tiene un c√≥digo √∫nico que se usa para vincular 
                            hermanos y facilitar la gesti√≥n administrativa, especialmente en temas de facturaci√≥n, 
                            comunicaciones y descuentos por hermanos.
                        </p>

                        <h3>Relaci√≥n con estudiantes</h3>
                        <div class="relation-diagram">
                            <span class="relation-box family">Familia</span>
                            <span class="relation-arrow">‚Üí</span>
                            <span class="relation-box student">Estudiante 1</span>
                            <span class="relation-box student">Estudiante 2</span>
                            <span class="relation-box student">Estudiante 3</span>
                        </div>
                        <p class="text-center text-muted">
                            <small>Una familia puede tener m√∫ltiples estudiantes asociados (hermanos)</small>
                        </p>

                        <h3>¬øPara qu√© sirven las familias?</h3>
                        <ul class="feature-list">
                            <li>Agrupar hermanos que estudian en la instituci√≥n</li>
                            <li>Facilitar la facturaci√≥n consolidada por familia</li>
                            <li>Aplicar descuentos por hermanos autom√°ticamente</li>
                            <li>Enviar comunicaciones a toda la familia de una vez</li>
                            <li>Generar reportes de ingresos por familia</li>
                            <li>Gestionar el historial familiar de la instituci√≥n</li>
                        </ul>

                        <h3>Ejemplo visual de la tabla de familias</h3>
                        <div class="table-example">
                            <table>
                                <thead>
                                    <tr>
                                        <th>C√≥digo</th>
                                        <th>Nombre de Familia</th>
                                        <th style="text-align: center;">Estudiantes</th>
                                        <th style="text-align: center;">Estado</th>
                                        <th style="text-align: center;">Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>1001</strong></td>
                                        <td>Familia L√≥pez Garc√≠a</td>
                                        <td style="text-align: center;"><span class="student-count-badge">3</span></td>
                                        <td style="text-align: center;"><span class="status-active">Activa</span></td>
                                        <td style="text-align: center;">
                                            <span class="action-icon edit"><i class="bi bi-pencil"></i></span>
                                            <span class="action-icon toggle"><i class="bi bi-toggle-on"></i></span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>1002</strong></td>
                                        <td>Familia Rodr√≠guez P√©rez</td>
                                        <td style="text-align: center;"><span class="student-count-badge">2</span></td>
                                        <td style="text-align: center;"><span class="status-active">Activa</span></td>
                                        <td style="text-align: center;">
                                            <span class="action-icon edit"><i class="bi bi-pencil"></i></span>
                                            <span class="action-icon toggle"><i class="bi bi-toggle-on"></i></span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>1003</strong></td>
                                        <td><em class="text-muted">Sin nombre</em></td>
                                        <td style="text-align: center;"><span class="student-count-badge">0</span></td>
                                        <td style="text-align: center;"><span class="status-inactive">Inactiva</span></td>
                                        <td style="text-align: center;">
                                            <span class="action-icon edit"><i class="bi bi-pencil"></i></span>
                                            <span class="action-icon toggle"><i class="bi bi-toggle-off"></i></span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </section>

                    <!-- ANTES DE COMENZAR -->
                    <section class="manual-section" id="antes-comenzar">
                        <h2><i class="bi bi-exclamation-triangle"></i> Antes de comenzar</h2>

                        <div class="warning-box">
                            <strong><i class="bi bi-shield-lock me-2"></i>Acceso restringido</strong><br>
                            Esta p√°gina solo est√° disponible para usuarios con permisos de administraci√≥n. 
                            Si no puedes acceder, contacta al administrador del sistema.
                        </div>

                        <h3>Informaci√≥n importante</h3>
                        <ul>
                            <li>
                                <strong>El c√≥digo de familia es permanente:</strong> Una vez creada la familia, 
                                el c√≥digo no se puede modificar. Elige cuidadosamente el n√∫mero.
                            </li>
                            <li>
                                <strong>El c√≥digo debe ser √∫nico:</strong> No puede haber dos familias con el mismo c√≥digo.
                            </li>
                            <li>
                                <strong>El nombre es opcional:</strong> Puedes crear una familia solo con el c√≥digo 
                                y agregar el nombre despu√©s.
                            </li>
                        </ul>

                        <h3>Convenci√≥n de c√≥digos</h3>
                        <p>
                            Aunque puedes usar cualquier n√∫mero, se recomienda seguir una convenci√≥n. 
                            Algunos ejemplos comunes:
                        </p>
                        <ul>
                            <li><strong>Secuencial simple:</strong> 1, 2, 3, 4...</li>
                            <li><strong>Con prefijo de a√±o:</strong> 2401, 2402, 2403... (familias del 2024)</li>
                            <li><strong>Por rango:</strong> 1000-1999 (familias antiguas), 2000-2999 (familias nuevas)</li>
                        </ul>

                        <div class="info-box">
                            <strong><i class="bi bi-lightbulb me-2"></i>Consejo:</strong>
                            Define una convenci√≥n de c√≥digos antes de empezar a crear familias. 
                            Esto facilitar√° la organizaci√≥n a largo plazo.
                        </div>
                    </section>

                    <!-- PANTALLA PRINCIPAL -->
                    <section class="manual-section" id="pantalla-principal">
                        <h2><i class="bi bi-display"></i> Conociendo la pantalla</h2>

                        <p>La pantalla de Gestionar Familias tiene las siguientes secciones:</p>

                        <h3>Encabezado</h3>
                        <p>
                            En la parte superior encontrar√°s el t√≠tulo de la p√°gina y el bot√≥n 
                            <strong>"Nueva Familia"</strong> para crear una familia.
                        </p>

                        <h3>Barra de b√∫squeda y filtros</h3>
                        <p>Debajo del encabezado hay opciones para filtrar:</p>
                        <ul>
                            <li><strong>Campo de b√∫squeda:</strong> Busca por c√≥digo o nombre de familia.</li>
                            <li><strong>Filtro de estado:</strong> Muestra todas, solo activas o solo inactivas.</li>
                            <li><strong>Bot√≥n "Limpiar Filtros":</strong> Quita todos los filtros aplicados.</li>
                        </ul>

                        <h3>Tabla de familias</h3>
                        <p>
                            Las familias se muestran en una tabla con las siguientes columnas:
                        </p>
                        <ul>
                            <li><strong>C√≥digo:</strong> El n√∫mero √∫nico de identificaci√≥n de la familia.</li>
                            <li><strong>Nombre de Familia:</strong> El nombre o apellido de la familia (si lo tiene).</li>
                            <li><strong>Estudiantes:</strong> Cantidad de estudiantes asociados a la familia.</li>
                            <li><strong>Estado:</strong> Si la familia est√° activa o inactiva.</li>
                            <li><strong>Acciones:</strong> Botones para editar y cambiar estado.</li>
                        </ul>

                        <h3>Estado vac√≠o</h3>
                        <p>
                            Si no hay familias registradas o ninguna coincide con los filtros, 
                            aparecer√° un mensaje indic√°ndolo y un bot√≥n para crear la primera familia.
                        </p>
                    </section>

                    <!-- CREAR FAMILIA -->
                    <section class="manual-section" id="crear-familia">
                        <h2><i class="bi bi-plus-circle"></i> Crear una nueva familia</h2>

                        <div class="step-card">
                            <h4><span class="step-number">1</span>Abrir el formulario</h4>
                            <p>
                                Haz clic en el bot√≥n <strong>"Nueva Familia"</strong> en la parte superior derecha. 
                                Se abrir√° una ventana con el formulario de creaci√≥n.
                            </p>
                        </div>

                        <div class="step-card">
                            <h4><span class="step-number">2</span>Ingresar el c√≥digo de familia</h4>
                            <p>
                                Escribe un n√∫mero √∫nico para identificar la familia. Este n√∫mero debe ser 
                                positivo y no puede estar ya en uso por otra familia.
                            </p>
                        </div>

                        <div class="step-card">
                            <h4><span class="step-number">3</span>Ingresar el nombre (opcional)</h4>
                            <p>
                                Opcionalmente, escribe un nombre para identificar la familia m√°s f√°cilmente. 
                                Generalmente se usa el apellido de la familia. Por ejemplo: "Familia L√≥pez Garc√≠a".
                            </p>
                        </div>

                        <div class="step-card">
                            <h4><span class="step-number">4</span>Guardar</h4>
                            <p>
                                Haz clic en <strong>"Guardar"</strong>. El sistema validar√° que el c√≥digo 
                                no exista y crear√° la familia con estado "Activa".
                            </p>
                        </div>

                        <div class="success-box">
                            <strong><i class="bi bi-check-circle me-2"></i>¬°Listo!</strong><br>
                            La nueva familia aparecer√° en la tabla y podr√°s asociar estudiantes a ella.
                        </div>

                        <div class="warning-box">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Importante:</strong>
                            El c√≥digo de familia no se puede cambiar despu√©s de crear la familia. 
                            Aseg√∫rate de que el n√∫mero sea correcto antes de guardar.
                        </div>
                    </section>

                    <!-- EDITAR FAMILIA -->
                    <section class="manual-section" id="editar-familia">
                        <h2><i class="bi bi-pencil"></i> Editar una familia</h2>

                        <div class="step-card">
                            <h4><span class="step-number">1</span>Localizar la familia</h4>
                            <p>
                                Busca la familia que deseas modificar en la tabla. Puedes usar el campo de 
                                b√∫squeda para encontrarla por c√≥digo o nombre.
                            </p>
                        </div>

                        <div class="step-card">
                            <h4><span class="step-number">2</span>Abrir el editor</h4>
                            <p>
                                Haz clic en el bot√≥n con el √≠cono de l√°piz 
                                <span class="action-icon edit"><i class="bi bi-pencil"></i></span> 
                                en la columna de acciones.
                            </p>
                        </div>

                        <div class="step-card">
                            <h4><span class="step-number">3</span>Modificar los datos</h4>
                            <p>
                                En el modo de edici√≥n puedes cambiar:
                            </p>
                            <ul>
                                <li><strong>Nombre de familia:</strong> Agregar, cambiar o quitar el nombre.</li>
                                <li><strong>Estado:</strong> Cambiar entre Activa e Inactiva.</li>
                            </ul>
                            <p>
                                <strong>Nota:</strong> El c√≥digo de familia aparece deshabilitado porque no se puede modificar.
                            </p>
                        </div>

                        <div class="step-card">
                            <h4><span class="step-number">4</span>Guardar cambios</h4>
                            <p>
                                Haz clic en <strong>"Actualizar"</strong> para guardar las modificaciones.
                            </p>
                        </div>

                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>Informaci√≥n adicional en modo edici√≥n:</strong><br>
                            Al editar, ver√°s el campo "N√∫mero de Estudiantes" que muestra cu√°ntos estudiantes 
                            est√°n asociados a esta familia. Este campo es de solo lectura y se calcula autom√°ticamente.
                        </div>
                    </section>

                    <!-- CAMBIAR ESTADO -->
                    <section class="manual-section" id="cambiar-estado">
                        <h2><i class="bi bi-toggle-on"></i> Activar o inactivar una familia</h2>

                        <p>
                            Puedes cambiar el estado de una familia de dos formas: desde el formulario de 
                            edici√≥n o usando el bot√≥n de acci√≥n r√°pida en la tabla.
                        </p>

                        <h3>Desde la tabla (m√©todo r√°pido)</h3>
                        <div class="step-card">
                            <h4><span class="step-number">1</span>Localizar la familia</h4>
                            <p>Busca la familia en la tabla.</p>
                        </div>

                        <div class="step-card">
                            <h4><span class="step-number">2</span>Hacer clic en el bot√≥n de estado</h4>
                            <p>
                                Haz clic en el bot√≥n con el √≠cono de interruptor 
                                <span class="action-icon toggle"><i class="bi bi-toggle-on"></i></span>. 
                                El √≠cono ser√° diferente seg√∫n el estado actual:
                            </p>
                            <ul>
                                <li><i class="bi bi-toggle-on text-warning"></i> Si est√° activa (para inactivar)</li>
                                <li><i class="bi bi-toggle-off text-success"></i> Si est√° inactiva (para activar)</li>
                            </ul>
                        </div>

                        <div class="step-card">
                            <h4><span class="step-number">3</span>Confirmar la acci√≥n</h4>
                            <p>
                                Aparecer√° un cuadro de confirmaci√≥n. Haz clic en "Aceptar" para confirmar 
                                o "Cancelar" para abortar.
                            </p>
                        </div>

                        <div class="danger-box">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Restricci√≥n importante:</strong><br>
                            No puedes inactivar una familia que tiene estudiantes activos. Primero debes 
                            cambiar el estado de los estudiantes o moverlos a otra familia.
                        </div>
                    </section>

                    <!-- CAMPOS DEL FORMULARIO -->
                    <section class="manual-section" id="campos-formulario">
                        <h2><i class="bi bi-input-cursor-text"></i> Descripci√≥n de los campos</h2>

                        <table class="fields-table">
                            <thead>
                                <tr>
                                    <th style="width: 30%">Campo</th>
                                    <th>Descripci√≥n</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>C√≥digo de Familia <span class="required-badge">Obligatorio</span></td>
                                    <td>
                                        N√∫mero √∫nico para identificar la familia. Debe ser un n√∫mero positivo. 
                                        <strong>No se puede modificar</strong> despu√©s de crear la familia.
                                    </td>
                                </tr>
                                <tr>
                                    <td>Nombre de Familia <span class="optional-badge">Opcional</span></td>
                                    <td>
                                        Nombre o apellido para identificar la familia. M√°ximo 100 caracteres. 
                                        Ejemplo: "Familia L√≥pez Garc√≠a". Se puede agregar o modificar en cualquier momento.
                                    </td>
                                </tr>
                                <tr>
                                    <td>Estado <span class="readonly-badge">Solo en edici√≥n</span></td>
                                    <td>
                                        Define si la familia est√° activa o inactiva. Las familias inactivas 
                                        no aparecen en los selectores de otros m√≥dulos. Solo visible al editar.
                                    </td>
                                </tr>
                                <tr>
                                    <td>N√∫mero de Estudiantes <span class="readonly-badge">Solo lectura</span></td>
                                    <td>
                                        Muestra la cantidad de estudiantes asociados a la familia. 
                                        Este valor se calcula autom√°ticamente y no se puede editar.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </section>

                    <!-- SOLUCI√ìN DE PROBLEMAS -->
                    <section class="manual-section" id="problemas-comunes">
                        <h2><i class="bi bi-wrench"></i> Soluci√≥n de problemas</h2>

                        <div class="faq-item">
                            <p class="faq-question">Error: "El c√≥digo de familia ya existe"</p>
                            <p class="faq-answer">
                                El c√≥digo que intentas usar ya est√° asignado a otra familia. Usa la b√∫squeda 
                                para verificar qu√© c√≥digos est√°n en uso y elige un n√∫mero diferente.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">No puedo cambiar el c√≥digo de familia</p>
                            <p class="faq-answer">
                                El c√≥digo de familia no se puede modificar despu√©s de la creaci√≥n. Si necesitas 
                                cambiar el c√≥digo, deber√°s crear una nueva familia con el c√≥digo correcto y 
                                reasignar los estudiantes.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">No puedo inactivar la familia</p>
                            <p class="faq-answer">
                                Las familias con estudiantes activos no se pueden inactivar. Primero debes 
                                cambiar el estado de los estudiantes (graduarlos, retirarlos) o moverlos a otra familia.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">El contador de estudiantes no se actualiza</p>
                            <p class="faq-answer">
                                El contador se actualiza cuando recargas la p√°gina. Si acabas de asociar o 
                                desasociar estudiantes, haz clic en "Actualizar" o recarga la p√°gina para ver 
                                el conteo actualizado.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">No encuentro la familia que busco</p>
                            <p class="faq-answer">
                                Verifica que no tengas un filtro de estado aplicado. Si buscas una familia 
                                inactiva y tienes el filtro en "Activas", no aparecer√°. Haz clic en 
                                "Limpiar Filtros" para ver todas.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">El nombre aparece como "Sin nombre"</p>
                            <p class="faq-answer">
                                Esto significa que la familia fue creada sin nombre (el campo es opcional). 
                                Puedes editar la familia y agregar un nombre en cualquier momento.
                            </p>
                        </div>
                    </section>

                    <!-- PREGUNTAS FRECUENTES -->
                    <section class="manual-section" id="preguntas-frecuentes">
                        <h2><i class="bi bi-chat-left-quote"></i> Preguntas frecuentes</h2>

                        <div class="faq-item">
                            <p class="faq-question">¬øCu√°ntas familias puedo crear?</p>
                            <p class="faq-answer">
                                No hay l√≠mite en la cantidad de familias. Puedes crear tantas como 
                                necesites para tu instituci√≥n.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">¬øPuedo eliminar una familia?</p>
                            <p class="faq-answer">
                                No, las familias no se pueden eliminar para proteger la integridad de los datos. 
                                En su lugar, puedes inactivarlas. Las familias inactivas se mantienen en el sistema 
                                para fines hist√≥ricos.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">¬øQu√© pasa con los estudiantes si inactivo una familia?</p>
                            <p class="faq-answer">
                                No puedes inactivar una familia que tiene estudiantes activos. Si la familia 
                                tiene solo estudiantes inactivos (retirados, graduados), estos mantienen su 
                                relaci√≥n hist√≥rica con la familia.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">¬øEs obligatorio asignar un nombre a la familia?</p>
                            <p class="faq-answer">
                                No, el nombre es opcional. Sin embargo, se recomienda asignar un nombre 
                                (generalmente el apellido de la familia) para facilitar la identificaci√≥n.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">¬øC√≥mo asocio estudiantes a una familia?</p>
                            <p class="faq-answer">
                                La asociaci√≥n de estudiantes a familias se hace desde el m√≥dulo de gesti√≥n 
                                de estudiantes, no desde esta p√°gina. Aqu√≠ solo administras las familias.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">¬øPor qu√© no puedo cambiar el c√≥digo de familia?</p>
                            <p class="faq-answer">
                                El c√≥digo de familia se usa como referencia en m√∫ltiples partes del sistema 
                                (facturaci√≥n, historial, reportes). Cambiarlo podr√≠a generar inconsistencias, 
                                por lo que se bloquea despu√©s de la creaci√≥n.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">¬øPuedo tener familias sin estudiantes?</p>
                            <p class="faq-answer">
                                S√≠, puedes crear familias antes de asociar estudiantes. Esto es √∫til cuando 
                                est√°s preparando la matr√≠cula de nuevos estudiantes que a√∫n no est√°n registrados.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">¬øQu√© convenci√≥n de c√≥digos debo usar?</p>
                            <p class="faq-answer">
                                No hay una regla obligatoria. Puedes usar n√∫meros secuenciales (1, 2, 3...), 
                                rangos por a√±o (2401, 2402...) o cualquier sistema que funcione para tu instituci√≥n. 
                                Lo importante es ser consistente.
                            </p>
                        </div>
                    </section>

                </div>

                <!-- TARJETA PARA REPORTAR BUGS - ALTO CONTRASTE -->
                <div class="bug-report-card">
                    <i class="bi bi-bug-fill" style="font-size: 2.5rem; margin-bottom: 0.5rem; display: block;"></i>
                    <h4>¬øEncontraste un problema o tienes una sugerencia?</h4>
                    <p>
                        Si algo no funciona como esperas, experimentaste un error, o tienes ideas 
                        para mejorar esta funcionalidad, cu√©ntanos. Tu retroalimentaci√≥n es muy valiosa.
                    </p>
                    <a href="../report-bug.html" class="btn btn-report">
                        <i class="bi bi-exclamation-triangle me-2"></i>Reportar Bug o Problema
                    </a>
                </div>

            </div>
        </div>

    </div>

    <!-- BOT√ìN FLOTANTE PARA REPORTAR BUGS -->
    <a href="../report-bug.html" class="btn floating-bug-button" title="Reportar Bug">
        <i class="bi bi-bug-fill me-2"></i>Reportar Bug
    </a>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/js/config.js"></script>
    
    <script>
        // ==========================================
        // VARIABLES GLOBALES
        // ==========================================
        let currentUser = null;

        // ==========================================
        // CONFIGURACI√ìN DE LA P√ÅGINA
        // ==========================================
        const PAGE_CONFIG = {
            moduleName: 'Configuraci√≥n',
            modulePath: 'config',
            pageTitle: 'Gestionar Familias',
            pagePath: 'families.html',
            moduleDescription: 'Administraci√≥n de familias del colegio'
        };

        // ==========================================
        // INICIALIZACI√ìN
        // ==========================================
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üìñ Iniciando p√°gina de manual...');
            
            try {
                // Verificar si existe la funci√≥n de colores corporativos
                if (typeof loadAndApplyBrandColors === 'function') {
                    await loadAndApplyBrandColors();
                }
                
                // Verificar sesi√≥n si la funci√≥n existe
                if (typeof getStoredSession === 'function') {
                    const session = getStoredSession();
                    if (session && session.user) {
                        currentUser = session.user;
                    }
                }
                
                // Actualizar informaci√≥n en la p√°gina
                updatePageInfo();
                
                console.log('‚úÖ P√°gina de manual lista');
                
            } catch (error) {
                console.error('‚ùå Error inicializando p√°gina:', error);
            }
        });

        // ==========================================
        // ACTUALIZAR INFORMACI√ìN DE LA P√ÅGINA
        // ==========================================
        function updatePageInfo() {
            document.title = `Manual - ${PAGE_CONFIG.moduleName} - ${PAGE_CONFIG.pageTitle} - SchoolNet`;
        }

        // ==========================================
        // UTILIDADES DE LOADING
        // ==========================================
        function showLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.remove('hidden');
            }
        }

        function hideLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.add('hidden');
            }
        }

        // ==========================================
        // FUNCI√ìN DE MENSAJES
        // ==========================================
        function showMessage(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            if (!alertContainer) return;
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertContainer.appendChild(alertDiv);
            
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }
    </script>
</body>
</html>
