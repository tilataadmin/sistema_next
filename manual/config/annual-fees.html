<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- VERSI√ìN DE LA P√ÅGINA -->
    <meta name="page-version" content="25.12.11.19.00">
    
    <title>Manual - Tarifas Anuales - SchoolNet</title>
    
    <!-- Bootstrap CSS - VERSI√ìN FIJA PROBADA -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #1B365D;
            --secondary-color: #667eea;
            --tertiary-color: #f59e0b;
            --module-primary: #6f42c1;
        }

        body {
            background-color: #f8f9fa;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-overlay.hidden {
            display: none;
        }
        
        .loading-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Encabezado del manual */
        .manual-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, #2a4a7a 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }

        .manual-header h1 {
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
        }

        .manual-header .subtitle {
            opacity: 0.9;
            font-size: 1rem;
        }

        /* Contenedor principal del contenido */
        .manual-content {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        /* Secciones del manual */
        .manual-section {
            margin-bottom: 2.5rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #e9ecef;
        }

        .manual-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .manual-section h2 {
            color: var(--primary-color);
            font-size: 1.4rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .manual-section h3 {
            color: #495057;
            font-size: 1.15rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }

        /* Tarjetas de pasos */
        .step-card {
            background: #f8f9fa;
            border-left: 4px solid var(--secondary-color);
            padding: 1rem 1.25rem;
            margin-bottom: 1rem;
            border-radius: 0 8px 8px 0;
        }

        .step-card h4 {
            color: var(--primary-color);
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            background: var(--secondary-color);
            color: white;
            border-radius: 50%;
            font-weight: bold;
            font-size: 0.85rem;
            margin-right: 0.5rem;
        }

        /* Cajas de informaci√≥n */
        .info-box {
            background: #e7f3ff;
            border: 1px solid #b8daff;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .success-box {
            background: #d4edda;
            border: 1px solid #28a745;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .danger-box {
            background: #f8d7da;
            border: 1px solid #dc3545;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        /* Lista de caracter√≠sticas */
        .feature-list {
            list-style: none;
            padding-left: 0;
        }

        .feature-list li {
            padding: 0.5rem 0;
            padding-left: 1.75rem;
            position: relative;
        }

        .feature-list li::before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
        }

        /* Preguntas frecuentes */
        .faq-item {
            margin-bottom: 1rem;
        }

        .faq-question {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.25rem;
        }

        .faq-answer {
            color: #495057;
            padding-left: 1rem;
            border-left: 2px solid #dee2e6;
        }

        /* ================================================
           SECCI√ìN DE REPORTAR BUGS - ALTO CONTRASTE
           ================================================ */
        .bug-report-card {
            background: #1a1a2e;
            color: #ffffff;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            text-align: center;
        }

        .bug-report-card h4 {
            color: #ffffff;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .bug-report-card p {
            color: #e0e0e0;
            margin-bottom: 1.5rem;
        }

        .bug-report-card .btn-report {
            background: #ff6b6b;
            border: none;
            color: #ffffff;
            font-weight: 600;
            padding: 0.75rem 2rem;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .bug-report-card .btn-report:hover {
            background: #ee5a5a;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
            color: #ffffff;
        }

        /* Bot√≥n flotante de reportar bugs - ALTO CONTRASTE */
        .floating-bug-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            background: #dc2626 !important;
            border: 2px solid #ffffff !important;
            color: #ffffff !important;
            font-weight: 600;
            padding: 0.75rem 1.25rem;
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.5);
            transition: all 0.3s ease;
        }

        .floating-bug-button:hover {
            background: #b91c1c !important;
            color: #ffffff !important;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(220, 38, 38, 0.6);
        }

        /* Tabla de campos */
        .fields-table {
            width: 100%;
            margin: 1rem 0;
        }

        .fields-table th {
            background: var(--primary-color);
            color: white;
            padding: 0.75rem;
            text-align: left;
        }

        .fields-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #dee2e6;
            vertical-align: top;
        }

        .fields-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .required-badge {
            background: #dc3545;
            color: white;
            font-size: 0.7rem;
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            margin-left: 0.5rem;
        }

        .optional-badge {
            background: #6c757d;
            color: white;
            font-size: 0.7rem;
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            margin-left: 0.5rem;
        }

        .calculated-badge {
            background: #17a2b8;
            color: white;
            font-size: 0.7rem;
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            margin-left: 0.5rem;
        }

        /* √çndice de contenido */
        .toc-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1.25rem;
            margin-bottom: 2rem;
        }

        .toc-card h5 {
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .toc-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .toc-list li {
            padding: 0.35rem 0;
        }

        .toc-list a {
            color: #495057;
            text-decoration: none;
            transition: color 0.2s;
        }

        .toc-list a:hover {
            color: var(--secondary-color);
        }

        /* Ejemplo visual de tabla */
        .table-example {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .table-example table {
            width: 100%;
            margin: 0;
            font-size: 0.8rem;
        }

        .table-example th {
            background: var(--module-primary);
            color: white;
            padding: 0.5rem;
            font-weight: 500;
        }

        .table-example td {
            padding: 0.5rem;
            border-bottom: 1px solid #dee2e6;
        }

        .table-example tr:last-child td {
            border-bottom: none;
        }

        .table-example tr:hover {
            background: #f8f5ff;
        }

        /* Campo calculado visual */
        .calculated-field-example {
            background: #e9ecef;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.85rem;
        }

        .editable-field-example {
            background: white;
            border: 1px solid #ced4da;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.85rem;
        }

        /* F√≥rmula destacada */
        .formula-box {
            background: linear-gradient(135deg, #f8f5ff, #e8e0ff);
            border: 2px solid var(--module-primary);
            border-radius: 8px;
            padding: 1.25rem;
            margin: 1rem 0;
            text-align: center;
        }

        .formula-box h4 {
            color: var(--module-primary);
            margin-bottom: 1rem;
        }

        .formula {
            font-family: monospace;
            font-size: 1.1rem;
            background: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            display: inline-block;
            margin: 0.5rem 0;
        }

        /* Bot√≥n de guardar ejemplo */
        .btn-save-example {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.75rem;
            background: #0d6efd;
            color: white;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        /* Selector de a√±o ejemplo */
        .year-selector-example {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .year-selector-example select {
            padding: 0.375rem 0.75rem;
            border: 1px solid #ced4da;
            border-radius: 4px;
            min-width: 200px;
        }

        /* Alerta de info */
        .alert-info-custom {
            background-color: #e7f3ff;
            border-left: 4px solid #0d6efd;
            padding: 0.75rem 1rem;
            border-radius: 0 8px 8px 0;
            margin: 1rem 0;
        }

        /* Formato de moneda */
        .currency-example {
            font-family: monospace;
            color: var(--module-primary);
            font-weight: 600;
        }
    </style>
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="mb-0">Cargando...</p>
        </div>
    </div>

    <!-- ENCABEZADO DEL MANUAL -->
    <div class="manual-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1>
                        <i class="bi bi-book me-2"></i>
                        Manual: Tarifas Anuales
                    </h1>
                    <p class="subtitle mb-0">
                        <i class="bi bi-currency-dollar me-1"></i>
                        Gu√≠a completa para gestionar las tarifas anuales por grado
                    </p>
                </div>
                <div class="col-md-4 text-md-end mt-3 mt-md-0">
                    <a href="../../modules/config/annual-fees.html" class="btn btn-outline-light">
                        <i class="bi bi-arrow-left me-1"></i>Volver al M√≥dulo
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="container">

        <!-- CONTENEDOR DE ALERTAS -->
        <div id="alertContainer"></div>

        <div class="row">
            <div class="col-lg-10 mx-auto">

                <!-- √çNDICE DE CONTENIDO -->
                <div class="toc-card">
                    <h5><i class="bi bi-list-ul me-2"></i>Contenido de este manual</h5>
                    <ul class="toc-list">
                        <li><a href="#que-es"><i class="bi bi-arrow-right me-2"></i>¬øQu√© son las Tarifas Anuales?</a></li>
                        <li><a href="#antes-comenzar"><i class="bi bi-arrow-right me-2"></i>Antes de comenzar</a></li>
                        <li><a href="#pantalla-principal"><i class="bi bi-arrow-right me-2"></i>Conociendo la pantalla</a></li>
                        <li><a href="#formulas-calculo"><i class="bi bi-arrow-right me-2"></i>F√≥rmulas de c√°lculo</a></li>
                        <li><a href="#configurar-tarifas"><i class="bi bi-arrow-right me-2"></i>Configurar tarifas de un grado</a></li>
                        <li><a href="#campos-formulario"><i class="bi bi-arrow-right me-2"></i>Descripci√≥n de los campos</a></li>
                        <li><a href="#problemas-comunes"><i class="bi bi-arrow-right me-2"></i>Soluci√≥n de problemas</a></li>
                        <li><a href="#preguntas-frecuentes"><i class="bi bi-arrow-right me-2"></i>Preguntas frecuentes</a></li>
                    </ul>
                </div>

                <!-- CONTENIDO PRINCIPAL -->
                <div class="manual-content">

                    <!-- ¬øQU√â ES? -->
                    <section class="manual-section" id="que-es">
                        <h2><i class="bi bi-info-circle"></i> ¬øQu√© son las Tarifas Anuales?</h2>
                        
                        <p>
                            Las <strong>Tarifas Anuales</strong> definen los costos educativos del colegio para cada 
                            grado y a√±o acad√©mico. Desde este m√≥dulo puedes configurar el Costo Educativo Anual (CEA) 
                            y los servicios opcionales como alimentaci√≥n, transporte y actividades extracurriculares.
                        </p>

                        <h3>¬øPara qu√© sirven?</h3>
                        <ul class="feature-list">
                            <li>Definir el costo educativo anual por cada grado</li>
                            <li>Calcular autom√°ticamente la matr√≠cula y pensi√≥n mensual</li>
                            <li>Configurar tarifas de servicios opcionales</li>
                            <li>Mantener hist√≥rico de tarifas por a√±o acad√©mico</li>
                            <li>Alimentar los procesos de facturaci√≥n y cartera</li>
                        </ul>

                        <h3>Conceptos clave</h3>
                        <ul>
                            <li>
                                <strong>CEA (Costo Educativo Anual):</strong> Es el valor total que cuesta 
                                la educaci√≥n del estudiante en un a√±o. Incluye matr√≠cula y las 10 pensiones mensuales.
                            </li>
                            <li>
                                <strong>Matr√≠cula:</strong> Pago √∫nico al inicio del a√±o. Se calcula como el 10% del CEA.
                            </li>
                            <li>
                                <strong>Pensi√≥n Mensual:</strong> Pago recurrente cada mes (10 meses). Se calcula 
                                como (CEA - Matr√≠cula) √∑ 10.
                            </li>
                            <li>
                                <strong>Servicios Opcionales:</strong> Alimentaci√≥n, transporte y extracurriculares. 
                                Son independientes del CEA y se cobran adicionalmente.
                            </li>
                        </ul>

                        <h3>Ejemplo visual de la tabla</h3>
                        <div class="table-example">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Grado</th>
                                        <th>CEA</th>
                                        <th>Matr√≠cula</th>
                                        <th>Pensi√≥n</th>
                                        <th>Alimentaci√≥n</th>
                                        <th>Transporte</th>
                                        <th>Extra</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <strong>Prejard√≠n</strong><br>
                                            <small class="text-muted">Preescolar</small>
                                        </td>
                                        <td><span class="editable-field-example">$ 15.000.000</span></td>
                                        <td><span class="calculated-field-example">$ 1.500.000</span></td>
                                        <td><span class="calculated-field-example">$ 1.350.000</span></td>
                                        <td><span class="editable-field-example">$ 350.000</span></td>
                                        <td><span class="editable-field-example">$ 280.000</span></td>
                                        <td><span class="editable-field-example">$ 0</span></td>
                                        <td><span class="btn-save-example"><i class="bi bi-save"></i> Guardar</span></td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong>Primero</strong><br>
                                            <small class="text-muted">Primaria</small>
                                        </td>
                                        <td><span class="editable-field-example">$ 16.500.000</span></td>
                                        <td><span class="calculated-field-example">$ 1.650.000</span></td>
                                        <td><span class="calculated-field-example">$ 1.485.000</span></td>
                                        <td><span class="editable-field-example">$ 350.000</span></td>
                                        <td><span class="editable-field-example">$ 280.000</span></td>
                                        <td><span class="editable-field-example">$ 120.000</span></td>
                                        <td><span class="btn-save-example"><i class="bi bi-save"></i> Guardar</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <p class="text-muted text-center">
                            <small>
                                <span class="editable-field-example me-2">Campos editables</span>
                                <span class="calculated-field-example">Campos calculados autom√°ticamente</span>
                            </small>
                        </p>
                    </section>

                    <!-- ANTES DE COMENZAR -->
                    <section class="manual-section" id="antes-comenzar">
                        <h2><i class="bi bi-exclamation-triangle"></i> Antes de comenzar</h2>

                        <div class="warning-box">
                            <strong><i class="bi bi-shield-lock me-2"></i>Acceso restringido</strong><br>
                            Esta p√°gina solo est√° disponible para usuarios con permisos de administraci√≥n. 
                            Si no puedes acceder, contacta al administrador del sistema.
                        </div>

                        <h3>Requisitos previos</h3>
                        <p>Para configurar tarifas necesitas tener configurados:</p>
                        <ul>
                            <li>
                                <strong>A√±os acad√©micos:</strong> Al menos un a√±o acad√©mico activo. 
                                Las tarifas se definen por a√±o.
                            </li>
                            <li>
                                <strong>Grados:</strong> Los grados activos aparecer√°n en la tabla para 
                                configurar sus tarifas.
                            </li>
                        </ul>

                        <h3>Consideraciones importantes</h3>
                        <ul>
                            <li>
                                <strong>Un registro por grado/a√±o:</strong> Cada combinaci√≥n de grado y 
                                a√±o acad√©mico tiene una √∫nica configuraci√≥n de tarifas.
                            </li>
                            <li>
                                <strong>Guardado individual:</strong> Cada grado se guarda por separado. 
                                Aseg√∫rate de hacer clic en "Guardar" para cada fila que modifiques.
                            </li>
                            <li>
                                <strong>Valores no negativos:</strong> Ning√∫n campo puede tener valores negativos.
                            </li>
                        </ul>

                        <div class="info-box">
                            <strong><i class="bi bi-lightbulb me-2"></i>Consejo:</strong>
                            Si vas a configurar las tarifas para un nuevo a√±o, puedes usar los valores 
                            del a√±o anterior como referencia y ajustarlos seg√∫n el incremento definido.
                        </div>
                    </section>

                    <!-- PANTALLA PRINCIPAL -->
                    <section class="manual-section" id="pantalla-principal">
                        <h2><i class="bi bi-display"></i> Conociendo la pantalla</h2>

                        <p>La pantalla de Tarifas Anuales tiene las siguientes secciones:</p>

                        <h3>Selector de a√±o acad√©mico</h3>
                        <p>
                            En la parte superior hay un selector para elegir el a√±o acad√©mico. 
                            Por defecto, se selecciona autom√°ticamente el a√±o marcado como "actual".
                        </p>
                        <div class="year-selector-example">
                            <label class="fw-bold mb-2">
                                <i class="bi bi-calendar-check me-1"></i>A√±o Acad√©mico
                            </label><br>
                            <select disabled>
                                <option>2025-2026 ‚úì</option>
                                <option>2024-2025</option>
                                <option>2023-2024</option>
                            </select>
                        </div>

                        <h3>Informaci√≥n de c√°lculos</h3>
                        <div class="alert-info-custom">
                            <i class="bi bi-info-circle me-2"></i>
                            <strong>C√°lculos autom√°ticos:</strong> 
                            Matr√≠cula = 10% del CEA | Pensi√≥n Mensual = (CEA - Matr√≠cula) √∑ 10
                        </div>

                        <h3>Tabla de tarifas por grado</h3>
                        <p>
                            La tabla muestra todos los grados activos con sus respectivas tarifas. 
                            Cada fila corresponde a un grado y muestra:
                        </p>
                        <ul>
                            <li><strong>Grado:</strong> Nombre del grado y su secci√≥n.</li>
                            <li><strong>CEA:</strong> Campo editable para el Costo Educativo Anual.</li>
                            <li><strong>Matr√≠cula:</strong> Campo calculado autom√°ticamente (solo lectura).</li>
                            <li><strong>Pensi√≥n Mensual:</strong> Campo calculado autom√°ticamente (solo lectura).</li>
                            <li><strong>Alimentaci√≥n:</strong> Campo editable para el servicio de alimentaci√≥n.</li>
                            <li><strong>Transporte:</strong> Campo editable para el servicio de transporte.</li>
                            <li><strong>Extracurriculares:</strong> Campo editable para actividades extra.</li>
                            <li><strong>Acciones:</strong> Bot√≥n para guardar los cambios de esa fila.</li>
                        </ul>

                        <h3>Panel de informaci√≥n</h3>
                        <p>
                            Debajo de la tabla hay un panel con informaci√≥n adicional sobre cada campo 
                            y c√≥mo funciona el guardado de datos.
                        </p>
                    </section>

                    <!-- F√ìRMULAS DE C√ÅLCULO -->
                    <section class="manual-section" id="formulas-calculo">
                        <h2><i class="bi bi-calculator"></i> F√≥rmulas de c√°lculo</h2>

                        <p>
                            El sistema calcula autom√°ticamente la matr√≠cula y la pensi√≥n mensual 
                            bas√°ndose en el CEA que ingreses. Estas son las f√≥rmulas utilizadas:
                        </p>

                        <div class="formula-box">
                            <h4>Matr√≠cula (10% del CEA)</h4>
                            <div class="formula">Matr√≠cula = CEA √ó 0.10</div>
                            <p class="text-muted mb-0">
                                Ejemplo: Si CEA = $15.000.000, entonces Matr√≠cula = $1.500.000
                            </p>
                        </div>

                        <div class="formula-box">
                            <h4>Pensi√≥n Mensual</h4>
                            <div class="formula">Pensi√≥n = (CEA - Matr√≠cula) √∑ 10</div>
                            <p class="text-muted mb-0">
                                Ejemplo: Si CEA = $15.000.000 y Matr√≠cula = $1.500.000,<br>
                                entonces Pensi√≥n = ($15.000.000 - $1.500.000) √∑ 10 = $1.350.000
                            </p>
                        </div>

                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>¬øPor qu√© 10 meses?</strong><br>
                            El a√±o escolar tiene 10 meses de clases (febrero a noviembre), por eso 
                            la pensi√≥n se divide en 10 pagos mensuales.
                        </div>

                        <h3>Verificaci√≥n del c√°lculo</h3>
                        <p>
                            Puedes verificar que los c√°lculos son correctos con esta f√≥rmula:
                        </p>
                        <div class="formula-box">
                            <div class="formula">CEA = Matr√≠cula + (Pensi√≥n √ó 10)</div>
                            <p class="text-muted mb-0">
                                Ejemplo: $1.500.000 + ($1.350.000 √ó 10) = $15.000.000 ‚úì
                            </p>
                        </div>
                    </section>

                    <!-- CONFIGURAR TARIFAS -->
                    <section class="manual-section" id="configurar-tarifas">
                        <h2><i class="bi bi-gear"></i> Configurar tarifas de un grado</h2>

                        <div class="step-card">
                            <h4><span class="step-number">1</span>Seleccionar el a√±o acad√©mico</h4>
                            <p>
                                Elige el a√±o acad√©mico para el cual deseas configurar las tarifas. 
                                Si es el a√±o actual, probablemente ya est√© seleccionado autom√°ticamente.
                            </p>
                        </div>

                        <div class="step-card">
                            <h4><span class="step-number">2</span>Localizar el grado en la tabla</h4>
                            <p>
                                Busca en la tabla el grado que deseas configurar. Los grados est√°n 
                                ordenados por su orden natural (preescolar, primaria, bachillerato).
                            </p>
                        </div>

                        <div class="step-card">
                            <h4><span class="step-number">3</span>Ingresar el CEA</h4>
                            <p>
                                En el campo "CEA" ingresa el Costo Educativo Anual para ese grado. 
                                El sistema acepta n√∫meros con o sin separadores de miles.
                            </p>
                            <p>
                                <strong>Al cambiar este valor</strong>, la matr√≠cula y pensi√≥n se 
                                recalculan autom√°ticamente.
                            </p>
                        </div>

                        <div class="step-card">
                            <h4><span class="step-number">4</span>Verificar los c√°lculos</h4>
                            <p>
                                Revisa que los valores calculados de Matr√≠cula y Pensi√≥n sean correctos. 
                                Estos campos son de solo lectura y no se pueden modificar manualmente.
                            </p>
                        </div>

                        <div class="step-card">
                            <h4><span class="step-number">5</span>Configurar servicios opcionales</h4>
                            <p>
                                Si aplica, ingresa los valores para:
                            </p>
                            <ul>
                                <li><strong>Alimentaci√≥n:</strong> Costo mensual del servicio de alimentaci√≥n.</li>
                                <li><strong>Transporte:</strong> Costo mensual del servicio de transporte.</li>
                                <li><strong>Extracurriculares:</strong> Costo de actividades extra.</li>
                            </ul>
                            <p>
                                Si un servicio no aplica para ese grado, d√©jalo en 0.
                            </p>
                        </div>

                        <div class="step-card">
                            <h4><span class="step-number">6</span>Guardar los cambios</h4>
                            <p>
                                Haz clic en el bot√≥n <strong>"Guardar"</strong> de esa fila para 
                                almacenar las tarifas.
                            </p>
                        </div>

                        <div class="success-box">
                            <strong><i class="bi bi-check-circle me-2"></i>¬°Listo!</strong><br>
                            Las tarifas quedar√°n guardadas y listas para usar en facturaci√≥n.
                        </div>

                        <div class="warning-box">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Importante:</strong>
                            Recuerda guardar cada grado individualmente. Los cambios no guardados 
                            se perder√°n si cambias de a√±o acad√©mico o cierras la p√°gina.
                        </div>
                    </section>

                    <!-- CAMPOS DEL FORMULARIO -->
                    <section class="manual-section" id="campos-formulario">
                        <h2><i class="bi bi-input-cursor-text"></i> Descripci√≥n de los campos</h2>

                        <table class="fields-table">
                            <thead>
                                <tr>
                                    <th style="width: 25%">Campo</th>
                                    <th>Descripci√≥n</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>CEA <span class="required-badge">Editable</span></td>
                                    <td>
                                        <strong>Costo Educativo Anual.</strong> Valor total que cuesta la educaci√≥n 
                                        del estudiante en el a√±o. Incluye matr√≠cula y pensiones. 
                                        Al modificar este campo, se recalculan autom√°ticamente la matr√≠cula y pensi√≥n.
                                    </td>
                                </tr>
                                <tr>
                                    <td>Matr√≠cula <span class="calculated-badge">Calculado</span></td>
                                    <td>
                                        Se calcula autom√°ticamente como el <strong>10% del CEA</strong>. 
                                        Es un pago √∫nico al inicio del a√±o escolar. 
                                        Este campo no se puede editar manualmente.
                                    </td>
                                </tr>
                                <tr>
                                    <td>Pensi√≥n Mensual <span class="calculated-badge">Calculado</span></td>
                                    <td>
                                        Se calcula autom√°ticamente como <strong>(CEA - Matr√≠cula) √∑ 10</strong>. 
                                        Es el valor que se paga cada mes durante los 10 meses del a√±o escolar. 
                                        Este campo no se puede editar manualmente.
                                    </td>
                                </tr>
                                <tr>
                                    <td>Alimentaci√≥n <span class="optional-badge">Opcional</span></td>
                                    <td>
                                        Costo mensual del servicio de alimentaci√≥n escolar. 
                                        Si el grado no tiene este servicio, d√©jalo en 0.
                                    </td>
                                </tr>
                                <tr>
                                    <td>Transporte <span class="optional-badge">Opcional</span></td>
                                    <td>
                                        Costo mensual del servicio de transporte escolar. 
                                        Si el grado no tiene este servicio, d√©jalo en 0.
                                    </td>
                                </tr>
                                <tr>
                                    <td>Extracurriculares <span class="optional-badge">Opcional</span></td>
                                    <td>
                                        Costo de actividades extracurriculares (deportes, m√∫sica, etc.). 
                                        Si el grado no tiene este servicio, d√©jalo en 0.
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <h3>Formato de los valores</h3>
                        <p>
                            Los valores se muestran con formato de moneda colombiana (separadores de miles con punto). 
                            Puedes ingresar valores con o sin formato:
                        </p>
                        <ul>
                            <li>‚úì <span class="currency-example">15000000</span> (sin formato)</li>
                            <li>‚úì <span class="currency-example">15.000.000</span> (con formato)</li>
                        </ul>
                        <p>
                            Al salir del campo, el sistema autom√°ticamente aplica el formato correcto.
                        </p>
                    </section>

                    <!-- SOLUCI√ìN DE PROBLEMAS -->
                    <section class="manual-section" id="problemas-comunes">
                        <h2><i class="bi bi-wrench"></i> Soluci√≥n de problemas</h2>

                        <div class="faq-item">
                            <p class="faq-question">No aparecen grados en la tabla</p>
                            <p class="faq-answer">
                                Verifica que existan grados con estado "activo" en el sistema. 
                                Los grados inactivos no aparecen en la tabla de tarifas.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">Error: "Los valores no pueden ser negativos"</p>
                            <p class="faq-answer">
                                Revisa que todos los campos tengan valores de cero o mayores. 
                                Ning√∫n campo acepta valores negativos.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">La matr√≠cula o pensi√≥n no se actualiza</p>
                            <p class="faq-answer">
                                Estos campos se recalculan cuando modificas el CEA. Si no se actualizan, 
                                intenta salir del campo CEA (presiona Tab o haz clic fuera) para activar el c√°lculo.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">El selector de a√±o est√° vac√≠o</p>
                            <p class="faq-answer">
                                No hay a√±os acad√©micos activos en el sistema. Crea al menos un a√±o 
                                acad√©mico con estado "activo" desde el m√≥dulo de A√±os Acad√©micos.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">Los cambios no se guardaron</p>
                            <p class="faq-answer">
                                Recuerda hacer clic en el bot√≥n "Guardar" de cada fila modificada. 
                                Los cambios no se guardan autom√°ticamente. Verifica que aparezca 
                                el mensaje de confirmaci√≥n "Tarifa guardada exitosamente".
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">El formato de los n√∫meros se ve extra√±o</p>
                            <p class="faq-answer">
                                El sistema usa el formato colombiano (puntos como separadores de miles). 
                                Si ves comas, puede haber un problema de configuraci√≥n regional. 
                                Contacta al administrador t√©cnico.
                            </p>
                        </div>
                    </section>

                    <!-- PREGUNTAS FRECUENTES -->
                    <section class="manual-section" id="preguntas-frecuentes">
                        <h2><i class="bi bi-chat-left-quote"></i> Preguntas frecuentes</h2>

                        <div class="faq-item">
                            <p class="faq-question">¬øPuedo cambiar el porcentaje de la matr√≠cula?</p>
                            <p class="faq-answer">
                                No desde esta pantalla. El c√°lculo del 10% est√° definido por norma 
                                y se aplica autom√°ticamente. Si necesitas un porcentaje diferente, 
                                contacta al administrador t√©cnico.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">¬øQu√© pasa si no configuro las tarifas de un grado?</p>
                            <p class="faq-answer">
                                Los grados sin tarifas tendr√°n valores en cero. Esto puede afectar 
                                los procesos de facturaci√≥n, ya que no se podr√° calcular el cobro correctamente.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">¬øPuedo tener tarifas diferentes para el mismo grado?</p>
                            <p class="faq-answer">
                                No para el mismo a√±o acad√©mico. Cada combinaci√≥n grado/a√±o tiene una 
                                √∫nica tarifa. Si necesitas tarifas diferenciadas (por ejemplo, para 
                                antiguos vs nuevos), contacta al equipo t√©cnico.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">¬øLas tarifas se copian autom√°ticamente al siguiente a√±o?</p>
                            <p class="faq-answer">
                                No, cada a√±o acad√©mico comienza con tarifas en cero. Debes configurar 
                                las tarifas manualmente para cada nuevo a√±o.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">¬øPuedo modificar tarifas de a√±os anteriores?</p>
                            <p class="faq-answer">
                                S√≠, t√©cnicamente puedes. Sin embargo, se recomienda no modificar 
                                tarifas de a√±os cerrados para mantener la consistencia hist√≥rica.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">¬øLos servicios opcionales son por mes o por a√±o?</p>
                            <p class="faq-answer">
                                Los valores de alimentaci√≥n, transporte y extracurriculares generalmente 
                                representan el costo mensual. Verifica con el √°rea financiera la 
                                convenci√≥n utilizada en tu instituci√≥n.
                            </p>
                        </div>

                        <div class="faq-item">
                            <p class="faq-question">¬øC√≥mo afectan estas tarifas a la facturaci√≥n?</p>
                            <p class="faq-answer">
                                Las tarifas definidas aqu√≠ son la base para generar los cobros a 
                                las familias. El sistema de facturaci√≥n usa estos valores para 
                                calcular matr√≠culas, pensiones y servicios adicionales.
                            </p>
                        </div>
                    </section>

                </div>

                <!-- TARJETA PARA REPORTAR BUGS - ALTO CONTRASTE -->
                <div class="bug-report-card">
                    <i class="bi bi-bug-fill" style="font-size: 2.5rem; margin-bottom: 0.5rem; display: block;"></i>
                    <h4>¬øEncontraste un problema o tienes una sugerencia?</h4>
                    <p>
                        Si algo no funciona como esperas, experimentaste un error, o tienes ideas 
                        para mejorar esta funcionalidad, cu√©ntanos. Tu retroalimentaci√≥n es muy valiosa.
                    </p>
                    <a href="../report-bug.html" class="btn btn-report">
                        <i class="bi bi-exclamation-triangle me-2"></i>Reportar Bug o Problema
                    </a>
                </div>

            </div>
        </div>

    </div>

    <!-- BOT√ìN FLOTANTE PARA REPORTAR BUGS -->
    <a href="../report-bug.html" class="btn floating-bug-button" title="Reportar Bug">
        <i class="bi bi-bug-fill me-2"></i>Reportar Bug
    </a>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/js/config.js"></script>
    
    <script>
        // ==========================================
        // VARIABLES GLOBALES
        // ==========================================
        let currentUser = null;

        // ==========================================
        // CONFIGURACI√ìN DE LA P√ÅGINA
        // ==========================================
        const PAGE_CONFIG = {
            moduleName: 'Configuraci√≥n',
            modulePath: 'config',
            pageTitle: 'Tarifas Anuales',
            pagePath: 'annual-fees.html',
            moduleDescription: 'Gesti√≥n de tarifas anuales del colegio por grado'
        };

        // ==========================================
        // INICIALIZACI√ìN
        // ==========================================
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üìñ Iniciando p√°gina de manual...');
            
            try {
                // Verificar si existe la funci√≥n de colores corporativos
                if (typeof loadAndApplyBrandColors === 'function') {
                    await loadAndApplyBrandColors();
                }
                
                // Verificar sesi√≥n si la funci√≥n existe
                if (typeof getStoredSession === 'function') {
                    const session = getStoredSession();
                    if (session && session.user) {
                        currentUser = session.user;
                    }
                }
                
                // Actualizar informaci√≥n en la p√°gina
                updatePageInfo();
                
                console.log('‚úÖ P√°gina de manual lista');
                
            } catch (error) {
                console.error('‚ùå Error inicializando p√°gina:', error);
            }
        });

        // ==========================================
        // ACTUALIZAR INFORMACI√ìN DE LA P√ÅGINA
        // ==========================================
        function updatePageInfo() {
            document.title = `Manual - ${PAGE_CONFIG.moduleName} - ${PAGE_CONFIG.pageTitle} - SchoolNet`;
        }

        // ==========================================
        // UTILIDADES DE LOADING
        // ==========================================
        function showLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.remove('hidden');
            }
        }

        function hideLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.add('hidden');
            }
        }

        // ==========================================
        // FUNCI√ìN DE MENSAJES
        // ==========================================
        function showMessage(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            if (!alertContainer) return;
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertContainer.appendChild(alertDiv);
            
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }
    </script>
</body>
</html>
