<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- VERSIÓN DE LA PÁGINA -->
    <meta name="page-version" content="26.01.26.07.04">
    
    <title>Manual - Herramientas Generales - Asistencia de Familias - SchoolNet</title>
    
    <!-- Bootstrap CSS - VERSIÓN FIJA PROBADA -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-overlay.hidden {
            display: none;
        }
        
        .loading-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Encabezado discreto */
        .manual-header {
            background: #f8f9fa;
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding: 1.5rem 0;
            margin-bottom: 2rem;
        }

        .manual-header h1 {
            font-size: 1.75rem;
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 0.25rem;
        }

        .manual-header .subtitle {
            color: #6c757d;
            font-size: 0.95rem;
        }

        /* Info card */
        .info-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Tarjeta para reportar bugs - CON COLOR PRIMARIO */
        .bug-report-card {
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .bug-report-card h5 {
            color: white;
        }

        .bug-report-card .btn-light {
            background: white;
            color: var(--system-primary-color, #1B365D);
            border: none;
            font-weight: 600;
        }

        .bug-report-card .btn-light:hover {
            background: #f8f9fa;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        /* Botón flotante para reportar bugs */
        .floating-bug-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            background: var(--system-primary-color, #dc3545) !important;
            border-color: var(--system-primary-color, #dc3545) !important;
            color: white !important;
        }

        .floating-bug-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
            opacity: 0.9;
        }

        .icon-large {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        /* Estilos para el contenido del manual */
        .manual-section {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .manual-section h3 {
            color: var(--system-primary-color, #1B365D);
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
        }

        .manual-section h4 {
            color: var(--system-primary-color, #1B365D);
            font-size: 1.25rem;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }

        .info-box {
            background: #e7f3ff;
            border-left: 4px solid var(--system-secondary-color, #667eea);
            padding: 1rem 1.25rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .info-box.warning {
            background: #fff3cd;
            border-left-color: var(--system-tertiary-color, #ffc107);
        }

        .info-box.success {
            background: #d1e7dd;
            border-left-color: #28a745;
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 0.75rem;
        }

        .feature-list {
            list-style: none;
            padding-left: 0;
        }

        .feature-list li {
            padding: 0.5rem 0;
            padding-left: 2rem;
            position: relative;
        }

        .feature-list li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: var(--system-primary-color, #1B365D);
            font-weight: bold;
            font-size: 1.2rem;
        }

        .tab-description {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 6px;
            margin: 1rem 0;
        }

        .use-case {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 1rem;
            margin: 0.5rem 0;
        }

        .use-case strong {
            color: var(--system-primary-color, #1B365D);
        }

        .faq-item {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .faq-question {
            color: var(--system-primary-color, #1B365D);
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 0.75rem;
        }

        .faq-answer {
            color: #495057;
            line-height: 1.6;
        }
    </style>
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="mb-0">Cargando...</p>
        </div>
    </div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="container-fluid">

        <!-- ENCABEZADO DISCRETO -->
        <div class="manual-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1>
                            <i class="bi bi-book me-2"></i>
                            Manual: Asistencia de Familias a Actividades
                        </h1>
                        <p class="subtitle mb-0">Herramientas Generales - Gestión de actividades escolares y registro de participación familiar</p>
                    </div>
                    <div class="col-md-4 text-md-end mt-3 mt-md-0">
                        <a href="../../modules/general-tools/family-activities.html" class="btn btn-outline-primary">
                            <i class="bi bi-arrow-left me-1"></i>Volver al Módulo
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- CONTENEDOR DE ALERTAS -->
        <div id="alertContainer"></div>

        <div class="row">
            <div class="col-lg-10 mx-auto">

                <!-- INFORMACIÓN CONTEXTUAL -->
                <div class="info-card">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h6 class="text-muted mb-2">Manual de:</h6>
                            <h5 class="mb-1"><strong id="display-module">Herramientas Generales</strong></h5>
                            <p class="text-muted mb-0 small" id="display-page">Asistencia de Familias a Actividades</p>
                        </div>
                        <div class="col-md-6 text-md-end mt-3 mt-md-0">
                            <p class="small text-muted mb-0">
                                <i class="bi bi-info-circle me-1"></i>
                                Si tienes dudas o encuentras algún problema,<br>
                                puedes reportarlo usando el botón de abajo.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- SECCIÓN 1: ¿QUÉ ES? -->
                <!-- ============================================ -->
                <div class="manual-section">
                    <h3><i class="bi bi-info-circle me-2"></i>¿Qué es Asistencia de Familias a Actividades?</h3>
                    
                    <p>
                        <strong>Asistencia de Familias a Actividades</strong> es una herramienta integral diseñada para gestionar 
                        actividades escolares (reuniones de padres, eventos, talleres, etc.) y hacer seguimiento a la participación 
                        de las familias en estas actividades.
                    </p>

                    <div class="info-box">
                        <strong><i class="bi bi-lightbulb me-2"></i>Para Directivos:</strong>
                        Esta herramienta le permite crear y organizar actividades institucionales, registrar la asistencia de las 
                        familias, analizar patrones de participación, identificar familias comprometidas o que requieren seguimiento, 
                        y generar estadísticas para la toma de decisiones estratégicas.
                    </div>

                    <h4>Características principales:</h4>
                    <ul class="feature-list">
                        <li><strong>Gestión completa de actividades:</strong> Crear, editar y organizar actividades escolares</li>
                        <li><strong>Registro de asistencia:</strong> Marcar qué familias asistieron a cada actividad</li>
                        <li><strong>Análisis estadístico:</strong> Métricas de participación y tendencias</li>
                        <li><strong>Rankings de familias:</strong> Identificar familias más y menos participativas</li>
                        <li><strong>Búsqueda individual:</strong> Consultar historial de participación de una familia específica</li>
                        <li><strong>Alertas automáticas:</strong> Detectar actividades sin registro de asistencia</li>
                    </ul>

                    <div class="info-box success">
                        <strong><i class="bi bi-check-circle me-2"></i>Beneficio institucional:</strong>
                        Fomentar y medir el compromiso familiar con la institución, identificar oportunamente familias que 
                        requieren acompañamiento, y reconocer a aquellas con alta participación.
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- SECCIÓN 2: LAS TRES PESTAÑAS -->
                <!-- ============================================ -->
                <div class="manual-section">
                    <h3><i class="bi bi-layout-text-window me-2"></i>Las Tres Pestañas del Sistema</h3>
                    
                    <p>
                        El sistema está organizado en <strong>3 pestañas principales</strong>, cada una diseñada para 
                        una función específica en el ciclo de gestión de actividades:
                    </p>

                    <!-- PESTAÑA 1: GESTIONAR ACTIVIDADES -->
                    <div class="tab-description">
                        <h4><i class="bi bi-list-task me-2"></i>1. Gestionar Actividades</h4>
                        <p><strong>Propósito:</strong> Crear, editar, visualizar y eliminar actividades escolares.</p>
                        
                        <p><strong>¿Qué es una actividad?</strong></p>
                        <p>Una actividad es cualquier evento escolar al que se invita a las familias, como:</p>
                        <ul>
                            <li>Reuniones de padres de familia</li>
                            <li>Talleres para padres</li>
                            <li>Eventos deportivos o culturales</li>
                            <li>Asambleas generales</li>
                            <li>Actividades de integración familiar</li>
                        </ul>

                        <p><strong>Información de cada actividad:</strong></p>
                        <ul>
                            <li><strong>Nombre:</strong> Descripción de la actividad (ej: "Reunión de padres - Primer periodo")</li>
                            <li><strong>Fecha:</strong> Cuándo se realizó o realizará</li>
                            <li><strong>Estado:</strong> Abierta (permite registro) o Cerrada (no permite cambios)</li>
                            <li><strong>Cursos asociados:</strong> Qué cursos están invitados (determina qué familias participan)</li>
                        </ul>

                        <div class="info-box warning">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Importante:</strong>
                            Solo el usuario que creó una actividad puede editarla o eliminarla. Si otra persona creó la actividad, 
                            aparecerá como "Creada por otro usuario" y no podrás modificarla.
                        </div>

                        <p><strong>Cómo crear una actividad:</strong></p>
                        <ol>
                            <li><span class="step-number">1</span>Haz clic en el botón "Nueva Actividad"</li>
                            <li><span class="step-number">2</span>Completa el nombre, fecha y estado</li>
                            <li><span class="step-number">3</span>Selecciona los cursos asociados (botón "Seleccionar Cursos")</li>
                            <li><span class="step-number">4</span>Haz clic en "Guardar Actividad"</li>
                        </ol>

                        <p><strong>Filtros disponibles:</strong></p>
                        <ul>
                            <li><strong>Por estado:</strong> Ver solo actividades abiertas o cerradas</li>
                            <li><strong>Por nombre:</strong> Buscar una actividad específica</li>
                        </ul>

                        <p><strong>¿Cuándo usar esta pestaña?</strong></p>
                        <ul>
                            <li>Al planificar una nueva actividad familiar</li>
                            <li>Para revisar actividades pasadas</li>
                            <li>Para cerrar una actividad ya finalizada</li>
                            <li>Para corregir información de una actividad (si fuiste quien la creó)</li>
                        </ul>
                    </div>

                    <!-- PESTAÑA 2: REGISTRAR ASISTENCIA -->
                    <div class="tab-description">
                        <h4><i class="bi bi-check2-square me-2"></i>2. Registrar Asistencia</h4>
                        <p><strong>Propósito:</strong> Marcar qué familias (estudiantes) asistieron a cada actividad.</p>
                        
                        <p><strong>Cómo funciona el registro:</strong></p>
                        <ol>
                            <li><span class="step-number">1</span>Selecciona la actividad (solo aparecen actividades "abiertas")</li>
                            <li><span class="step-number">2</span>Selecciona el curso específico</li>
                            <li><span class="step-number">3</span>El sistema muestra la lista de todos los estudiantes del curso</li>
                            <li><span class="step-number">4</span>Marca con ✓ los estudiantes cuyas familias asistieron</li>
                            <li><span class="step-number">5</span>Haz clic en "Guardar Asistencias"</li>
                        </ol>

                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>¿Por qué se registra por estudiante?</strong>
                            El sistema registra la asistencia por estudiante porque es la forma más práctica de identificar 
                            a las familias. Cada estudiante pertenece a una familia, así que al marcar que un estudiante 
                            asistió, estamos registrando que su familia participó.
                        </div>

                        <p><strong>Características útiles:</strong></p>
                        <ul>
                            <li><strong>Marcar/Desmarcar todos:</strong> Checkbox superior para seleccionar o deseleccionar rápidamente</li>
                            <li><strong>Edición múltiple:</strong> Puedes cambiar el registro varias veces hasta cerrarlo</li>
                            <li><strong>Indicador visual:</strong> Los estudiantes ya registrados muestran badge "Ya registrado"</li>
                        </ul>

                        <div class="info-box warning">
                            <strong><i class="bi bi-shield-exclamation me-2"></i>Actividades cerradas:</strong>
                            Solo las actividades con estado "Abierta" aparecen en esta pestaña. Si cierras una actividad, 
                            ya no podrás modificar sus registros de asistencia.
                        </div>

                        <p><strong>¿Cuándo usar esta pestaña?</strong></p>
                        <ul>
                            <li>Después de realizar una actividad, para registrar quién asistió</li>
                            <li>Para corregir registros de asistencia antes de cerrar la actividad</li>
                            <li>Para completar registros parciales (por ejemplo, un curso a la vez)</li>
                        </ul>
                    </div>

                    <!-- PESTAÑA 3: DASHBOARD E INFORMES -->
                    <div class="tab-description">
                        <h4><i class="bi bi-graph-up me-2"></i>3. Dashboard e Informes</h4>
                        <p><strong>Propósito:</strong> Analizar datos, generar estadísticas y obtener insights sobre la participación familiar.</p>
                        
                        <p><strong>Componentes del Dashboard:</strong></p>

                        <h5 class="mt-3">A. Filtros de Período</h5>
                        <ul>
                            <li><strong>Fecha desde / Fecha hasta:</strong> Define el rango de tiempo a analizar</li>
                            <li><strong>Curso:</strong> Filtra por un curso específico (opcional)</li>
                            <li>Por defecto, el sistema sugiere los últimos 30 días</li>
                        </ul>

                        <div class="info-box">
                            <strong><i class="bi bi-calendar-range me-2"></i>Nota importante:</strong>
                            Al abrir esta pestaña, debes hacer clic en "Aplicar Filtros" para cargar los datos. 
                            El sistema no carga automáticamente para evitar consultas innecesarias.
                        </div>

                        <h5 class="mt-3">B. Alertas: Actividades sin Registro</h5>
                        <p>Muestra actividades ya realizadas (fecha pasada) que aún no tienen asistencia registrada:</p>
                        <ul>
                            <li>Lista las primeras 10 actividades pendientes</li>
                            <li>Indica cuántas más hay si exceden 10</li>
                            <li>Útil para hacer seguimiento de tareas pendientes</li>
                        </ul>

                        <h5 class="mt-3">C. Métricas Generales</h5>
                        <p>Tres indicadores clave del período seleccionado:</p>
                        <ul>
                            <li><strong>Total Actividades:</strong> Número de actividades realizadas</li>
                            <li><strong>Promedio Asistencia:</strong> Porcentaje general de participación</li>
                            <li><strong>Familias Participantes:</strong> Número único de familias que asistieron al menos una vez</li>
                        </ul>

                        <h5 class="mt-3">D. Rankings de Familias</h5>
                        <p>Dos listas comparativas:</p>
                        
                        <p><strong>Familias con Mayor Participación (Top 10):</strong></p>
                        <ul>
                            <li>Familias ordenadas por porcentaje de asistencia</li>
                            <li>Muestra nombre de familia, código, y estadísticas</li>
                            <li>Ideal para reconocimientos y felicitaciones</li>
                        </ul>

                        <p><strong>Familias con Menor Participación (Bottom 10):</strong></p>
                        <ul>
                            <li>Familias con menor porcentaje de asistencia</li>
                            <li>Útil para identificar familias que requieren seguimiento</li>
                            <li>Base para estrategias de acercamiento familiar</li>
                        </ul>

                        <div class="info-box success">
                            <strong><i class="bi bi-sort-numeric-down me-2"></i>Criterio de ordenamiento:</strong>
                            Los rankings se ordenan por porcentaje de asistencia. En caso de empate, se prioriza la familia 
                            con más invitaciones totales (más oportunidades de participación).
                        </div>

                        <h5 class="mt-3">E. Búsqueda de Familia Específica</h5>
                        <p>Sección especial para consultar el historial de una familia individual:</p>
                        <ol>
                            <li>Escribe el código de familia (número) o nombre</li>
                            <li>Haz clic en "Buscar"</li>
                            <li>Si hay múltiples resultados, selecciona la familia deseada</li>
                            <li>El sistema muestra:
                                <ul>
                                    <li>Número de invitaciones totales</li>
                                    <li>Número de asistencias</li>
                                    <li>Porcentaje de participación</li>
                                    <li>Tabla detallada con todas las actividades y si asistió o no</li>
                                </ul>
                            </li>
                        </ol>

                        <div class="info-box">
                            <strong><i class="bi bi-person-badge me-2"></i>Búsqueda inteligente:</strong>
                            Si buscas por número, el sistema busca por código exacto. Si buscas por texto, busca coincidencias 
                            en el nombre de la familia. Puedes buscar parcialmente (ej: "García" encontrará todas las familias García).
                        </div>

                        <p><strong>¿Cuándo usar esta pestaña?</strong></p>
                        <ul>
                            <li>Para reportes mensuales o trimestrales de participación</li>
                            <li>Antes de reuniones con familias (preparar datos objetivos)</li>
                            <li>Para identificar familias que necesitan seguimiento</li>
                            <li>Para reconocer públicamente a familias comprometidas</li>
                            <li>Para planificar estrategias de acercamiento familiar</li>
                        </ul>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- SECCIÓN 3: FLUJO COMPLETO DE TRABAJO -->
                <!-- ============================================ -->
                <div class="manual-section">
                    <h3><i class="bi bi-diagram-3 me-2"></i>Flujo Completo de Trabajo</h3>
                    
                    <p>Este es el ciclo típico de uso del sistema:</p>

                    <div class="card mb-3">
                        <div class="card-body">
                            <h5 class="card-title"><span class="badge bg-primary me-2">Paso 1</span> Planificación</h5>
                            <p class="mb-0">
                                <strong>Acción:</strong> Ir a la pestaña "Gestionar Actividades" → Crear una nueva actividad<br>
                                <strong>Cuándo:</strong> Al planificar una reunión, taller o evento familiar<br>
                                <strong>Ejemplo:</strong> "Reunión de padres de familia - Segundo periodo" para 5°A, 5°B, 5°C
                            </p>
                        </div>
                    </div>

                    <div class="card mb-3">
                        <div class="card-body">
                            <h5 class="card-title"><span class="badge bg-success me-2">Paso 2</span> Realización</h5>
                            <p class="mb-0">
                                <strong>Acción:</strong> Llevar a cabo la actividad (fuera del sistema)<br>
                                <strong>Cuándo:</strong> En la fecha programada<br>
                                <strong>Importante:</strong> Llevar lista de asistencia o registro de quién participó
                            </p>
                        </div>
                    </div>

                    <div class="card mb-3">
                        <div class="card-body">
                            <h5 class="card-title"><span class="badge bg-info me-2">Paso 3</span> Registro</h5>
                            <p class="mb-0">
                                <strong>Acción:</strong> Ir a "Registrar Asistencia" → Seleccionar actividad → Marcar asistentes<br>
                                <strong>Cuándo:</strong> Después de realizar la actividad, idealmente el mismo día o al siguiente<br>
                                <strong>Consejo:</strong> Registrar curso por curso para mayor orden
                            </p>
                        </div>
                    </div>

                    <div class="card mb-3">
                        <div class="card-body">
                            <h5 class="card-title"><span class="badge bg-warning me-2">Paso 4</span> Cierre</h5>
                            <p class="mb-0">
                                <strong>Acción:</strong> Volver a "Gestionar Actividades" → Editar la actividad → Cambiar estado a "Cerrada"<br>
                                <strong>Cuándo:</strong> Una vez confirmado que todos los registros están completos<br>
                                <strong>Efecto:</strong> Ya no se podrá modificar la asistencia de esa actividad
                            </p>
                        </div>
                    </div>

                    <div class="card mb-3">
                        <div class="card-body">
                            <h5 class="card-title"><span class="badge bg-secondary me-2">Paso 5</span> Análisis</h5>
                            <p class="mb-0">
                                <strong>Acción:</strong> Ir a "Dashboard e Informes" → Aplicar filtros → Revisar estadísticas<br>
                                <strong>Cuándo:</strong> Mensualmente, trimestralmente, o cuando necesites tomar decisiones<br>
                                <strong>Uso:</strong> Identificar tendencias, reconocer participación, detectar casos que requieren atención
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- SECCIÓN 4: CASOS DE USO COMUNES -->
                <!-- ============================================ -->
                <div class="manual-section">
                    <h3><i class="bi bi-journal-check me-2"></i>Casos de Uso Comunes para Directivos</h3>

                    <div class="use-case">
                        <strong>Caso 1: "Necesito crear una reunión de padres para todos los cursos de primaria"</strong>
                        <p class="mb-1 mt-2">Solución:</p>
                        <ol class="mb-0">
                            <li>Ir a "Gestionar Actividades" → "Nueva Actividad"</li>
                            <li>Nombre: "Reunión de padres - Primaria - [fecha]"</li>
                            <li>Fecha: Seleccionar día de la reunión</li>
                            <li>Estado: "Abierta"</li>
                            <li>Click en "Seleccionar Cursos" → Marcar todos los cursos de primaria</li>
                            <li>Guardar</li>
                        </ol>
                    </div>

                    <div class="use-case">
                        <strong>Caso 2: "Ya se realizó una actividad, necesito registrar quién asistió"</strong>
                        <p class="mb-1 mt-2">Solución:</p>
                        <ol class="mb-0">
                            <li>Ir a "Registrar Asistencia"</li>
                            <li>Seleccionar la actividad del menú desplegable</li>
                            <li>Seleccionar el primer curso</li>
                            <li>Marcar los estudiantes que asistieron (con lista física de referencia)</li>
                            <li>Guardar asistencias</li>
                            <li>Repetir para cada curso asociado</li>
                        </ol>
                    </div>

                    <div class="use-case">
                        <strong>Caso 3: "¿Qué familias de 4°A tienen menos del 50% de asistencia este semestre?"</strong>
                        <p class="mb-1 mt-2">Solución:</p>
                        <ol class="mb-0">
                            <li>Ir a "Dashboard e Informes"</li>
                            <li>Configurar fechas: inicio y fin del semestre</li>
                            <li>Filtro de curso: Seleccionar "4°A"</li>
                            <li>Click en "Aplicar Filtros"</li>
                            <li>Revisar la sección "Familias con Menor Participación"</li>
                            <li>Identificar familias con porcentaje inferior al 50%</li>
                        </ol>
                    </div>

                    <div class="use-case">
                        <strong>Caso 4: "Necesito el historial completo de participación de la familia García"</strong>
                        <p class="mb-1 mt-2">Solución:</p>
                        <ol class="mb-0">
                            <li>Ir a "Dashboard e Informes"</li>
                            <li>En la sección de búsqueda individual, escribir "García"</li>
                            <li>Click en "Buscar"</li>
                            <li>Si hay varios, seleccionar la familia específica de la lista</li>
                            <li>Revisar la tabla detallada con todas las actividades y asistencias</li>
                        </ol>
                    </div>

                    <div class="use-case">
                        <strong>Caso 5: "Hay actividades de meses pasados sin registro de asistencia"</strong>
                        <p class="mb-1 mt-2">Solución:</p>
                        <ol class="mb-0">
                            <li>Ir a "Dashboard e Informes"</li>
                            <li>Aplicar filtros con rango amplio de fechas</li>
                            <li>Revisar la sección "Actividades sin registro de asistencia"</li>
                            <li>Para cada actividad listada:
                                <ul>
                                    <li>Si ya se realizó y tienes datos: Registrar asistencia y cerrar</li>
                                    <li>Si ya se realizó pero no hay datos: Cerrar la actividad sin registro</li>
                                    <li>Si aún no se realiza: Dejar abierta</li>
                                </ul>
                            </li>
                        </ol>
                    </div>

                    <div class="use-case">
                        <strong>Caso 6: "¿Cuál es el promedio general de asistencia del último trimestre?"</strong>
                        <p class="mb-1 mt-2">Solución:</p>
                        <ol class="mb-0">
                            <li>Ir a "Dashboard e Informes"</li>
                            <li>Configurar fechas del trimestre</li>
                            <li>Dejar el filtro de curso en "Todos los cursos"</li>
                            <li>Click en "Aplicar Filtros"</li>
                            <li>Revisar la métrica "Promedio Asistencia" en las tarjetas superiores</li>
                        </ol>
                    </div>

                    <div class="use-case">
                        <strong>Caso 7: "Quiero felicitar a las 5 familias más participativas del año"</strong>
                        <p class="mb-1 mt-2">Solución:</p>
                        <ol class="mb-0">
                            <li>Ir a "Dashboard e Informes"</li>
                            <li>Configurar fechas: todo el año escolar</li>
                            <li>Click en "Aplicar Filtros"</li>
                            <li>Revisar "Familias con Mayor Participación"</li>
                            <li>Tomar nota de las primeras 5 familias con mayor porcentaje</li>
                            <li>Usar esta información para reconocimientos públicos o cartas de felicitación</li>
                        </ol>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- SECCIÓN 5: PREGUNTAS FRECUENTES -->
                <!-- ============================================ -->
                <div class="manual-section">
                    <h3><i class="bi bi-question-circle me-2"></i>Preguntas Frecuentes</h3>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¿Cuál es la diferencia entre una actividad "abierta" y una "cerrada"?
                        </div>
                        <div class="faq-answer">
                            <ul>
                                <li><strong>Abierta:</strong> Permite registrar y modificar asistencias. Aparece en la pestaña "Registrar Asistencia"</li>
                                <li><strong>Cerrada:</strong> Ya no permite cambios en la asistencia. Útil para "congelar" datos una vez confirmados</li>
                            </ul>
                            <strong>Recomendación:</strong> Mantén actividades abiertas mientras estés confirmando asistencias. Una vez seguro de que 
                            los datos son definitivos, cierra la actividad para evitar cambios accidentales.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¿Por qué no puedo editar una actividad que veo en la lista?
                        </div>
                        <div class="faq-answer">
                            Solo el usuario que creó la actividad puede editarla o eliminarla. Si otra persona la creó, verás el mensaje 
                            "Creada por otro usuario" y los botones de edición estarán deshabilitados. Esto previene conflictos y 
                            mantiene la responsabilidad clara sobre cada actividad.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¿Puedo eliminar una actividad que ya tiene asistencias registradas?
                        </div>
                        <div class="faq-answer">
                            No. El sistema impide eliminar actividades con asistencias registradas para proteger la integridad de los datos. 
                            Si necesitas "ocultar" una actividad, puedes cambiar su estado a "Cerrada". Si realmente necesitas eliminarla, 
                            primero deberías eliminar manualmente todos los registros de asistencia (esto requiere acceso técnico a la base de datos).
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¿Qué pasa si registro asistencia de un curso pero no de los otros asociados a la actividad?
                        </div>
                        <div class="faq-answer">
                            No hay problema. Puedes registrar asistencia curso por curso en diferentes momentos. El sistema guarda cada 
                            registro de forma independiente. Sin embargo, recuerda que las estadísticas generales se calcularán con la 
                            información parcial hasta que completes todos los registros.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¿Cómo se calcula el porcentaje de asistencia de una familia?
                        </div>
                        <div class="faq-answer">
                            <strong>Fórmula:</strong> (Número de veces que asistió / Total de invitaciones) × 100
                            <br><br>
                            <strong>Ejemplo:</strong> Si una familia fue invitada a 10 actividades (porque tiene un hijo en un curso que 
                            fue invitado 10 veces) y asistió a 7, su porcentaje es: (7/10) × 100 = 70%
                            <br><br>
                            <strong>Nota:</strong> Si una familia tiene varios hijos en diferentes cursos, cada invitación cuenta de forma 
                            independiente por estudiante.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            En el Dashboard, ¿por qué no aparecen datos al abrir la pestaña?
                        </div>
                        <div class="faq-answer">
                            Por optimización, el sistema no carga datos automáticamente. Debes:
                            <ol>
                                <li>Configurar el rango de fechas (el sistema sugiere los últimos 30 días)</li>
                                <li>Opcionalmente, seleccionar un curso</li>
                                <li>Hacer clic en "Aplicar Filtros"</li>
                            </ol>
                            Esto evita consultas innecesarias y te permite definir exactamente qué período quieres analizar.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¿Qué significa "Familias Participantes" en las métricas?
                        </div>
                        <div class="faq-answer">
                            Es el número de familias únicas que asistieron al menos a una actividad en el período seleccionado. 
                            <br><br>
                            <strong>Ejemplo:</strong> Si tuviste 5 actividades y 50 invitaciones totales, pero solo 20 familias diferentes 
                            asistieron (algunas a múltiples actividades), el número de "Familias Participantes" será 20.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¿Puedo exportar los datos del Dashboard a Excel?
                        </div>
                        <div class="faq-answer">
                            Actualmente, el sistema no tiene función de exportación automática. Sin embargo, puedes:
                            <ul>
                                <li>Seleccionar las tablas con el mouse y copiar (Ctrl+C)</li>
                                <li>Pegar en Excel (Ctrl+V)</li>
                                <li>Tomar capturas de pantalla de las estadísticas</li>
                                <li>Anotar manualmente los datos más relevantes</li>
                            </ul>
                            Si necesitas exportación frecuente, considera reportarlo como sugerencia de mejora.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¿Qué hago con las familias que aparecen en "Menor Participación"?
                        </div>
                        <div class="faq-answer">
                            Este ranking es una herramienta de diagnóstico. Puedes:
                            <ol>
                                <li><strong>Contacto inicial:</strong> Llamar o enviar mensaje para entender las razones</li>
                                <li><strong>Identificar barreras:</strong> Horarios, trabajo, distancia, falta de información</li>
                                <li><strong>Ofrecer alternativas:</strong> Reuniones virtuales, horarios flexibles, materiales grabados</li>
                                <li><strong>Seguimiento personalizado:</strong> Asignar tutor o coordinador para acompañamiento</li>
                                <li><strong>Registrar acciones:</strong> Documentar estrategias aplicadas y resultados</li>
                            </ol>
                            Recuerda: Baja participación no significa desinterés. Puede haber circunstancias externas.
                        </div>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- SECCIÓN 6: CONSEJOS PARA DIRECTIVOS -->
                <!-- ============================================ -->
                <div class="manual-section">
                    <h3><i class="bi bi-lightbulb me-2"></i>Consejos Estratégicos para Directivos</h3>

                    <div class="info-box success">
                        <strong><i class="bi bi-calendar-check me-2"></i>Planificación anticipada:</strong>
                        <ul class="mb-0">
                            <li>Crea las actividades en el sistema al mismo tiempo que las planificas en el calendario institucional</li>
                            <li>Usa nombres descriptivos que incluyan período y tema (ej: "Taller de convivencia - Q2 - Primaria")</li>
                            <li>Programa actividades similares para todos los cursos el mismo día (facilita el registro)</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <strong><i class="bi bi-clipboard-check me-2"></i>Registro oportuno:</strong>
                        <ul class="mb-0">
                            <li>Establece como política institucional registrar asistencias dentro de las 48 horas siguientes</li>
                            <li>Asigna responsables específicos para el registro (coordinadores, docentes)</li>
                            <li>Revisa semanalmente las "Actividades sin registro" para evitar acumulación</li>
                        </ul>
                    </div>

                    <div class="info-box warning">
                        <strong><i class="bi bi-graph-up me-2"></i>Análisis periódico:</strong>
                        <ul class="mb-0">
                            <li>Revisa el Dashboard al menos una vez al mes</li>
                            <li>Compara estadísticas entre períodos (mes actual vs mes anterior, trimestre vs trimestre)</li>
                            <li>Identifica tendencias: ¿Baja la participación en ciertas épocas? ¿Ciertos cursos participan menos?</li>
                            <li>Usa los datos para ajustar horarios, formatos o tipos de actividades</li>
                        </ul>
                    </div>

                    <div class="info-box success">
                        <strong><i class="bi bi-trophy me-2"></i>Reconocimiento positivo:</strong>
                        <ul class="mb-0">
                            <li>Usa el ranking de "Mayor Participación" para reconocimientos públicos</li>
                            <li>Considera crear incentivos o menciones especiales para familias comprometidas</li>
                            <li>Comparte estadísticas generales positivas en comunicados (sin mencionar nombres de familias con baja participación)</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <strong><i class="bi bi-people me-2"></i>Acercamiento estratégico:</strong>
                        <ul class="mb-0">
                            <li>No uses el ranking de "Menor Participación" como herramienta punitiva</li>
                            <li>Investiga las causas antes de emitir juicios</li>
                            <li>Diseña estrategias diferenciadas según las barreras identificadas</li>
                            <li>Documenta el seguimiento de cada familia para evaluar efectividad</li>
                        </ul>
                    </div>

                    <div class="info-box warning">
                        <strong><i class="bi bi-bar-chart me-2"></i>Metas institucionales:</strong>
                        <ul class="mb-0">
                            <li>Establece metas realistas de participación (ej: "75% de asistencia promedio")</li>
                            <li>Comunica estas metas a la comunidad educativa</li>
                            <li>Haz seguimiento trimestral del cumplimiento</li>
                            <li>Ajusta estrategias si las metas no se están alcanzando</li>
                        </ul>
                    </div>
                </div>

                <!-- TARJETA PARA REPORTAR BUGS -->
                <div class="bug-report-card">
                    <i class="bi bi-bug-fill icon-large"></i>
                    <h4 class="mb-3">¿Encontraste un problema o tienes una sugerencia?</h4>
                    <p class="mb-4">
                        Si experimentaste un error, algo no funciona como esperas, o tienes 
                        una sugerencia para mejorar el sistema, repórtalo aquí.
                    </p>
                    <a href="../report-bug.html" class="btn btn-light btn-lg">
                        <i class="bi bi-exclamation-triangle me-2"></i>Reportar Bug o Problema
                    </a>
                </div>

            </div>
        </div>

    </div>

    <!-- BOTÓN FLOTANTE PARA REPORTAR BUGS -->
    <a href="../report-bug.html" class="btn btn-danger btn-lg floating-bug-button" title="Reportar Bug">
        <i class="bi bi-bug-fill me-2"></i>Reportar Bug
    </a>

    <!-- SCRIPTS - ORDEN CRÍTICO -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/js/config.js"></script>
    
    <script>
        // ==========================================
        // VARIABLES GLOBALES
        // ==========================================
        let currentUser = null;

        // ==========================================
        // CONFIGURACIÓN DE LA PÁGINA
        // ==========================================
        const PAGE_CONFIG = {
            moduleName: 'Herramientas Generales',
            modulePath: 'general-tools',
            pageTitle: 'Asistencia de Familias a Actividades',
            pagePath: 'family-activities.html',
            moduleDescription: 'Gestión de actividades escolares y registro de participación familiar'
        };

        // ==========================================
        // INICIALIZACIÓN
        // ==========================================
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('📖 Iniciando página de manual...');
            
            try {
                // Verificar si existe la función de colores corporativos
                if (typeof loadAndApplyBrandColors === 'function') {
                    await loadAndApplyBrandColors();
                }
                
                // Verificar sesión si la función existe
                if (typeof getStoredSession === 'function') {
                    const session = getStoredSession();
                    if (session && session.user) {
                        currentUser = session.user;
                    }
                }
                
                // Actualizar información en la página
                updatePageInfo();
                
                console.log('✅ Página de manual lista');
                
            } catch (error) {
                console.error('❌ Error inicializando página:', error);
                if (typeof showMessage === 'function') {
                    showMessage('Error al cargar la página: ' + error.message, 'danger');
                }
            }
        });

        // ==========================================
        // ACTUALIZAR INFORMACIÓN DE LA PÁGINA
        // ==========================================
        function updatePageInfo() {
            // Actualizar title
            document.title = `Manual - ${PAGE_CONFIG.moduleName} - ${PAGE_CONFIG.pageTitle} - SchoolNet`;
        }

        // ==========================================
        // UTILIDADES DE LOADING
        // ==========================================
        function showLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.remove('hidden');
            }
        }

        function hideLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.add('hidden');
            }
        }

        // ==========================================
        // FUNCIÓN DE MENSAJES
        // ==========================================
        function showMessage(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            if (!alertContainer) return;
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertContainer.appendChild(alertDiv);
            
            // Auto-remove después de 5 segundos
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

    </script>
</body>
</html>
