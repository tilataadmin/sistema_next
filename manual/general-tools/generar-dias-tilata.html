<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- VERSI√ìN DE LA P√ÅGINA -->
    <meta name="page-version" content="26.01.26.07.21">
    
    <title>Manual - Herramientas Generales - Generar D√≠as Tilat√° - SchoolNet</title>
    
    <!-- Bootstrap CSS - VERSI√ìN FIJA PROBADA -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-overlay.hidden {
            display: none;
        }
        
        .loading-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Encabezado discreto */
        .manual-header {
            background: #f8f9fa;
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding: 1.5rem 0;
            margin-bottom: 2rem;
        }

        .manual-header h1 {
            font-size: 1.75rem;
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 0.25rem;
        }

        .manual-header .subtitle {
            color: #6c757d;
            font-size: 0.95rem;
        }

        /* Info card */
        .info-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Tarjeta para reportar bugs - CON COLOR PRIMARIO */
        .bug-report-card {
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .bug-report-card h5 {
            color: white;
        }

        .bug-report-card .btn-light {
            background: white;
            color: var(--system-primary-color, #1B365D);
            border: none;
            font-weight: 600;
        }

        .bug-report-card .btn-light:hover {
            background: #f8f9fa;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        /* Bot√≥n flotante para reportar bugs */
        .floating-bug-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            background: var(--system-primary-color, #dc3545) !important;
            border-color: var(--system-primary-color, #dc3545) !important;
            color: white !important;
        }

        .floating-bug-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
            opacity: 0.9;
        }

        .icon-large {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        /* Estilos para el contenido del manual */
        .manual-section {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .manual-section h3 {
            color: var(--system-primary-color, #1B365D);
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
        }

        .manual-section h4 {
            color: var(--system-primary-color, #1B365D);
            font-size: 1.25rem;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }

        .info-box {
            background: #e7f3ff;
            border-left: 4px solid var(--system-secondary-color, #667eea);
            padding: 1rem 1.25rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .info-box.warning {
            background: #fff3cd;
            border-left-color: var(--system-tertiary-color, #ffc107);
        }

        .info-box.success {
            background: #d1e7dd;
            border-left-color: #28a745;
        }

        .info-box.danger {
            background: #f8d7da;
            border-left-color: #dc3545;
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 0.75rem;
        }

        .feature-list {
            list-style: none;
            padding-left: 0;
        }

        .feature-list li {
            padding: 0.5rem 0;
            padding-left: 2rem;
            position: relative;
        }

        .feature-list li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: var(--system-primary-color, #1B365D);
            font-weight: bold;
            font-size: 1.2rem;
        }

        .use-case {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 1rem;
            margin: 0.5rem 0;
        }

        .use-case strong {
            color: var(--system-primary-color, #1B365D);
        }

        .faq-item {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .faq-question {
            color: var(--system-primary-color, #1B365D);
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 0.75rem;
        }

        .faq-answer {
            color: #495057;
            line-height: 1.6;
        }

        .concept-box {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .example-timeline {
            background: #f8f9fa;
            border-left: 3px solid var(--system-primary-color, #1B365D);
            padding: 1rem;
            margin: 1rem 0;
            font-family: monospace;
            font-size: 0.9rem;
        }
    </style>
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="mb-0">Cargando...</p>
        </div>
    </div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="container-fluid">

        <!-- ENCABEZADO DISCRETO -->
        <div class="manual-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1>
                            <i class="bi bi-book me-2"></i>
                            Manual: Generar D√≠as Tilat√°
                        </h1>
                        <p class="subtitle mb-0">Herramientas Generales - Generaci√≥n autom√°tica del ciclo acad√©mico en calendario institucional</p>
                    </div>
                    <div class="col-md-4 text-md-end mt-3 mt-md-0">
                        <a href="../../modules/general-tools/generar-dias-tilata.html" class="btn btn-outline-primary">
                            <i class="bi bi-arrow-left me-1"></i>Volver al M√≥dulo
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- CONTENEDOR DE ALERTAS -->
        <div id="alertContainer"></div>

        <div class="row">
            <div class="col-lg-10 mx-auto">

                <!-- INFORMACI√ìN CONTEXTUAL -->
                <div class="info-card">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h6 class="text-muted mb-2">Manual de:</h6>
                            <h5 class="mb-1"><strong id="display-module">Herramientas Generales</strong></h5>
                            <p class="text-muted mb-0 small" id="display-page">Generar D√≠as Tilat√°</p>
                        </div>
                        <div class="col-md-6 text-md-end mt-3 mt-md-0">
                            <p class="small text-muted mb-0">
                                <i class="bi bi-info-circle me-1"></i>
                                Si tienes dudas o encuentras alg√∫n problema,<br>
                                puedes reportarlo usando el bot√≥n de abajo.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- SECCI√ìN 1: ¬øQU√â SON LOS D√çAS TILAT√Å? -->
                <!-- ============================================ -->
                <div class="manual-section">
                    <h3><i class="bi bi-info-circle me-2"></i>¬øQu√© son los D√≠as Tilat√°?</h3>
                    
                    <div class="concept-box">
                        <h5><i class="bi bi-calendar-week me-2"></i>Concepto</h5>
                        <p>
                            Los <strong>"D√≠as Tilat√°"</strong> son un sistema de numeraci√≥n secuencial de los d√≠as 
                            laborables del a√±o acad√©mico, excluyendo fines de semana, festivos, recesos y d√≠as 
                            pedag√≥gicos. Este sistema permite a la instituci√≥n organizar actividades recurrentes en 
                            ciclos predecibles.
                        </p>
                    </div>

                    <h4>¬øC√≥mo funciona?</h4>
                    <p>Imagina que el a√±o escolar tiene 180 d√≠as laborables. En lugar de usar fechas fijas, el sistema numera:</p>
                    <ul>
                        <li><strong>D√≠a 1:</strong> Primer d√≠a de clases</li>
                        <li><strong>D√≠a 2:</strong> Segundo d√≠a laboral (puede ser al d√≠a siguiente o despu√©s de un fin de semana)</li>
                        <li><strong>D√≠a 3, 4, 5...</strong> Y as√≠ sucesivamente hasta el √∫ltimo d√≠a de clases</li>
                    </ul>

                    <div class="example-timeline">
                        <strong>Ejemplo visual:</strong><br>
                        Lunes 5 feb ‚Üí D√≠a 1<br>
                        Martes 6 feb ‚Üí D√≠a 2<br>
                        Mi√©rcoles 7 feb ‚Üí D√≠a 3<br>
                        Jueves 8 feb ‚Üí D√≠a 4<br>
                        Viernes 9 feb ‚Üí D√≠a 5<br>
                        <em>(S√°bado-Domingo: NO cuentan)</em><br>
                        Lunes 12 feb ‚Üí D√≠a 6<br>
                        Martes 13 feb ‚Üí D√≠a 7<br>
                        ...
                    </div>

                    <h4>¬øQu√© son los Ciclos?</h4>
                    <p>
                        Los <strong>ciclos</strong> son agrupaciones de N d√≠as. Por ejemplo, si se configuran ciclos de 6 d√≠as:
                    </p>
                    <ul>
                        <li><strong>Ciclo 1:</strong> D√≠as 1-6</li>
                        <li><strong>Ciclo 2:</strong> D√≠as 7-12</li>
                        <li><strong>Ciclo 3:</strong> D√≠as 13-18</li>
                        <li>Y as√≠ sucesivamente...</li>
                    </ul>

                    <div class="info-box">
                        <strong><i class="bi bi-lightbulb me-2"></i>Para qu√© sirve:</strong>
                        <p class="mb-0">
                            Este sistema permite programar horarios rotativos, actividades especiales cada cierto n√∫mero 
                            de d√≠as, o cualquier evento que deba repetirse en un ciclo fijo independientemente de las 
                            fechas del calendario gregoriano.
                        </p>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- SECCI√ìN 2: ¬øQU√â HACE ESTE M√ìDULO? -->
                <!-- ============================================ -->
                <div class="manual-section">
                    <h3><i class="bi bi-gear me-2"></i>¬øQu√© hace el M√≥dulo "Generar D√≠as Tilat√°"?</h3>
                    
                    <p>
                        Este m√≥dulo automatiza completamente la creaci√≥n de eventos de d√≠as Tilat√° en el 
                        <strong>Google Calendar institucional</strong>. Sin este m√≥dulo, tendr√≠as que crear 
                        manualmente cientos de eventos.
                    </p>

                    <h4>Funciones principales:</h4>
                    <ul class="feature-list">
                        <li><strong>C√°lculo autom√°tico:</strong> Determina qu√© d√≠as son laborables y cu√°les no</li>
                        <li><strong>Exclusiones inteligentes:</strong> Omite fines de semana, festivos, recesos y d√≠as pedag√≥gicos</li>
                        <li><strong>Creaci√≥n masiva:</strong> Genera eventos "D√≠a 1", "D√≠a 2"... "D√≠a N" autom√°ticamente</li>
                        <li><strong>Ciclos autom√°ticos:</strong> Crea eventos "Ciclo 1", "Ciclo 2"... seg√∫n configuraci√≥n</li>
                        <li><strong>Sincronizaci√≥n con Google:</strong> Publica directamente en el calendario institucional</li>
                        <li><strong>Limpieza previa:</strong> Elimina eventos antiguos antes de crear nuevos</li>
                    </ul>

                    <h4>¬øQu√© informaci√≥n usa?</h4>
                    <p>El m√≥dulo obtiene autom√°ticamente:</p>
                    <ul>
                        <li>A√±o acad√©mico actual configurado en el sistema</li>
                        <li>Fecha de inicio de clases</li>
                        <li>Fecha de fin de clases</li>
                        <li>N√∫mero de d√≠as por ciclo</li>
                        <li>ID del calendario de Google institucional</li>
                        <li>Festivos configurados en el sistema</li>
                        <li>Recesos acad√©micos configurados</li>
                        <li>D√≠as pedag√≥gicos registrados</li>
                    </ul>

                    <div class="info-box warning">
                        <strong><i class="bi bi-exclamation-triangle me-2"></i>Prerequisitos importantes:</strong>
                        <p class="mb-0">
                            Antes de usar este m√≥dulo, aseg√∫rate de que est√©n correctamente configurados en el sistema:
                        </p>
                        <ul class="mt-2 mb-0">
                            <li>El a√±o acad√©mico actual con fechas de inicio y fin de clases</li>
                            <li>Todos los festivos del a√±o</li>
                            <li>Los recesos acad√©micos (vacaciones intermedias, semana santa, etc.)</li>
                            <li>Los d√≠as pedag√≥gicos planificados</li>
                            <li>El Calendar ID del Google Calendar institucional</li>
                        </ul>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- SECCI√ìN 3: C√ìMO USAR EL M√ìDULO -->
                <!-- ============================================ -->
                <div class="manual-section">
                    <h3><i class="bi bi-play-circle me-2"></i>C√≥mo Usar el M√≥dulo</h3>

                    <h4>Paso a Paso:</h4>

                    <div class="card mb-3">
                        <div class="card-body">
                            <h5><span class="step-number">1</span>Verifica la Informaci√≥n del A√±o Acad√©mico</h5>
                            <p>Al abrir el m√≥dulo, ver√°s una tarjeta con:</p>
                            <ul>
                                <li><strong>A√±o Acad√©mico:</strong> Nombre del a√±o activo (ej: "2025")</li>
                                <li><strong>Inicio de Clases:</strong> Primera fecha laboral</li>
                                <li><strong>Fin de Clases:</strong> √öltima fecha laboral</li>
                                <li><strong>Ciclos (d√≠as):</strong> D√≠as por ciclo (normalmente 6)</li>
                                <li><strong>Calendar ID:</strong> Identificador del calendario de Google</li>
                            </ul>
                            <p class="mb-0">
                                <strong>Importante:</strong> Si alguna fecha muestra "No configurado" o hay una alerta amarilla, 
                                debes configurar esa informaci√≥n antes de continuar.
                            </p>
                        </div>
                    </div>

                    <div class="card mb-3">
                        <div class="card-body">
                            <h5><span class="step-number">2</span>Lee las Advertencias</h5>
                            <p>Ver√°s dos cuadros informativos:</p>
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="text-primary">¬øQu√© hace esta funci√≥n?</h6>
                                    <ul class="small">
                                        <li>Calcula los d√≠as laborables</li>
                                        <li>Excluye no laborables</li>
                                        <li>Crea eventos de d√≠as</li>
                                        <li>Crea eventos de ciclos</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="text-warning">Importante</h6>
                                    <ul class="small">
                                        <li>Eliminar√° eventos existentes</li>
                                        <li>Requiere exclusiones configuradas</li>
                                        <li>Puede tardar minutos</li>
                                        <li>No cerrar hasta terminar</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card mb-3">
                        <div class="card-body">
                            <h5><span class="step-number">3</span>Haz Clic en "Generar D√≠as Tilat√°"</h5>
                            <p>Encontrar√°s un bot√≥n azul grande en el centro de la pantalla.</p>
                            <div class="info-box">
                                <strong>Al hacer clic:</strong>
                                <ul class="mb-0">
                                    <li>Se te pedir√° confirmaci√≥n (popup del navegador)</li>
                                    <li>El bot√≥n cambiar√° a "Procesando..." con spinner</li>
                                    <li>Aparecer√° el panel "Registro de Ejecuci√≥n"</li>
                                    <li>Ver√°s mensajes en tiempo real del progreso</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="card mb-3">
                        <div class="card-body">
                            <h5><span class="step-number">4</span>Observa el Registro de Ejecuci√≥n</h5>
                            <p>Mientras el proceso corre, ver√°s mensajes como:</p>
                            <div class="example-timeline">
                                [14:23:15] Iniciando proceso de generaci√≥n de D√≠as Tilat√°...<br>
                                [14:23:16] üîó Conectando con el script de Google...<br>
                                [14:23:17] üì° Ejecutando procesamiento en Google Apps Script...<br>
                                [14:23:18] ‚è≥ Este proceso puede tardar varios minutos, por favor espera...<br>
                                [14:25:42] ‚úÖ Respuesta recibida del servidor<br>
                                [14:25:42] ‚úÖ Proceso completado exitosamente<br>
                                [14:25:42] üìä Total d√≠as laborables: 180<br>
                                [14:25:42] üîÑ D√≠as por ciclo: 6<br>
                                [14:25:42] üìÖ Eventos creados en calendario: 210
                            </div>
                            <p class="mb-0 mt-3">
                                <strong>Colores del log:</strong>
                            </p>
                            <ul class="mb-0">
                                <li><span class="text-success">Verde:</span> √âxito o confirmaci√≥n</li>
                                <li><span class="text-muted">Gris:</span> Informaci√≥n general</li>
                                <li><span class="text-danger">Rojo:</span> Error</li>
                            </ul>
                        </div>
                    </div>

                    <div class="card mb-3">
                        <div class="card-body">
                            <h5><span class="step-number">5</span>Espera la Confirmaci√≥n Final</h5>
                            <p>Cuando el proceso termine correctamente, ver√°s:</p>
                            <ul>
                                <li>Mensaje verde de √©xito en la parte superior</li>
                                <li>Estad√≠sticas finales en el log (d√≠as laborables, ciclos, eventos creados)</li>
                                <li>El bot√≥n vuelve a estar disponible</li>
                            </ul>
                            <p class="mb-0">
                                <strong>Ya puedes cerrar la p√°gina.</strong> Los eventos est√°n ahora en el calendario institucional.
                            </p>
                        </div>
                    </div>

                    <div class="info-box danger">
                        <strong><i class="bi bi-x-octagon me-2"></i>NO CIERRES LA VENTANA mientras el proceso est√© corriendo</strong>
                        <p class="mb-0">
                            Si cierras el navegador o la pesta√±a a mitad del proceso, la generaci√≥n se interrumpir√° 
                            y es posible que queden eventos incompletos en el calendario. Tendr√≠as que ejecutar el 
                            proceso nuevamente desde cero.
                        </p>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- SECCI√ìN 4: ¬øQU√â HACE T√âCNICAMENTE? -->
                <!-- ============================================ -->
                <div class="manual-section">
                    <h3><i class="bi bi-cpu me-2"></i>¬øQu√© Hace el Sistema T√©cnicamente?</h3>
                    
                    <p>Detr√°s del bot√≥n "Generar D√≠as Tilat√°", ocurre un proceso complejo:</p>

                    <h4>1. Preparaci√≥n (en SchoolNet)</h4>
                    <ul>
                        <li>El sistema lee el a√±o acad√©mico actual de la base de datos</li>
                        <li>Obtiene las fechas de inicio y fin de clases</li>
                        <li>Obtiene el n√∫mero de d√≠as por ciclo</li>
                        <li>Obtiene el Calendar ID del calendario institucional</li>
                        <li>Valida que toda la informaci√≥n est√© completa</li>
                    </ul>

                    <h4>2. Ejecuci√≥n (en Google Apps Script)</h4>
                    <p>Al hacer clic, SchoolNet llama a un script en Google que:</p>
                    <ol>
                        <li><strong>Conecta con la base de datos:</strong> Lee festivos, recesos y d√≠as pedag√≥gicos</li>
                        <li><strong>Conecta con Google Calendar:</strong> Busca eventos existentes de d√≠as Tilat√°</li>
                        <li><strong>Elimina eventos antiguos:</strong> Borra todos los eventos "D√≠a X" y "Ciclo X" previos</li>
                        <li><strong>Calcula d√≠as laborables:</strong>
                            <ul>
                                <li>Itera desde la fecha de inicio hasta la de fin</li>
                                <li>Por cada d√≠a, verifica si es:
                                    <ul>
                                        <li>Fin de semana ‚Üí Omitir</li>
                                        <li>Festivo ‚Üí Omitir</li>
                                        <li>En receso ‚Üí Omitir</li>
                                        <li>D√≠a pedag√≥gico ‚Üí Omitir</li>
                                        <li>Laboral ‚Üí Contar</li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li><strong>Crea eventos de d√≠as:</strong> Para cada d√≠a laboral, crea evento "D√≠a N" en el calendario</li>
                        <li><strong>Crea eventos de ciclos:</strong> Cada X d√≠as (seg√∫n configuraci√≥n), crea evento "Ciclo N"</li>
                        <li><strong>Retorna resultado:</strong> Env√≠a estad√≠sticas a SchoolNet para mostrar en pantalla</li>
                    </ol>

                    <h4>3. Confirmaci√≥n (en SchoolNet)</h4>
                    <ul>
                        <li>Recibe la respuesta del script</li>
                        <li>Muestra el resultado en el log de ejecuci√≥n</li>
                        <li>Notifica al usuario con mensaje de √©xito o error</li>
                    </ul>

                    <div class="info-box">
                        <strong><i class="bi bi-clock me-2"></i>¬øPor qu√© tarda varios minutos?</strong>
                        <p class="mb-0">
                            Un a√±o acad√©mico t√≠pico tiene ~180 d√≠as laborables. El script debe:
                        </p>
                        <ul class="mt-2 mb-0">
                            <li>Consultar la base de datos m√∫ltiples veces</li>
                            <li>Eliminar eventos existentes (puede ser ~200 eventos)</li>
                            <li>Crear nuevos eventos uno por uno en Google Calendar</li>
                            <li>Google Calendar tiene l√≠mites de tasa (rate limits) que ralentizan el proceso</li>
                        </ul>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- SECCI√ìN 5: CASOS DE USO Y EJEMPLOS -->
                <!-- ============================================ -->
                <div class="manual-section">
                    <h3><i class="bi bi-journal-check me-2"></i>Casos de Uso Comunes</h3>

                    <div class="use-case">
                        <strong>Caso 1: "Inicio de a√±o acad√©mico"</strong>
                        <p class="mb-1 mt-2">Situaci√≥n:</p>
                        <p class="mb-1">Es enero y el nuevo a√±o escolar comienza en febrero. Necesitas preparar el calendario.</p>
                        <p class="mb-1 mt-2">Soluci√≥n:</p>
                        <ol class="mb-0">
                            <li>Configura el a√±o acad√©mico con fechas de inicio/fin de clases</li>
                            <li>Registra todos los festivos del a√±o en el sistema</li>
                            <li>Configura los recesos (vacaciones de mitad de a√±o, semana santa, etc.)</li>
                            <li>Registra d√≠as pedag√≥gicos planificados</li>
                            <li>Ve a "Generar D√≠as Tilat√°" y ejecuta el proceso</li>
                            <li>En minutos, todo el calendario del a√±o estar√° listo</li>
                        </ol>
                    </div>

                    <div class="use-case">
                        <strong>Caso 2: "Correcci√≥n de fechas"</strong>
                        <p class="mb-1 mt-2">Situaci√≥n:</p>
                        <p class="mb-1">Ya generaste los d√≠as, pero te das cuenta que olvidaste registrar un festivo importante.</p>
                        <p class="mb-1 mt-2">Soluci√≥n:</p>
                        <ol class="mb-0">
                            <li>Registra el festivo olvidado en el sistema</li>
                            <li>Ve a "Generar D√≠as Tilat√°"</li>
                            <li>Ejecuta nuevamente el proceso</li>
                            <li>El sistema eliminar√° los eventos antiguos y regenerar√° todo correctamente</li>
                            <li>Los d√≠as se reajustar√°n autom√°ticamente excluyendo el nuevo festivo</li>
                        </ol>
                    </div>

                    <div class="use-case">
                        <strong>Caso 3: "Cambio en el calendario acad√©mico"</strong>
                        <p class="mb-1 mt-2">Situaci√≥n:</p>
                        <p class="mb-1">A mitad de a√±o, la direcci√≥n decide extender las clases una semana m√°s.</p>
                        <p class="mb-1 mt-2">Soluci√≥n:</p>
                        <ol class="mb-0">
                            <li>Modifica la fecha de fin de clases en el a√±o acad√©mico</li>
                            <li>Ve a "Generar D√≠as Tilat√°"</li>
                            <li>Ejecuta el proceso</li>
                            <li>Los d√≠as se regenerar√°n incluyendo la semana adicional</li>
                        </ol>
                    </div>

                    <div class="use-case">
                        <strong>Caso 4: "Verificaci√≥n antes de publicar horarios"</strong>
                        <p class="mb-1 mt-2">Situaci√≥n:</p>
                        <p class="mb-1">Vas a publicar horarios que dependen de los ciclos, quieres asegurarte que est√©n correctos.</p>
                        <p class="mb-1 mt-2">Soluci√≥n:</p>
                        <ol class="mb-0">
                            <li>Abre Google Calendar institucional</li>
                            <li>Busca eventos "D√≠a" y "Ciclo"</li>
                            <li>Verifica que los primeros d√≠as coincidan con las fechas esperadas</li>
                            <li>Confirma que los ciclos se repitan en el intervalo correcto</li>
                            <li>Si hay errores, corrige la configuraci√≥n y regenera</li>
                        </ol>
                    </div>

                    <div class="use-case">
                        <strong>Caso 5: "D√≠as pedag√≥gicos adicionales"</strong>
                        <p class="mb-1 mt-2">Situaci√≥n:</p>
                        <p class="mb-1">Se programan d√≠as pedag√≥gicos emergentes que no estaban en el calendario original.</p>
                        <p class="mb-1 mt-2">Soluci√≥n:</p>
                        <ol class="mb-0">
                            <li>Registra los nuevos d√≠as pedag√≥gicos en el sistema</li>
                            <li>Ve a "Generar D√≠as Tilat√°" y regenera</li>
                            <li>Los d√≠as se recalcular√°n omitiendo esas fechas</li>
                            <li>IMPORTANTE: Los n√∫meros de d√≠a cambiar√°n hacia adelante</li>
                            <li>Comunica los cambios a docentes y estudiantes</li>
                        </ol>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- SECCI√ìN 6: PREGUNTAS FRECUENTES -->
                <!-- ============================================ -->
                <div class="manual-section">
                    <h3><i class="bi bi-question-circle me-2"></i>Preguntas Frecuentes</h3>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¬øCon qu√© frecuencia debo ejecutar este proceso?
                        </div>
                        <div class="faq-answer">
                            <strong>Normalmente una sola vez al inicio del a√±o acad√©mico.</strong> Solo necesitas 
                            regenerar si:
                            <ul>
                                <li>Cambias fechas de inicio/fin de clases</li>
                                <li>Agregas o modificas festivos</li>
                                <li>Cambias recesos acad√©micos</li>
                                <li>Modificas d√≠as pedag√≥gicos</li>
                            </ul>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¬øQu√© pasa con los eventos que hab√≠a creado antes?
                        </div>
                        <div class="faq-answer">
                            El sistema elimina TODOS los eventos previos que tengan en su t√≠tulo "D√≠a" o "Ciclo" antes 
                            de crear los nuevos. Esto garantiza que no haya duplicados ni eventos obsoletos. Si ten√≠as 
                            otros eventos personalizados con esas palabras en el t√≠tulo, tambi√©n se eliminar√°n.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¬øEl proceso afecta otros eventos del calendario?
                        </div>
                        <div class="faq-answer">
                            No. Solo elimina y crea eventos relacionados con d√≠as Tilat√°. Eventos de reuniones, actividades 
                            especiales, cumplea√±os, o cualquier otro tipo de evento no se ven afectados.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¬øQu√© hago si el proceso falla o se detiene?
                        </div>
                        <div class="faq-answer">
                            Si ves mensajes rojos en el log o el proceso se detiene:
                            <ol>
                                <li>Lee el mensaje de error (suele indicar qu√© fall√≥)</li>
                                <li>Verifica que la configuraci√≥n sea correcta (fechas, Calendar ID)</li>
                                <li>Espera 5 minutos y vuelve a intentar</li>
                                <li>Si persiste el error, contacta soporte t√©cnico con el mensaje exacto del log</li>
                            </ol>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¬øPuedo ver los eventos creados en Google Calendar?
                        </div>
                        <div class="faq-answer">
                            S√≠. Abre Google Calendar con la cuenta institucional y busca el calendario configurado. 
                            Ver√°s eventos como:
                            <ul>
                                <li>"D√≠a 1" en la primera fecha laboral</li>
                                <li>"D√≠a 2" en la segunda, etc.</li>
                                <li>"Ciclo 1" marcando el inicio del primer ciclo</li>
                                <li>"Ciclo 2" despu√©s de N d√≠as, etc.</li>
                            </ul>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¬øQu√© es el "Calendar ID" y d√≥nde lo encuentro?
                        </div>
                        <div class="faq-answer">
                            El Calendar ID es un identificador √∫nico de tu calendario institucional de Google. 
                            Normalmente tiene formato como: <code>xxxxx@group.calendar.google.com</code>
                            <br><br>
                            Para encontrarlo:
                            <ol>
                                <li>Abre Google Calendar</li>
                                <li>En la lista de calendarios, haz clic en "‚ãÆ" (tres puntos) del calendario deseado</li>
                                <li>Selecciona "Configuraci√≥n y compartir"</li>
                                <li>Baja hasta "Integrar calendario"</li>
                                <li>El ID del calendario est√° en esa secci√≥n</li>
                            </ol>
                            Este ID debe estar configurado en el sistema antes de usar este m√≥dulo.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¬øPuedo cambiar el n√∫mero de d√≠as por ciclo despu√©s de generar?
                        </div>
                        <div class="faq-answer">
                            S√≠, pero tendr√°s que regenerar completamente. Los pasos ser√≠an:
                            <ol>
                                <li>Modifica el campo "cycles" en el a√±o acad√©mico</li>
                                <li>Ejecuta nuevamente "Generar D√≠as Tilat√°"</li>
                                <li>Los ciclos se redistribuir√°n con el nuevo valor</li>
                            </ol>
                            <strong>Cuidado:</strong> Si ya publicaste horarios basados en los ciclos anteriores, 
                            este cambio los desincronizar√°.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¬øCu√°nto tarda normalmente el proceso?
                        </div>
                        <div class="faq-answer">
                            Depende del n√∫mero de d√≠as laborables y la velocidad de respuesta de Google Calendar, pero 
                            t√≠picamente:
                            <ul>
                                <li><strong>A√±o completo (~180 d√≠as):</strong> 2-4 minutos</li>
                                <li><strong>Semestre (~90 d√≠as):</strong> 1-2 minutos</li>
                            </ul>
                            Si tarda m√°s de 10 minutos, probablemente hay un problema t√©cnico.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-question-circle-fill me-2"></i>
                            ¬øLos eventos se crean como "todo el d√≠a" o con hora espec√≠fica?
                        </div>
                        <div class="faq-answer">
                            Se crean como eventos de <strong>todo el d√≠a</strong>. Esto tiene sentido porque un "D√≠a Tilat√°" 
                            no es un horario espec√≠fico sino una etiqueta para todo ese d√≠a laboral.
                        </div>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- SECCI√ìN 7: SOLUCI√ìN DE PROBLEMAS -->
                <!-- ============================================ -->
                <div class="manual-section">
                    <h3><i class="bi bi-tools me-2"></i>Soluci√≥n de Problemas Comunes</h3>

                    <h4>Problema 1: "No se ha configurado el Calendar ID"</h4>
                    <p><strong>S√≠ntoma:</strong> Mensaje de error al intentar generar</p>
                    <p><strong>Causa:</strong> Falta configurar el Calendar ID del calendario institucional</p>
                    <p><strong>Soluci√≥n:</strong></p>
                    <ol>
                        <li>Ve a la configuraci√≥n del sistema</li>
                        <li>Busca el campo "Calendar ID"</li>
                        <li>Ingresa el ID del calendario de Google (formato: xxxxx@group.calendar.google.com)</li>
                        <li>Guarda y vuelve a intentar</li>
                    </ol>

                    <h4>Problema 2: "Faltan configurar las fechas de inicio y/o fin de clases"</h4>
                    <p><strong>S√≠ntoma:</strong> Alerta amarilla en la tarjeta de informaci√≥n del a√±o acad√©mico</p>
                    <p><strong>Causa:</strong> El a√±o acad√©mico actual no tiene fechas definidas</p>
                    <p><strong>Soluci√≥n:</strong></p>
                    <ol>
                        <li>Ve al m√≥dulo de gesti√≥n de a√±os acad√©micos</li>
                        <li>Edita el a√±o acad√©mico actual</li>
                        <li>Completa los campos "Inicio de clases" y "Fin de clases"</li>
                        <li>Guarda y regresa a este m√≥dulo</li>
                    </ol>

                    <h4>Problema 3: "Error HTTP: 401 - Unauthorized"</h4>
                    <p><strong>S√≠ntoma:</strong> Mensaje rojo en el log con c√≥digo 401</p>
                    <p><strong>Causa:</strong> El script de Google Apps Script no tiene permisos o no est√° autorizado</p>
                    <p><strong>Soluci√≥n:</strong></p>
                    <ol>
                        <li>Contacta al administrador t√©cnico del sistema</li>
                        <li>Verifica que el script de GAS est√© desplegado correctamente</li>
                        <li>Aseg√∫rate que el script tenga permisos de acceso al calendario</li>
                    </ol>

                    <h4>Problema 4: El proceso se queda "colgado" en un mensaje</h4>
                    <p><strong>S√≠ntoma:</strong> El √∫ltimo mensaje en el log es "Ejecutando procesamiento..." y no avanza</p>
                    <p><strong>Causa:</strong> Problema de conexi√≥n o el script de Google est√° tardando demasiado</p>
                    <p><strong>Soluci√≥n:</strong></p>
                    <ol>
                        <li>Espera al menos 10 minutos antes de actuar</li>
                        <li>Si despu√©s de 10 minutos no cambia, refresca la p√°gina</li>
                        <li>Verifica en Google Calendar si se crearon eventos parcialmente</li>
                        <li>Ejecuta el proceso nuevamente (limpiar√° eventos parciales)</li>
                    </ol>

                    <h4>Problema 5: Los d√≠as no coinciden con las fechas que esperaba</h4>
                    <p><strong>S√≠ntoma:</strong> "D√≠a 1" aparece en una fecha incorrecta</p>
                    <p><strong>Causa:</strong> Festivos, recesos o d√≠as pedag√≥gicos mal configurados</p>
                    <p><strong>Soluci√≥n:</strong></p>
                    <ol>
                        <li>Revisa en el sistema todos los festivos registrados</li>
                        <li>Verifica que los recesos acad√©micos est√©n correctos</li>
                        <li>Confirma que los d√≠as pedag√≥gicos sean los planificados</li>
                        <li>Corrige cualquier error y regenera los d√≠as</li>
                    </ol>
                </div>

                <!-- ============================================ -->
                <!-- SECCI√ìN 8: CONSEJOS PARA DIRECTIVOS -->
                <!-- ============================================ -->
                <div class="manual-section">
                    <h3><i class="bi bi-lightbulb me-2"></i>Consejos Estrat√©gicos para Directivos</h3>

                    <div class="info-box success">
                        <strong><i class="bi bi-calendar-check me-2"></i>Planificaci√≥n anticipada:</strong>
                        <ul class="mb-0 mt-2">
                            <li>Genera los d√≠as Tilat√° ANTES de publicar horarios o calendarios</li>
                            <li>Esto evita tener que hacer correcciones despu√©s</li>
                            <li>Coordina con acad√©mica para tener todas las fechas claras</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <strong><i class="bi bi-check2-square me-2"></i>Validaci√≥n post-generaci√≥n:</strong>
                        <ul class="mb-0 mt-2">
                            <li>Despu√©s de generar, revisa manualmente los primeros 10 d√≠as en Google Calendar</li>
                            <li>Confirma que coincidan con tus expectativas</li>
                            <li>Verifica que los ciclos se repitan correctamente</li>
                        </ul>
                    </div>

                    <div class="info-box warning">
                        <strong><i class="bi bi-people me-2"></i>Comunicaci√≥n institucional:</strong>
                        <ul class="mb-0 mt-2">
                            <li>Explica a docentes qu√© son los d√≠as Tilat√° y para qu√© sirven</li>
                            <li>Publica el calendario con los d√≠as numerados</li>
                            <li>Mant√©n copias de respaldo del calendario antes de regenerar</li>
                        </ul>
                    </div>

                    <div class="info-box success">
                        <strong><i class="bi bi-shield-check me-2"></i>Control de acceso:</strong>
                        <ul class="mb-0 mt-2">
                            <li>Solo personas autorizadas deber√≠an usar este m√≥dulo</li>
                            <li>Una regeneraci√≥n accidental puede causar confusi√≥n institucional</li>
                            <li>Documenta qui√©n y cu√°ndo se ejecut√≥ el proceso</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <strong><i class="bi bi-archive me-2"></i>Documentaci√≥n hist√≥rica:</strong>
                        <ul class="mb-0 mt-2">
                            <li>Guarda capturas de pantalla del log de ejecuci√≥n exitoso</li>
                            <li>Anota en documentos institucionales las fechas de generaci√≥n</li>
                            <li>Esto ayuda a resolver dudas futuras sobre el calendario</li>
                        </ul>
                    </div>
                </div>

                <!-- TARJETA PARA REPORTAR BUGS -->
                <div class="bug-report-card">
                    <i class="bi bi-bug-fill icon-large"></i>
                    <h4 class="mb-3">¬øEncontraste un problema o tienes una sugerencia?</h4>
                    <p class="mb-4">
                        Si experimentaste un error, algo no funciona como esperas, o tienes 
                        una sugerencia para mejorar el sistema, rep√≥rtalo aqu√≠.
                    </p>
                    <a href="../report-bug.html" class="btn btn-light btn-lg">
                        <i class="bi bi-exclamation-triangle me-2"></i>Reportar Bug o Problema
                    </a>
                </div>

            </div>
        </div>

    </div>

    <!-- BOT√ìN FLOTANTE PARA REPORTAR BUGS -->
    <a href="../report-bug.html" class="btn btn-danger btn-lg floating-bug-button" title="Reportar Bug">
        <i class="bi bi-bug-fill me-2"></i>Reportar Bug
    </a>

    <!-- SCRIPTS - ORDEN CR√çTICO -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/js/config.js"></script>
    
    <script>
        // ==========================================
        // VARIABLES GLOBALES
        // ==========================================
        let currentUser = null;

        // ==========================================
        // CONFIGURACI√ìN DE LA P√ÅGINA
        // ==========================================
        const PAGE_CONFIG = {
            moduleName: 'Herramientas Generales',
            modulePath: 'general-tools',
            pageTitle: 'Generar D√≠as Tilat√°',
            pagePath: 'generar-dias-tilata.html',
            moduleDescription: 'Generaci√≥n autom√°tica del ciclo acad√©mico en calendario institucional'
        };

        // ==========================================
        // INICIALIZACI√ìN
        // ==========================================
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üìñ Iniciando p√°gina de manual...');
            
            try {
                // Verificar si existe la funci√≥n de colores corporativos
                if (typeof loadAndApplyBrandColors === 'function') {
                    await loadAndApplyBrandColors();
                }
                
                // Verificar sesi√≥n si la funci√≥n existe
                if (typeof getStoredSession === 'function') {
                    const session = getStoredSession();
                    if (session && session.user) {
                        currentUser = session.user;
                    }
                }
                
                // Actualizar informaci√≥n en la p√°gina
                updatePageInfo();
                
                console.log('‚úÖ P√°gina de manual lista');
                
            } catch (error) {
                console.error('‚ùå Error inicializando p√°gina:', error);
                if (typeof showMessage === 'function') {
                    showMessage('Error al cargar la p√°gina: ' + error.message, 'danger');
                }
            }
        });

        // ==========================================
        // ACTUALIZAR INFORMACI√ìN DE LA P√ÅGINA
        // ==========================================
        function updatePageInfo() {
            // Actualizar title
            document.title = `Manual - ${PAGE_CONFIG.moduleName} - ${PAGE_CONFIG.pageTitle} - SchoolNet`;
        }

        // ==========================================
        // UTILIDADES DE LOADING
        // ==========================================
        function showLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.remove('hidden');
            }
        }

        function hideLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.add('hidden');
            }
        }

        // ==========================================
        // FUNCI√ìN DE MENSAJES
        // ==========================================
        function showMessage(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            if (!alertContainer) return;
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertContainer.appendChild(alertDiv);
            
            // Auto-remove despu√©s de 5 segundos
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

    </script>
</body>
</html>
