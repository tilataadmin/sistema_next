<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- VERSIÓN DE LA PÁGINA -->
    <meta name="page-version" content="25.11.27.09.25">
    
    <title>Manual - Herramientas Generales - Gestión de Tareas - SchoolNet</title>
    
    <!-- Bootstrap CSS - VERSIÓN FIJA PROBADA -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-overlay.hidden {
            display: none;
        }
        
        .loading-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Encabezado discreto */
        .manual-header {
            background: #f8f9fa;
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding: 1.5rem 0;
            margin-bottom: 2rem;
        }

        .manual-header h1 {
            font-size: 1.75rem;
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 0.25rem;
        }

        .manual-header .subtitle {
            color: #6c757d;
            font-size: 0.95rem;
        }

        /* Info card */
        .info-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Tarjeta para reportar bugs */
        .bug-report-card {
            background: var(--system-secondary-color, #667eea);
            color: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .bug-report-card h5 {
            color: white;
        }

        /* Botón flotante para reportar bugs */
        .floating-bug-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            background: var(--system-primary-color, #dc3545) !important;
            border-color: var(--system-primary-color, #dc3545) !important;
        }

        .floating-bug-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
            opacity: 0.9;
        }

        .icon-large {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        /* Estilos para el contenido del manual */
        .section-title {
            color: var(--system-primary-color, #1B365D);
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding-bottom: 0.5rem;
            margin-top: 2rem;
            margin-bottom: 1.5rem;
        }

        .step-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 0.75rem;
        }

        .feature-list {
            list-style: none;
            padding-left: 0;
        }

        .feature-list li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }

        .feature-list li::before {
            content: "✓";
            color: var(--system-primary-color, #28a745);
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #0d6efd;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .danger-box {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        /* Estilos para badges de ejemplo */
        .badge-example {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .badge-alta {
            background-color: #dc3545;
            color: white;
        }
        
        .badge-normal {
            background-color: #0d6efd;
            color: white;
        }
        
        .badge-baja {
            background-color: #6c757d;
            color: white;
        }
        
        .badge-asignada {
            background-color: #0dcaf0;
            color: #000;
        }
        
        .badge-progreso {
            background-color: #ffc107;
            color: #000;
        }
        
        .badge-terminada {
            background-color: #198754;
            color: white;
        }
        
        .badge-cancelada {
            background-color: #6c757d;
            color: white;
        }
    </style>
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="mb-0">Cargando...</p>
        </div>
    </div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="container-fluid">

        <!-- ENCABEZADO DISCRETO -->
        <div class="manual-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1>
                            <i class="bi bi-book me-2"></i>
                            Manual: Herramientas Generales
                        </h1>
                        <p class="subtitle mb-0">Gestión de Tareas</p>
                    </div>
                    <div class="col-md-4 text-md-end mt-3 mt-md-0">
                        <a href="../../modules/general-tools/tasks.html" class="btn btn-outline-primary">
                            <i class="bi bi-arrow-left me-1"></i>Volver al Módulo
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- CONTENEDOR DE ALERTAS -->
        <div id="alertContainer"></div>

        <div class="row">
            <div class="col-lg-8 mx-auto">

                <!-- INFORMACIÓN CONTEXTUAL -->
                <div class="info-card">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h6 class="text-muted mb-2">Manual de:</h6>
                            <h5 class="mb-1"><strong id="display-module">Herramientas Generales</strong></h5>
                            <p class="text-muted mb-0 small" id="display-page">Gestión de Tareas</p>
                        </div>
                        <div class="col-md-6 text-md-end mt-3 mt-md-0">
                            <p class="small text-muted mb-0">
                                <i class="bi bi-info-circle me-1"></i>
                                Si tienes dudas o encuentras algún problema,<br>
                                puedes reportarlo usando el botón de abajo.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ========================================== -->
                <!-- INICIO DEL CONTENIDO DEL MANUAL -->
                <!-- ========================================== -->

                <!-- SECCIÓN: ¿Qué es? -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-info-circle me-2"></i>
                        ¿Qué es Gestión de Tareas?
                    </h2>
                    
                    <div class="step-card">
                        <p class="lead">
                            Esta función permite <strong>crear, asignar y dar seguimiento a tareas</strong> dentro del sistema SchoolNet.
                        </p>
                        
                        <p>
                            Las tareas son actividades que deben ser realizadas por uno o varios trabajadores del colegio. Pueden estar asociadas a estudiantes específicos (cuando provienen de módulos como Seguimientos o Alertas Tempranas) o ser tareas generales creadas manualmente.
                        </p>

                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>Importante:</strong>
                            Las tareas que ves dependen de tus permisos. Si tienes el permiso "Gestionar tareas", verás todas las tareas del sistema. Si no lo tienes, solo verás las tareas donde eres responsable o colaborador.
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN: Características principales -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-star me-2"></i>
                        Características principales
                    </h2>
                    
                    <div class="step-card">
                        <ul class="feature-list">
                            <li><strong>Crear tareas:</strong> Asigna actividades a cualquier trabajador del colegio (requiere permiso especial)</li>
                            <li><strong>Sistema de prioridades:</strong> Clasifica las tareas como Alta, Normal o Baja según su urgencia</li>
                            <li><strong>Estados de seguimiento:</strong> Las tareas pasan por estados: Asignada → En Progreso → Terminada</li>
                            <li><strong>Colaboradores:</strong> Agrega más personas para trabajar en conjunto en una tarea</li>
                            <li><strong>Notas de progreso:</strong> Documenta el avance de cada tarea con notas con fecha y autor</li>
                            <li><strong>Filtros de búsqueda:</strong> Encuentra tareas por estado, prioridad, módulo origen o descripción</li>
                            <li><strong>Notificaciones automáticas:</strong> Los responsables y colaboradores reciben correos al ser asignados</li>
                            <li><strong>Control de vencimiento:</strong> Las tareas vencidas se resaltan visualmente</li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN: Estados y prioridades -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-tags me-2"></i>
                        Estados y prioridades
                    </h2>
                    
                    <div class="step-card">
                        <h5>Estados de una tarea:</h5>
                        <p>Las tareas pasan por diferentes estados durante su ciclo de vida:</p>
                        <ul>
                            <li><span class="badge-example badge-asignada">Asignada</span> - La tarea fue creada y asignada a un responsable</li>
                            <li><span class="badge-example badge-progreso">En Progreso</span> - El responsable está trabajando en la tarea</li>
                            <li><span class="badge-example badge-terminada">Terminada</span> - La tarea fue completada exitosamente</li>
                            <li><span class="badge-example badge-cancelada">Cancelada</span> - La tarea fue cancelada y no se completará</li>
                        </ul>

                        <h5 class="mt-4">Niveles de prioridad:</h5>
                        <p>La prioridad indica la urgencia de la tarea:</p>
                        <ul>
                            <li><span class="badge-example badge-alta">Alta</span> - Requiere atención inmediata. Las tarjetas tienen borde rojo</li>
                            <li><span class="badge-example badge-normal">Normal</span> - Prioridad estándar. Las tarjetas tienen borde azul</li>
                            <li><span class="badge-example badge-baja">Baja</span> - Puede esperar. Las tarjetas tienen borde gris</li>
                        </ul>

                        <div class="warning-box">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Tareas vencidas:</strong>
                            Cuando una tarea supera su fecha límite sin estar terminada o cancelada, se muestra con fondo amarillo y una etiqueta "VENCIDA" para llamar la atención.
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN: Antes de comenzar -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-clipboard-check me-2"></i>
                        Antes de comenzar
                    </h2>
                    
                    <div class="step-card">
                        <h5>Tipos de usuarios:</h5>
                        <ul>
                            <li><strong>Usuarios con permiso "Gestionar tareas":</strong> Pueden crear nuevas tareas, ver todas las tareas del sistema, y gestionar colaboradores</li>
                            <li><strong>Usuarios sin permiso especial:</strong> Solo ven las tareas donde son responsables o colaboradores, y pueden agregar notas de progreso</li>
                        </ul>

                        <h5 class="mt-4">Roles en una tarea:</h5>
                        <ul>
                            <li><strong>Responsable principal:</strong> La persona asignada para completar la tarea. Puede cambiar el estado y editar el contexto general</li>
                            <li><strong>Colaborador:</strong> Persona adicional que apoya en la tarea. Puede ver toda la información y agregar notas de progreso</li>
                        </ul>

                        <h5 class="mt-4">Módulos de origen:</h5>
                        <p>Las tareas pueden provenir de diferentes partes del sistema:</p>
                        <ul>
                            <li><strong>Seguimientos:</strong> Tareas generadas desde notas de seguimiento a estudiantes</li>
                            <li><strong>Alertas Tempranas:</strong> Tareas derivadas del sistema de alertas tempranas</li>
                            <li><strong>Herramientas Generales:</strong> Tareas creadas manualmente desde esta función</li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN: Guía paso a paso - Ver tareas -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-list-ol me-2"></i>
                        Ver y filtrar tareas
                    </h2>

                    <!-- Paso 1 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">1</span>
                            Acceder a la función
                        </h4>
                        
                        <p>Ingresa a "Gestión de Tareas" desde el menú de Herramientas Generales. El sistema:</p>
                        
                        <ul>
                            <li>Verificará tus permisos de acceso</li>
                            <li>Cargará las tareas según tu rol (todas o solo las tuyas)</li>
                            <li>Mostrará las tareas más recientes primero</li>
                        </ul>
                    </div>

                    <!-- Paso 2 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">2</span>
                            Entender las tarjetas de tareas
                        </h4>
                        
                        <p>Cada tarea se muestra como una tarjeta con la siguiente información:</p>

                        <ul>
                            <li><strong>Prioridad y estado:</strong> Badges de colores en la parte superior</li>
                            <li><strong>Módulo origen:</strong> De dónde proviene la tarea</li>
                            <li><strong>Descripción:</strong> Resumen de la actividad a realizar</li>
                            <li><strong>Responsable:</strong> Quién debe completar la tarea</li>
                            <li><strong>Estudiante:</strong> Si aplica, el estudiante relacionado</li>
                            <li><strong>Fecha límite:</strong> Cuándo debe estar terminada</li>
                            <li><strong>Contadores:</strong> Badges que muestran cantidad de colaboradores y notas</li>
                        </ul>

                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>Colores del borde:</strong>
                            El borde izquierdo de cada tarjeta indica la prioridad: rojo (Alta), azul (Normal) o gris (Baja).
                        </div>
                    </div>

                    <!-- Paso 3 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">3</span>
                            Usar los filtros
                        </h4>
                        
                        <p>En la parte superior encontrarás filtros para encontrar tareas específicas:</p>

                        <ul>
                            <li><strong>Estado:</strong> Filtra por Asignada, En Progreso, Terminada o Cancelada</li>
                            <li><strong>Prioridad:</strong> Filtra por Alta, Normal o Baja</li>
                            <li><strong>Módulo Origen:</strong> Filtra según el módulo que generó la tarea</li>
                            <li><strong>Buscar:</strong> Escribe texto para buscar en la descripción de las tareas</li>
                        </ul>

                        <p>Puedes combinar varios filtros para búsquedas más precisas. Usa el botón "Limpiar Filtros" para reiniciar la búsqueda.</p>

                        <div class="success-box">
                            <strong><i class="bi bi-lightbulb me-2"></i>Consejo:</strong>
                            Para ver solo las tareas pendientes urgentes, filtra por Estado "Asignada" y Prioridad "Alta".
                        </div>
                    </div>

                    <!-- Paso 4 -->
                    <div class="step-card">
                        <h4>
                            <span class="step-number">4</span>
                            Ver el detalle completo
                        </h4>
                        
                        <p>Haz clic en el botón <i class="bi bi-eye"></i> de cualquier tarjeta para ver toda la información:</p>

                        <ul>
                            <li>Descripción completa de la tarea</li>
                            <li>Estado y prioridad actuales</li>
                            <li>Responsable principal</li>
                            <li>Estudiante asociado (si aplica)</li>
                            <li>Fechas límite y de cierre</li>
                            <li>Contexto general documentado</li>
                            <li>Lista de colaboradores</li>
                            <li>Historial completo de notas de progreso</li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN: Crear nueva tarea -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-plus-circle me-2"></i>
                        Crear una nueva tarea
                    </h2>

                    <div class="step-card">
                        <div class="warning-box">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Requisito:</strong>
                            Solo los usuarios con el permiso "Gestionar tareas" pueden crear nuevas tareas. Si no ves el botón "Nueva Tarea", no tienes este permiso.
                        </div>

                        <h5 class="mt-3">Pasos para crear una tarea:</h5>
                        <ol>
                            <li>Haz clic en el botón <strong>"Nueva Tarea"</strong></li>
                            <li>Completa el campo <strong>Descripción</strong> con una explicación clara de la actividad</li>
                            <li>Selecciona el <strong>trabajador responsable</strong> de la lista</li>
                            <li>Define la <strong>Fecha límite</strong> (no puede ser anterior a hoy)</li>
                            <li>Selecciona la <strong>Prioridad</strong> según la urgencia</li>
                            <li>Opcionalmente, agrega un <strong>Contexto inicial</strong> con información adicional</li>
                            <li>Si deseas, expande la sección de <strong>Colaboradores</strong> para agregar más personas</li>
                            <li>Haz clic en <strong>"Crear Tarea"</strong></li>
                        </ol>

                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>Notificaciones:</strong>
                            Al crear la tarea, el responsable principal recibirá un correo electrónico de notificación. Los colaboradores también serán notificados automáticamente.
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN: Principio Ganar-Ganar -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-handshake me-2"></i>
                        Asignar tareas con el principio Ganar-Ganar
                    </h2>
                
                    <div class="step-card">
                        <p class="lead">
                            El <strong>principio Ganar-Ganar</strong>, desarrollado por Stephen Covey, propone que al delegar una tarea, ambas partes deben tener claridad y compromiso mutuo sobre lo que se espera lograr.
                        </p>
                        
                        <p>
                            Cuando asignas una tarea de forma clara y completa, el responsable entiende exactamente qué debe lograr, tiene autonomía para decidir cómo hacerlo, y ambos ganan: tú obtienes resultados y él desarrolla su capacidad.
                        </p>
                
                        <div class="info-box">
                            <strong><i class="bi bi-lightbulb me-2"></i>La clave:</strong>
                            Define el <strong>qué</strong> (resultado esperado), no el <strong>cómo</strong> (el método). Esto genera compromiso genuino porque respeta la inteligencia y creatividad del responsable.
                        </div>
                    </div>
                
                    <div class="step-card">
                        <h5><i class="bi bi-list-check me-2"></i>Los 4 elementos de un buen contexto inicial</h5>
                        
                        <p>Al redactar el contexto inicial de una tarea, incluye estos elementos:</p>
                
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="card h-100 border-primary">
                                    <div class="card-header bg-primary text-white">
                                        <strong>1. Resultados Deseados</strong>
                                    </div>
                                    <div class="card-body">
                                        <p class="mb-2"><em>¿Qué se debe lograr?</em></p>
                                        <ul class="mb-0">
                                            <li>Describe el resultado final esperado</li>
                                            <li>Sé específico y medible</li>
                                            <li>No dictes el método, solo el objetivo</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <div class="card h-100 border-warning">
                                    <div class="card-header bg-warning text-dark">
                                        <strong>2. Directrices</strong>
                                    </div>
                                    <div class="card-body">
                                        <p class="mb-2"><em>¿Qué límites debe respetar?</em></p>
                                        <ul class="mb-0">
                                            <li>Políticas institucionales aplicables</li>
                                            <li>Restricciones de tiempo o presupuesto</li>
                                            <li>Personas que debe (o no debe) involucrar</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <div class="card h-100 border-success">
                                    <div class="card-header bg-success text-white">
                                        <strong>3. Recursos Disponibles</strong>
                                    </div>
                                    <div class="card-body">
                                        <p class="mb-2"><em>¿Con qué cuenta para lograrlo?</em></p>
                                        <ul class="mb-0">
                                            <li>Documentos o información relevante</li>
                                            <li>Personas de apoyo o contactos</li>
                                            <li>Herramientas, sistemas o presupuesto</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <div class="card h-100 border-info">
                                    <div class="card-header bg-info text-dark">
                                        <strong>4. Rendición de Cuentas</strong>
                                    </div>
                                    <div class="card-body">
                                        <p class="mb-2"><em>¿Cómo se medirá el avance?</em></p>
                                        <ul class="mb-0">
                                            <li>Frecuencia de reportes de avance</li>
                                            <li>Indicadores de éxito</li>
                                            <li>Puntos de revisión intermedios</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                
                    <div class="step-card">
                        <h5><i class="bi bi-arrows-angle-contract me-2"></i>Ejemplo comparativo</h5>
                        
                        <p>Observa la diferencia entre un contexto pobre y uno bien estructurado:</p>
                
                        <div class="danger-box">
                            <strong><i class="bi bi-x-circle me-2"></i>Contexto deficiente:</strong>
                            <p class="mb-0 mt-2" style="font-style: italic;">
                                "Hablar con los papás del estudiante sobre su comportamiento."
                            </p>
                            <p class="mt-2 mb-0 small">
                                <strong>Problemas:</strong> No define qué resultado se espera, no indica recursos disponibles, no establece cómo reportar el avance.
                            </p>
                        </div>
                
                        <div class="success-box">
                            <strong><i class="bi bi-check-circle me-2"></i>Contexto Ganar-Ganar:</strong>
                            <p class="mb-0 mt-2" style="font-style: italic;">
                                "<strong>Resultado:</strong> Lograr que los padres se comprometan a implementar un sistema de seguimiento de tareas en casa y firmen el acuerdo de corresponsabilidad.<br><br>
                                <strong>Directrices:</strong> Mantener tono constructivo, no culpabilizar. Si los padres se muestran resistentes, escalar a coordinación.<br><br>
                                <strong>Recursos:</strong> Expediente del estudiante disponible en el sistema, formato de acuerdo en carpeta compartida, historial de comunicaciones previas.<br><br>
                                <strong>Seguimiento:</strong> Registrar resultado de la conversación en notas de progreso dentro de 3 días hábiles."
                            </p>
                        </div>
                
                        <p class="mt-3">
                            Con el segundo contexto, el responsable tiene total claridad sobre qué debe lograr, qué límites respetar, qué herramientas usar y cómo reportar. Puede tomar decisiones autónomas sobre el <em>cómo</em> sin necesidad de consultarte cada detalle.
                        </p>
                    </div>
                
                    <div class="step-card">
                        <h5><i class="bi bi-trophy me-2"></i>Beneficios para ambas partes</h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <h6 class="text-primary"><i class="bi bi-person-check me-2"></i>Para quien asigna:</h6>
                                <ul>
                                    <li>Menos interrupciones por dudas</li>
                                    <li>Resultados más alineados con lo esperado</li>
                                    <li>Evidencia clara para evaluar el desempeño</li>
                                    <li>Delega con confianza, no con ansiedad</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6 class="text-success"><i class="bi bi-person-workspace me-2"></i>Para quien recibe:</h6>
                                <ul>
                                    <li>Claridad total sobre expectativas</li>
                                    <li>Autonomía para decidir el método</li>
                                    <li>Sabe exactamente cómo será evaluado</li>
                                    <li>Desarrolla capacidad y confianza</li>
                                </ul>
                            </div>
                        </div>
                
                        <div class="warning-box mt-3">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Evita el micromanagement:</strong>
                            Si describes paso a paso <em>cómo</em> debe hacerse la tarea, generas dependencia y quitas motivación. Confía en que el responsable encontrará el mejor camino hacia el resultado. Tu rol es definir el destino, no trazar la ruta.
                        </div>
                    </div>
                
                    <div class="step-card">
                        <h5><i class="bi bi-journal-check me-2"></i>Lista de verificación rápida</h5>
                        
                        <p>Antes de crear una tarea, verifica que tu contexto inicial responda estas preguntas:</p>
                
                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead class="table-light">
                                    <tr>
                                        <th style="width: 40px;"></th>
                                        <th>Pregunta</th>
                                        <th>Elemento</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="text-center"><i class="bi bi-square text-muted"></i></td>
                                        <td>¿El responsable sabe exactamente qué resultado debe entregar?</td>
                                        <td><span class="badge bg-primary">Resultado</span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-center"><i class="bi bi-square text-muted"></i></td>
                                        <td>¿Conoce los límites o restricciones que debe respetar?</td>
                                        <td><span class="badge bg-warning text-dark">Directrices</span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-center"><i class="bi bi-square text-muted"></i></td>
                                        <td>¿Sabe qué herramientas, documentos o personas puede usar?</td>
                                        <td><span class="badge bg-success">Recursos</span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-center"><i class="bi bi-square text-muted"></i></td>
                                        <td>¿Está claro cómo y cuándo debe reportar avances?</td>
                                        <td><span class="badge bg-info text-dark">Seguimiento</span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-center"><i class="bi bi-square text-muted"></i></td>
                                        <td>¿Le dejé libertad para decidir el método?</td>
                                        <td><span class="badge bg-secondary">Autonomía</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                
                        <div class="success-box mt-3">
                            <strong><i class="bi bi-lightbulb me-2"></i>Recuerda:</strong>
                            Invertir 2 minutos extra en escribir un buen contexto inicial te ahorrará múltiples conversaciones de aclaración y aumentará significativamente la probabilidad de obtener el resultado que esperas.
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN: Gestionar colaboradores -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-people me-2"></i>
                        Gestionar colaboradores
                    </h2>

                    <div class="step-card">
                        <p class="lead">
                            Los colaboradores son trabajadores adicionales que apoyan en una tarea sin ser el responsable principal.
                        </p>

                        <h5>¿Qué pueden hacer los colaboradores?</h5>
                        <ul>
                            <li>Ver toda la información de la tarea</li>
                            <li>Agregar notas de progreso</li>
                            <li>Recibir notificaciones al ser agregados</li>
                        </ul>

                        <h5 class="mt-3">¿Qué NO pueden hacer los colaboradores?</h5>
                        <ul>
                            <li>Cambiar el estado de la tarea (solo el responsable principal)</li>
                            <li>Modificar el contexto general</li>
                            <li>Cerrar o cancelar la tarea</li>
                        </ul>

                        <h5 class="mt-3">Agregar colaboradores:</h5>
                        <ol>
                            <li>En la tarjeta de la tarea, haz clic en el botón <i class="bi bi-people"></i></li>
                            <li>Selecciona un trabajador de la lista desplegable</li>
                            <li>Haz clic en "Agregar"</li>
                            <li>El colaborador recibirá una notificación por correo</li>
                        </ol>

                        <h5 class="mt-3">Remover colaboradores:</h5>
                        <p>Haz clic en el botón rojo <i class="bi bi-person-x"></i> junto al nombre del colaborador y confirma la acción.</p>

                        <div class="warning-box">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Nota:</strong>
                            Solo el responsable principal o usuarios con permiso "Gestionar tareas" pueden agregar o remover colaboradores.
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN: Documentar progreso -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-journal-text me-2"></i>
                        Documentar el progreso
                    </h2>

                    <div class="step-card">
                        <p class="lead">
                            Documentar el progreso es fundamental para mantener un registro de las acciones realizadas.
                        </p>

                        <h5>Agregar notas de progreso:</h5>
                        <ol>
                            <li>En la tarjeta de la tarea, haz clic en el botón <i class="bi bi-pencil"></i> (Editar progreso)</li>
                            <li>En el campo "Agregar Nota de Progreso", escribe tu actualización</li>
                            <li>Haz clic en "Guardar Cambios"</li>
                        </ol>

                        <p>Cada nota queda registrada con:</p>
                        <ul>
                            <li>Tu nombre como autor</li>
                            <li>Fecha y hora exacta</li>
                            <li>El contenido de la nota</li>
                        </ul>

                        <h5 class="mt-3">Cambiar el estado (solo responsable principal):</h5>
                        <p>Si eres el responsable principal, también puedes:</p>
                        <ul>
                            <li>Modificar el <strong>Contexto General</strong> (resumen ejecutivo de la tarea)</li>
                            <li>Cambiar el <strong>Estado</strong> de la tarea (Asignada → En Progreso → Terminada)</li>
                        </ul>

                        <div class="success-box">
                            <strong><i class="bi bi-lightbulb me-2"></i>Buena práctica:</strong>
                            Agrega notas frecuentes sobre el avance. Esto ayuda a mantener informados a todos los involucrados y crea un historial útil.
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN: Cerrar y cancelar -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-check-circle me-2"></i>
                        Cerrar o cancelar tareas
                    </h2>

                    <div class="step-card">
                        <h5>Cerrar una tarea (marcar como Terminada):</h5>
                        <ol>
                            <li>Haz clic en el botón <i class="bi bi-check-circle"></i> (Cerrar tarea)</li>
                            <li>Confirma la acción</li>
                            <li>La tarea quedará en estado "Terminada"</li>
                        </ol>

                        <div class="warning-box">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Requisito para cerrar:</strong>
                            No puedes cerrar una tarea sin progreso documentado. Debes agregar al menos una nota de progreso o escribir algo en el contexto general antes de poder cerrarla.
                        </div>

                        <h5 class="mt-4">Cancelar una tarea:</h5>
                        <ol>
                            <li>Haz clic en el botón <i class="bi bi-x-circle"></i> (Cancelar)</li>
                            <li>Confirma la acción (esta acción no se puede deshacer)</li>
                            <li>La tarea quedará en estado "Cancelada"</li>
                        </ol>

                        <div class="danger-box">
                            <strong><i class="bi bi-exclamation-octagon me-2"></i>Advertencia:</strong>
                            Cancelar una tarea es irreversible. Solo cancela tareas que definitivamente no se realizarán.
                        </div>

                        <div class="info-box mt-3">
                            <strong><i class="bi bi-info-circle me-2"></i>Después de cerrar o cancelar:</strong>
                            Las tareas terminadas o canceladas ya no muestran botones de edición, colaboradores ni cierre. Solo podrás ver su detalle completo.
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN: Solución de problemas -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-question-circle me-2"></i>
                        Solución de problemas comunes
                    </h2>

                    <div class="step-card">
                        <h5>No veo el botón "Nueva Tarea"</h5>
                        <ul>
                            <li>Solo aparece si tienes el permiso "Gestionar tareas"</li>
                            <li>Contacta al administrador si necesitas crear tareas</li>
                        </ul>

                        <h5 class="mt-3">No veo ninguna tarea</h5>
                        <ul>
                            <li>Si no tienes permiso especial, solo ves tareas donde eres responsable o colaborador</li>
                            <li>Verifica que no tengas filtros aplicados que oculten las tareas</li>
                            <li>Haz clic en "Limpiar Filtros" para ver todas tus tareas</li>
                        </ul>

                        <h5 class="mt-3">No puedo cerrar la tarea</h5>
                        <ul>
                            <li>Debes agregar al menos una nota de progreso o contexto general</li>
                            <li>Solo el responsable principal o usuarios con permiso pueden cerrar tareas</li>
                        </ul>

                        <h5 class="mt-3">No puedo cambiar el estado de la tarea</h5>
                        <ul>
                            <li>Solo el responsable principal puede cambiar el estado</li>
                            <li>Si eres colaborador, solo puedes agregar notas de progreso</li>
                        </ul>

                        <h5 class="mt-3">No puedo agregar colaboradores</h5>
                        <ul>
                            <li>La tarea no debe estar Terminada o Cancelada</li>
                            <li>Debes ser el responsable principal o tener permiso "Gestionar tareas"</li>
                        </ul>

                        <h5 class="mt-3">El responsable no recibió el correo de notificación</h5>
                        <ul>
                            <li>La tarea se creó correctamente aunque el correo no llegue</li>
                            <li>Pídele que revise su carpeta de spam</li>
                            <li>Puede ver la tarea directamente en el sistema</li>
                        </ul>

                        <h5 class="mt-3">La tarea aparece con fondo amarillo</h5>
                        <ul>
                            <li>Esto indica que la tarea está vencida (pasó la fecha límite)</li>
                            <li>Debes atenderla lo antes posible o cerrarla/cancelarla</li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN: Buenas prácticas -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-award me-2"></i>
                        Buenas prácticas
                    </h2>

                    <div class="step-card">
                        <ul class="feature-list">
                            <li><strong>Descripción clara:</strong> Escribe descripciones específicas que indiquen exactamente qué debe hacerse</li>
                            <li><strong>Prioridad realista:</strong> No marques todas las tareas como "Alta"; usa la prioridad según la verdadera urgencia</li>
                            <li><strong>Fechas límite alcanzables:</strong> Define fechas que el responsable pueda cumplir</li>
                            <li><strong>Documenta el progreso:</strong> Agrega notas frecuentes para mantener el historial actualizado</li>
                            <li><strong>Usa colaboradores estratégicamente:</strong> Agrega solo a quienes realmente participarán</li>
                            <li><strong>Cierra las tareas completadas:</strong> No dejes tareas terminadas en estado "En Progreso"</li>
                            <li><strong>Revisa tus tareas vencidas:</strong> Atiende o cierra las tareas que superaron su fecha límite</li>
                            <li><strong>Contexto general útil:</strong> Usa el contexto general para resumir el estado actual de la tarea</li>
                        </ul>

                        <div class="success-box mt-3">
                            <strong><i class="bi bi-lightbulb me-2"></i>Consejo profesional:</strong>
                            Revisa tus tareas al inicio de cada día. Filtra por estado "Asignada" o "En Progreso" para ver qué tienes pendiente.
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN: Preguntas frecuentes -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-chat-dots me-2"></i>
                        Preguntas frecuentes
                    </h2>

                    <div class="step-card">
                        <h5>¿Puedo modificar una tarea después de crearla?</h5>
                        <p>
                            No directamente. Puedes cambiar el estado y agregar notas de progreso, pero no puedes modificar la descripción, el responsable ni la fecha límite una vez creada la tarea.
                        </p>

                        <h5 class="mt-3">¿Puedo reasignar una tarea a otra persona?</h5>
                        <p>
                            No es posible cambiar el responsable principal. Si necesitas que otra persona la complete, considera agregar a esa persona como colaborador y coordinar directamente.
                        </p>

                        <h5 class="mt-3">¿Qué pasa si una tarea se vence?</h5>
                        <p>
                            La tarea se resalta con fondo amarillo y una etiqueta "VENCIDA". Sigue apareciendo normalmente y puedes seguir trabajando en ella o cerrarla.
                        </p>

                        <h5 class="mt-3">¿Puedo eliminar una tarea?</h5>
                        <p>
                            No. Las tareas no se pueden eliminar para mantener el historial completo. Si una tarea ya no aplica, puedes cancelarla.
                        </p>

                        <h5 class="mt-3">¿Los colaboradores reciben todas las actualizaciones?</h5>
                        <p>
                            Los colaboradores reciben notificación solo al ser agregados a la tarea. Las actualizaciones de progreso no generan notificaciones automáticas.
                        </p>

                        <h5 class="mt-3">¿Puedo ver el historial de quién agregó cada nota?</h5>
                        <p>
                            Sí. Cada nota de progreso muestra el nombre del autor y la fecha/hora exacta en que fue agregada.
                        </p>

                        <h5 class="mt-3">¿Las tareas de otros módulos aparecen aquí?</h5>
                        <p>
                            Sí. Las tareas creadas desde Seguimientos o Alertas Tempranas también aparecen en Gestión de Tareas, identificadas por su módulo de origen.
                        </p>

                        <h5 class="mt-3">¿Cuántos colaboradores puedo agregar?</h5>
                        <p>
                            No hay límite de colaboradores. Sin embargo, es recomendable agregar solo a quienes realmente participarán para evitar notificaciones innecesarias.
                        </p>

                        <h5 class="mt-3">¿Puedo filtrar solo mis tareas?</h5>
                        <p>
                            Si no tienes el permiso "Gestionar tareas", automáticamente solo verás las tareas donde eres responsable o colaborador. Si tienes el permiso, puedes usar el filtro de búsqueda con tu nombre.
                        </p>

                        <h5 class="mt-3">¿Qué significa el badge con número junto a la tarjeta?</h5>
                        <p>
                            Los badges muestran: el ícono de personas con un número indica la cantidad de colaboradores, y el ícono de documento con número indica la cantidad de notas de progreso registradas.
                        </p>
                    </div>
                </section>

                <!-- ========================================== -->
                <!-- FIN DEL CONTENIDO DEL MANUAL -->
                <!-- ========================================== -->

                <!-- TARJETA PARA REPORTAR BUGS -->
                <div class="bug-report-card">
                    <i class="bi bi-bug-fill icon-large"></i>
                    <h4 class="mb-3">¿Encontraste un problema o tienes una sugerencia?</h4>
                    <p class="mb-4">
                        Si experimentaste un error, algo no funciona como esperas, o tienes 
                        una sugerencia para mejorar el sistema, repórtalo aquí.
                    </p>
                    <a href="../report-bug.html" class="btn btn-light btn-lg">
                        <i class="bi bi-exclamation-triangle me-2"></i>Reportar Bug o Problema
                    </a>
                </div>

            </div>
        </div>

    </div>

    <!-- BOTÓN FLOTANTE PARA REPORTAR BUGS -->
    <a href="../report-bug.html" class="btn btn-danger btn-lg floating-bug-button" title="Reportar Bug">
        <i class="bi bi-bug-fill me-2"></i>Reportar Bug
    </a>

    <!-- SCRIPTS - ORDEN CRÍTICO -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/js/config.js"></script>
    
    <script>
        // ==========================================
        // VARIABLES GLOBALES
        // ==========================================
        let currentUser = null;

        // ==========================================
        // CONFIGURACIÓN DE LA PÁGINA
        // ==========================================
        const PAGE_CONFIG = {
            moduleName: 'Herramientas Generales',
            modulePath: 'general-tools',
            pageTitle: 'Gestión de Tareas',
            pagePath: 'tasks.html',
            moduleDescription: 'Administra y da seguimiento a las tareas asignadas'
        };

        // ==========================================
        // INICIALIZACIÓN
        // ==========================================
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('📖 Iniciando página de manual...');
            
            try {
                // Verificar si existe la función de colores corporativos
                if (typeof loadAndApplyBrandColors === 'function') {
                    await loadAndApplyBrandColors();
                }
                
                // Verificar sesión si la función existe
                if (typeof getStoredSession === 'function') {
                    const session = getStoredSession();
                    if (session && session.user) {
                        currentUser = session.user;
                    }
                }
                
                // Actualizar información en la página
                updatePageInfo();
                
                console.log('✅ Página de manual lista');
                
            } catch (error) {
                console.error('❌ Error inicializando página:', error);
                if (typeof showMessage === 'function') {
                    showMessage('Error al cargar la página: ' + error.message, 'danger');
                }
            }
        });

        // ==========================================
        // ACTUALIZAR INFORMACIÓN DE LA PÁGINA
        // ==========================================
        function updatePageInfo() {
            // Actualizar title
            document.title = `Manual - ${PAGE_CONFIG.moduleName} - ${PAGE_CONFIG.pageTitle} - SchoolNet`;
        }

        // ==========================================
        // UTILIDADES DE LOADING
        // ==========================================
        function showLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.remove('hidden');
            }
        }

        function hideLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.add('hidden');
            }
        }

        // ==========================================
        // FUNCIÓN DE MENSAJES
        // ==========================================
        function showMessage(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            if (!alertContainer) return;
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertContainer.appendChild(alertDiv);
            
            // Auto-remove después de 5 segundos
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

    </script>
</body>
</html>
