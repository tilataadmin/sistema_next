<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- VERSIÓN DE LA PÁGINA -->
    <meta name="page-version" content="26.01.26.16.55">
    
    <title>Manual - Formación - Gestionar Fechas Tentativas - SchoolNet</title>
    
    <!-- Bootstrap CSS - VERSIÓN FIJA PROBADA -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-overlay.hidden {
            display: none;
        }
        
        .loading-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Encabezado discreto */
        .manual-header {
            background: #f8f9fa;
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding: 1.5rem 0;
            margin-bottom: 2rem;
        }

        .manual-header h1 {
            font-size: 1.75rem;
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 0.25rem;
        }

        .manual-header .subtitle {
            color: #6c757d;
            font-size: 0.95rem;
        }

        /* Info card */
        .info-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Tarjeta para reportar bugs - COLOR PRIMARIO */
        .bug-report-card {
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .bug-report-card h5 {
            color: white;
        }

        /* Botón flotante para reportar bugs - COLOR PRIMARIO */
        .floating-bug-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            background: var(--system-primary-color, #1B365D) !important;
            border-color: var(--system-primary-color, #1B365D) !important;
        }

        .floating-bug-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
            opacity: 0.9;
        }

        .icon-large {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        /* Cajas de información */
        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #0d6efd;
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
        }

        .success-box {
            background: #d1e7dd;
            border-left: 4px solid #198754;
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
        }

        .danger-box {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
        }

        /* Tarjetas de pasos */
        .step-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .step-card h5 {
            color: #8b5cf6;
            margin-bottom: 1rem;
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: #8b5cf6;
            color: white;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 0.75rem;
        }

        /* Listas con estilo */
        .feature-list {
            list-style: none;
            padding-left: 0;
        }

        .feature-list li {
            padding-left: 1.75rem;
            margin-bottom: 0.75rem;
            position: relative;
        }

        .feature-list li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: #198754;
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* Secciones del manual */
        .manual-section {
            margin-bottom: 3rem;
        }

        .manual-section h3 {
            color: #8b5cf6;
            border-bottom: 2px solid #ede9fe;
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .manual-section h4 {
            color: #495057;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }

        /* FAQ */
        .faq-item {
            margin-bottom: 1.5rem;
        }

        .faq-question {
            font-weight: 600;
            color: #495057;
            margin-bottom: 0.5rem;
        }

        .faq-answer {
            color: #6c757d;
            padding-left: 1.5rem;
        }

        /* Tabla de ejemplo */
        .example-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            font-size: 0.9rem;
        }

        .example-table th,
        .example-table td {
            border: 1px solid #dee2e6;
            padding: 0.75rem;
            text-align: left;
        }

        .example-table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }

        .example-table tr:hover {
            background-color: #f8f9fa;
        }
    </style>
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="mb-0">Cargando...</p>
        </div>
    </div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="container-fluid">

        <!-- ENCABEZADO DISCRETO -->
        <div class="manual-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1>
                            <i class="bi bi-book me-2"></i>
                            Manual: Gestionar Fechas Tentativas
                        </h1>
                        <p class="subtitle mb-0">Módulo de Formación</p>
                    </div>
                    <div class="col-md-4 text-md-end mt-3 mt-md-0">
                        <a href="../../modules/training/manage-deadlines.html" class="btn btn-outline-primary">
                            <i class="bi bi-arrow-left me-1"></i>Volver al Módulo
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- CONTENEDOR DE ALERTAS -->
        <div id="alertContainer"></div>

        <div class="row">
            <div class="col-lg-10 mx-auto">

                <!-- INFORMACIÓN CONTEXTUAL -->
                <div class="info-card">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h6 class="text-muted mb-2">Manual de:</h6>
                            <h5 class="mb-1"><strong id="display-module">Formación</strong></h5>
                            <p class="text-muted mb-0 small" id="display-page">Gestionar Fechas Tentativas de Cumplimiento</p>
                        </div>
                        <div class="col-md-6 text-md-end mt-3 mt-md-0">
                            <p class="small text-muted mb-0">
                                <i class="bi bi-info-circle me-1"></i>
                                Si tienes dudas o encuentras algún problema,<br>
                                puedes reportarlo usando el botón de abajo.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- CONTENIDO DEL MANUAL -->
                <!-- ============================================ -->

                <!-- SECCIÓN 1: ¿QUÉ ES? -->
                <div class="manual-section">
                    <h3><i class="bi bi-info-circle me-2"></i>¿Qué es esta funcionalidad?</h3>
                    
                    <p>
                        Esta herramienta te permite <strong>establecer y modificar las fechas meta (tentativas)</strong> 
                        para que los trabajadores completen las unidades formativas asignadas en sus rutas de capacitación.
                    </p>

                    <p>
                        Una "fecha meta" o "fecha tentativa" es la fecha objetivo en la que se espera que el trabajador 
                        complete una capacitación específica. Estas fechas ayudan a organizar y planificar el cumplimiento 
                        de las formaciones de manera ordenada.
                    </p>

                    <div class="success-box">
                        <strong><i class="bi bi-lightbulb me-2"></i>Ejemplo:</strong>
                        Si a un trabajador se le asignó el curso de "Seguridad Industrial" el 1 de enero, puedes 
                        establecer como fecha meta el 31 de marzo. Esto significa que se espera que complete el curso 
                        antes de esa fecha.
                    </div>
                </div>

                <!-- SECCIÓN 2: ¿PARA QUÉ SIRVE? -->
                <div class="manual-section">
                    <h3><i class="bi bi-star me-2"></i>¿Para qué sirve?</h3>
                    
                    <ul class="feature-list">
                        <li>Planificar cuándo deben completarse las capacitaciones de cada trabajador</li>
                        <li>Establecer fechas límite realistas para el cumplimiento de formaciones</li>
                        <li>Priorizar qué capacitaciones son más urgentes</li>
                        <li>Facilitar el seguimiento y control de avances en formación</li>
                        <li>Identificar qué unidades están próximas a vencer o ya vencidas</li>
                        <li>Gestionar masivamente las fechas de múltiples unidades a la vez</li>
                        <li>Ajustar fechas cuando las circunstancias cambian</li>
                    </ul>

                    <div class="info-box">
                        <strong><i class="bi bi-info-circle me-2"></i>Diferencia importante:</strong>
                        Esta funcionalidad NO registra que el trabajador completó la capacitación. Solo establece 
                        cuándo DEBERÍA completarla. Para registrar cumplimientos reales, debes usar la funcionalidad 
                        "Registrar Cumplimiento de Unidades".
                    </div>
                </div>

                <!-- SECCIÓN 3: ¿QUIÉN PUEDE USARLA? -->
                <div class="manual-section">
                    <h3><i class="bi bi-people me-2"></i>¿Quién puede usar esta funcionalidad?</h3>
                    
                    <p>
                        Esta funcionalidad está disponible para usuarios que tengan el permiso 
                        <strong>"Gestionar fechas tentativas"</strong> en el sistema.
                    </p>

                    <p>
                        Generalmente, este permiso lo tienen:
                    </p>

                    <ul>
                        <li>Coordinadores de formación y capacitación</li>
                        <li>Jefes de talento humano</li>
                        <li>Planificadores de desarrollo organizacional</li>
                        <li>Directores de área responsables de la formación de su equipo</li>
                        <li>Administradores del sistema</li>
                    </ul>

                    <div class="warning-box">
                        <strong><i class="bi bi-exclamation-triangle me-2"></i>Importante:</strong>
                        Establece fechas realistas. Ten en cuenta la disponibilidad del trabajador, la duración de 
                        la capacitación, y otros compromisos laborales al definir fechas meta.
                    </div>
                </div>

                <!-- SECCIÓN 4: ¿CÓMO SE USA? -->
                <div class="manual-section">
                    <h3><i class="bi bi-list-check me-2"></i>¿Cómo se usa? Paso a paso</h3>

                    <!-- PASO 1 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">1</span>
                            Buscar al trabajador
                        </h5>
                        <p>
                            En el campo de búsqueda superior, escribe el nombre del trabajador cuyas fechas meta 
                            deseas gestionar. Necesitas escribir al menos 3 caracteres para ver resultados.
                        </p>
                        <div class="success-box">
                            <strong><i class="bi bi-lightbulb me-2"></i>Consejo:</strong>
                            Si gestionas las fechas de varios trabajadores seguidos, usa el botón "Cambiar" para 
                            volver rápidamente al buscador sin perder el contexto.
                        </div>
                    </div>

                    <!-- PASO 2 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">2</span>
                            Seleccionar al trabajador
                        </h5>
                        <p>
                            Haz clic en la tarjeta del trabajador correcto. El sistema cargará automáticamente todas 
                            las unidades formativas en su ruta de capacitación.
                        </p>
                        <p>
                            Verás un resumen con 4 indicadores principales:
                        </p>
                        <ul>
                            <li><strong>Total Unidades:</strong> Todas las unidades en la ruta del trabajador</li>
                            <li><strong>Con Fecha Meta:</strong> Cuántas unidades ya tienen fecha establecida</li>
                            <li><strong>Sin Fecha Meta:</strong> Cuántas unidades aún no tienen fecha</li>
                            <li><strong>Editables:</strong> Cuántas unidades puedes modificar</li>
                        </ul>
                    </div>

                    <!-- PASO 3 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">3</span>
                            Revisar la tabla de unidades
                        </h5>
                        <p>
                            La tabla muestra todas las unidades del trabajador con la siguiente información:
                        </p>
                        <ul>
                            <li><strong>Unidad Formativa:</strong> Código y nombre de la capacitación</li>
                            <li><strong>Tipo:</strong> Si es obligatoria u opcional</li>
                            <li><strong>Estado:</strong> Pendiente, En progreso, Vencido, Completado o Eximido</li>
                            <li><strong>Asignada:</strong> Fecha en que se asignó la unidad al trabajador</li>
                            <li><strong>Fecha Meta:</strong> La fecha objetivo (que puedes editar)</li>
                        </ul>
                        
                        <div class="info-box">
                            <strong><i class="bi bi-palette me-2"></i>Códigos de colores:</strong>
                            <ul class="mt-2 mb-0">
                                <li>Fondo verde claro: Unidad ya completada (no se puede editar)</li>
                                <li>Fondo amarillo claro: Unidad eximida (no se puede editar)</li>
                                <li>Fondo blanco: Unidad editable</li>
                            </ul>
                        </div>
                    </div>

                    <!-- PASO 4 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">4</span>
                            Establecer o modificar fechas
                        </h5>
                        <p>
                            En la columna "Fecha Meta", haz clic en el campo de fecha que deseas editar y selecciona 
                            la nueva fecha usando el calendario que aparece.
                        </p>
                        
                        <h6 class="mt-3 mb-2"><strong>Reglas para establecer fechas:</strong></h6>
                        <div class="warning-box">
                            <ul class="mb-0">
                                <li>La fecha meta DEBE ser igual o posterior a la fecha de asignación</li>
                                <li>No puedes poner fechas anteriores a cuando se le asignó la unidad</li>
                                <li>Puedes poner fechas futuras sin límite</li>
                                <li>Solo puedes editar unidades que estén Pendientes, En progreso o Vencidas</li>
                                <li>Las unidades Completadas o Eximidas no se pueden editar</li>
                            </ul>
                        </div>
                        
                        <div class="success-box">
                            <strong><i class="bi bi-lightbulb me-2"></i>Tip:</strong>
                            Si una unidad ya tiene fecha y quieres quitarla, haz clic en el botón de X roja al 
                            lado del campo de fecha. Esto limpiará la fecha meta.
                        </div>
                    </div>

                    <!-- PASO 5 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">5</span>
                            Realizar múltiples cambios
                        </h5>
                        <p>
                            Puedes modificar las fechas de varias unidades antes de guardar. El sistema va 
                            contando cuántos cambios has hecho y te muestra un resumen al final de la tabla.
                        </p>
                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>Nota:</strong>
                            Los cambios NO se guardan automáticamente. Todos quedan pendientes hasta que 
                            hagas clic en "Guardar Todas las Fechas".
                        </div>
                    </div>

                    <!-- PASO 6 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">6</span>
                            Guardar los cambios
                        </h5>
                        <p>
                            Cuando hayas terminado de establecer o modificar las fechas, haz clic en el botón 
                            <span class="badge bg-primary">
                                <i class="bi bi-save me-1"></i>Guardar Todas las Fechas
                            </span>
                            que está en la parte superior derecha de la tabla.
                        </p>
                        <p>
                            El sistema te pedirá confirmación mostrándote cuántos cambios vas a guardar.
                        </p>
                        <div class="success-box">
                            <strong><i class="bi bi-check-circle me-2"></i>¿Qué sucede al guardar?</strong>
                            <ul class="mt-2 mb-0">
                                <li>Todas las fechas modificadas se actualizan en la base de datos</li>
                                <li>Los cambios quedan registrados con fecha y hora</li>
                                <li>El sistema actualiza los indicadores de vencimiento</li>
                                <li>Se resetea el contador de cambios pendientes</li>
                                <li>Las fechas nuevas quedan disponibles para reportes y seguimiento</li>
                            </ul>
                        </div>
                    </div>

                    <!-- PASO 7 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">7</span>
                            (Opcional) Deshacer cambios antes de guardar
                        </h5>
                        <p>
                            Si modificaste varias fechas pero te arrepentiste antes de guardar, puedes hacer 
                            clic en el botón 
                            <span class="badge bg-secondary">
                                <i class="bi bi-arrow-counterclockwise me-1"></i>Deshacer Cambios
                            </span>
                        </p>
                        <p>
                            Esto revertirá TODOS los cambios no guardados y restaurará las fechas a como estaban 
                            antes de que empezaras a editarlas.
                        </p>
                        <div class="warning-box">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Advertencia:</strong>
                            Una vez que hagas clic en "Guardar Todas las Fechas", ya no podrás usar "Deshacer". 
                            Los cambios guardados son permanentes.
                        </div>
                    </div>

                </div>

                <!-- SECCIÓN 5: CARACTERÍSTICAS ESPECIALES -->
                <div class="manual-section">
                    <h3><i class="bi bi-stars me-2"></i>Características Especiales</h3>

                    <h4>Alertas visuales de vencimiento</h4>
                    <p>
                        El sistema te ayuda a identificar situaciones urgentes con badges de colores:
                    </p>
                    <ul>
                        <li>
                            <span class="badge" style="background-color: #f59e0b; color: white;">
                                <i class="bi bi-exclamation-triangle"></i> Vence Pronto
                            </span>
                            Aparece cuando faltan 7 días o menos para la fecha meta
                        </li>
                        <li>
                            <span class="badge" style="background-color: #dc3545; color: white;">
                                <i class="bi bi-x-circle"></i> Vencida
                            </span>
                            Aparece cuando la fecha meta ya pasó y la unidad sigue sin completar
                        </li>
                    </ul>
                    <div class="info-box">
                        <strong><i class="bi bi-lightbulb me-2"></i>Uso estratégico:</strong>
                        Usa estas alertas para priorizar contactar a los trabajadores cuyas capacitaciones están 
                        más urgentes o vencidas.
                    </div>

                    <h4>Gestión masiva de fechas</h4>
                    <p>
                        Puedes modificar múltiples fechas en una sola sesión. Esto es especialmente útil cuando:
                    </p>
                    <ul>
                        <li>Necesitas planificar toda la ruta formativa de un trabajador nuevo</li>
                        <li>Cambios en el cronograma requieren ajustar varias fechas</li>
                        <li>Hay que reorganizar prioridades de capacitación</li>
                    </ul>

                    <h4>Protección contra pérdida de datos</h4>
                    <p>
                        Si intentas cambiar de trabajador o salir de la página con cambios sin guardar, el 
                        sistema te advertirá y te dará oportunidad de guardar primero.
                    </p>

                    <h4>Validación automática de fechas</h4>
                    <p>
                        El sistema no te permite guardar fechas que sean anteriores a la fecha de asignación. 
                        Si intentas poner una fecha inválida, el campo se marcará en rojo y se revertirá 
                        automáticamente.
                    </p>

                    <h4>Limpieza de fechas</h4>
                    <p>
                        Puedes eliminar una fecha meta existente usando el botón X al lado del campo. 
                        Esto es útil cuando decides que una unidad no necesita fecha límite específica.
                    </p>
                </div>

                <!-- SECCIÓN 6: EJEMPLOS PRÁCTICOS -->
                <div class="manual-section">
                    <h3><i class="bi bi-diagram-3 me-2"></i>Ejemplos Prácticos de Uso</h3>

                    <h4>Ejemplo 1: Planificar ruta de trabajador nuevo</h4>
                    <div class="success-box">
                        <strong>Situación:</strong> Ingresa un trabajador nuevo el 1 de febrero y necesitas 
                        planificar sus 6 capacitaciones obligatorias.
                        
                        <p class="mt-3 mb-2"><strong>Estrategia:</strong></p>
                        <table class="example-table">
                            <thead>
                                <tr>
                                    <th>Capacitación</th>
                                    <th>Prioridad</th>
                                    <th>Fecha Meta</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Inducción Corporativa</td>
                                    <td>Alta (debe ir primero)</td>
                                    <td>7 de febrero</td>
                                </tr>
                                <tr>
                                    <td>Seguridad y Salud</td>
                                    <td>Alta (obligatoria legal)</td>
                                    <td>14 de febrero</td>
                                </tr>
                                <tr>
                                    <td>Sistema de Gestión</td>
                                    <td>Media</td>
                                    <td>28 de febrero</td>
                                </tr>
                                <tr>
                                    <td>Herramientas Ofimáticas</td>
                                    <td>Media</td>
                                    <td>15 de marzo</td>
                                </tr>
                                <tr>
                                    <td>Atención al Cliente</td>
                                    <td>Media</td>
                                    <td>30 de marzo</td>
                                </tr>
                                <tr>
                                    <td>Curso Avanzado del Rol</td>
                                    <td>Baja (puede esperar)</td>
                                    <td>30 de abril</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <p class="mb-0">
                            Estableces todas estas fechas en una sola sesión y luego guardas todos los cambios juntos.
                        </p>
                    </div>

                    <h4>Ejemplo 2: Ajustar fechas por cambio de prioridades</h4>
                    <div class="info-box">
                        <strong>Situación:</strong> Un trabajador tiene 3 capacitaciones programadas para marzo, 
                        pero surge un proyecto urgente que consume su tiempo.
                        
                        <p class="mt-3 mb-2"><strong>Acción:</strong></p>
                        <ol class="mb-0">
                            <li>Buscas al trabajador</li>
                            <li>Identificas las 3 capacitaciones de marzo</li>
                            <li>Extiendes sus fechas meta a abril y mayo</li>
                            <li>Guardas los cambios</li>
                        </ol>
                        
                        <p class="mt-3 mb-0">
                            Resultado: Las capacitaciones siguen en la ruta pero con fechas realistas que el 
                            trabajador puede cumplir.
                        </p>
                    </div>

                    <h4>Ejemplo 3: Gestionar unidades vencidas</h4>
                    <div class="warning-box">
                        <strong>Situación:</strong> Un trabajador tiene 2 capacitaciones que ya vencieron hace 
                        15 días (muestran el badge rojo "Vencida").
                        
                        <p class="mt-3 mb-2"><strong>Decisión a tomar:</strong></p>
                        <ul class="mb-0">
                            <li><strong>Opción A:</strong> Extiendes las fechas a fechas futuras realistas si el 
                                trabajador aún puede completarlas</li>
                            <li><strong>Opción B:</strong> Dejas las fechas vencidas como están para que quede 
                                registrado el retraso en reportes</li>
                            <li><strong>Opción C:</strong> Contactas al trabajador, confirmas que completó las 
                                capacitaciones, y vas a "Registrar Cumplimiento" (otra funcionalidad)</li>
                        </ul>
                    </div>

                </div>

                <!-- SECCIÓN 7: INFORMACIÓN IMPORTANTE -->
                <div class="manual-section">
                    <h3><i class="bi bi-exclamation-circle me-2"></i>Información Importante</h3>

                    <h4>Restricciones del sistema</h4>
                    <div class="danger-box">
                        <strong>NO puedes editar fechas de:</strong>
                        <ul class="mt-2 mb-0">
                            <li>Unidades con estado "Completado" (fondo verde)</li>
                            <li>Unidades con estado "Eximido" (fondo amarillo)</li>
                        </ul>
                        <p class="mt-2 mb-0">
                            Estas unidades muestran la fecha en modo solo lectura porque ya cumplieron su ciclo.
                        </p>
                    </div>

                    <h4>¿Qué pasa con las fechas meta cuando...?</h4>
                    <p><strong>...se registra el cumplimiento de la unidad?</strong></p>
                    <p>
                        La fecha meta queda guardada como referencia histórica, pero ya no se toma en cuenta para 
                        alertas de vencimiento porque la unidad está completada.
                    </p>

                    <p><strong>...se exime al trabajador de la unidad?</strong></p>
                    <p>
                        Similar al caso anterior, la fecha meta se conserva en el registro pero la unidad sale 
                        del seguimiento activo.
                    </p>

                    <p><strong>...se elimina/quita una fecha meta?</strong></p>
                    <p>
                        La unidad simplemente queda sin fecha objetivo. No tiene límite de tiempo específico 
                        pero sigue pendiente de completar.
                    </p>

                    <h4>Coordinación con otras funcionalidades</h4>
                    <p>
                        Esta funcionalidad trabaja en conjunto con:
                    </p>
                    <ul>
                        <li><strong>Registrar Cumplimiento:</strong> Donde registras cuando la unidad fue completada</li>
                        <li><strong>Gestión de Rutas:</strong> Donde asignas las unidades inicialmente</li>
                        <li><strong>Reportes de Formación:</strong> Que usan estas fechas para análisis de cumplimiento</li>
                    </ul>

                    <h4>Impacto en reportes y estadísticas</h4>
                    <p>
                        Las fechas meta que establezcas aquí se usan para:
                    </p>
                    <ul>
                        <li>Calcular porcentajes de cumplimiento en tiempo</li>
                        <li>Generar alertas de capacitaciones próximas a vencer</li>
                        <li>Producir reportes de planificación vs ejecución</li>
                        <li>Alimentar dashboards de seguimiento formativo</li>
                    </ul>

                    <div class="info-box">
                        <strong><i class="bi bi-info-circle me-2"></i>Por eso es importante:</strong>
                        Establecer fechas realistas y mantenerlas actualizadas. Los reportes gerenciales 
                        dependen de esta información para tomar decisiones.
                    </div>
                </div>

                <!-- SECCIÓN 8: PREGUNTAS FRECUENTES -->
                <div class="manual-section">
                    <h3><i class="bi bi-question-circle me-2"></i>Preguntas Frecuentes</h3>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¿Es obligatorio poner fecha meta a todas las unidades?
                        </div>
                        <div class="faq-answer">
                            No, es opcional. Puedes dejar unidades sin fecha meta si prefieres no establecer 
                            un límite de tiempo. Sin embargo, para un mejor seguimiento, es recomendable poner 
                            fechas al menos a las unidades obligatorias.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¿Puedo cambiar una fecha meta después de haberla guardado?
                        </div>
                        <div class="faq-answer">
                            Sí, puedes modificar las fechas meta las veces que necesites, siempre y cuando la 
                            unidad siga en estado Pendiente, En progreso o Vencido. Una vez completada o eximida, 
                            ya no se puede cambiar.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¿Qué hago si puse una fecha muy cercana y el trabajador no podrá cumplirla?
                        </div>
                        <div class="faq-answer">
                            Simplemente vuelve a buscar al trabajador, localiza la unidad, y extiende la fecha 
                            a una más realista. Es mejor ajustar las fechas a tiempo que tener muchas unidades 
                            marcadas como vencidas.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¿El trabajador recibe notificación cuando le pongo o cambio una fecha meta?
                        </div>
                        <div class="faq-answer">
                            Depende de la configuración del sistema. Típicamente, los trabajadores pueden ver sus 
                            fechas meta en su perfil, pero no siempre reciben notificación automática de cambios. 
                            Es buena práctica comunicarles directamente cuando establezcas fechas importantes.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¿Puedo copiar las fechas de un trabajador a otro?
                        </div>
                        <div class="faq-answer">
                            No directamente desde esta funcionalidad. Tendrías que establecer las fechas 
                            manualmente para cada trabajador. Si necesitas hacer esto frecuentemente, consulta 
                            con el administrador sobre herramientas de gestión masiva.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¿Qué pasa si salgo de la página sin guardar?
                        </div>
                        <div class="faq-answer">
                            El navegador te mostrará una advertencia antes de salir. Si decides salir de todos 
                            modos, perderás TODOS los cambios no guardados. No hay forma de recuperarlos después.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            Modifiqué 10 fechas pero solo quiero guardar 8, ¿puedo?
                        </div>
                        <div class="faq-answer">
                            No selectivamente. El botón "Guardar Todas las Fechas" guarda TODOS los cambios 
                            pendientes. Si quieres descartar algunos cambios, usa "Deshacer Cambios" para 
                            revertir todo, y luego vuelve a modificar solo las fechas que sí quieres cambiar.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¿Cuánto tiempo tengo antes de que expire mi sesión de edición?
                        </div>
                        <div class="faq-answer">
                            No hay límite de tiempo mientras mantengas la página abierta. Sin embargo, si la 
                            sesión del sistema expira (generalmente después de inactividad prolongada), podrías 
                            perder los cambios. Por seguridad, guarda cada vez que termines de modificar un 
                            conjunto de fechas.
                        </div>
                    </div>

                </div>

                <!-- SECCIÓN 9: PROBLEMAS COMUNES -->
                <div class="manual-section">
                    <h3><i class="bi bi-tools me-2"></i>Problemas Comunes y Soluciones</h3>

                    <div class="step-card">
                        <h5><i class="bi bi-x-circle text-danger me-2"></i>El campo de fecha no me deja seleccionar la fecha que quiero</h5>
                        <p><strong>Posibles causas:</strong></p>
                        <ul>
                            <li>Estás intentando poner una fecha anterior a la fecha de asignación</li>
                            <li>La unidad está completada o eximida (campo deshabilitado)</li>
                        </ul>
                        <p><strong>Solución:</strong></p>
                        <p>
                            Verifica el estado de la unidad y la fecha de asignación. La fecha meta debe ser 
                            igual o posterior a cuando se asignó la unidad. Si la unidad tiene fondo verde o 
                            amarillo, no podrás editarla.
                        </p>
                    </div>

                    <div class="step-card">
                        <h5><i class="bi bi-exclamation-triangle text-warning me-2"></i>Hice cambios pero el botón "Guardar" está deshabilitado</h5>
                        <p><strong>Posibles causas:</strong></p>
                        <ul>
                            <li>Los cambios que hiciste son iguales a las fechas que ya estaban guardadas</li>
                            <li>Ya guardaste los cambios y no has hecho modificaciones nuevas</li>
                            <li>Pusiste fechas inválidas que el sistema rechazó</li>
                        </ul>
                        <p><strong>Solución:</strong></p>
                        <p>
                            Verifica el contador de "cambios pendientes" al final de la tabla. Si marca 0, 
                            significa que no hay nada nuevo por guardar. Intenta modificar una fecha nuevamente 
                            y asegúrate de que sea diferente a la original.
                        </p>
                    </div>

                    <div class="step-card">
                        <h5><i class="bi bi-slash-circle text-danger me-2"></i>No puedo limpiar/borrar una fecha que ya existe</h5>
                        <p><strong>Posibles causas:</strong></p>
                        <ul>
                            <li>No estás viendo el botón X porque la unidad no es editable</li>
                            <li>El botón X está pero no responde al hacer clic</li>
                        </ul>
                        <p><strong>Solución:</strong></p>
                        <p>
                            Verifica que la unidad sea editable (fondo blanco, estado Pendiente/En progreso/Vencido). 
                            Si el botón X no aparece, la unidad ya está completada o eximida. Si aparece pero no 
                            funciona, intenta refrescar la página y volver a buscar al trabajador.
                        </p>
                    </div>

                    <div class="step-card">
                        <h5><i class="bi bi-exclamation-circle text-info me-2"></i>Guardé los cambios pero no veo las fechas actualizadas</h5>
                        <p><strong>Posibles causas:</strong></p>
                        <ul>
                            <li>Error de conexión que impidió guardar correctamente</li>
                            <li>La página no recargó los datos después de guardar</li>
                        </ul>
                        <p><strong>Solución:</strong></p>
                        <p>
                            Usa el botón "Cambiar" para limpiar la selección y luego vuelve a buscar al mismo 
                            trabajador. Si las fechas siguen sin aparecer como las guardaste, es probable que 
                            hubo un error. Revisa los mensajes del sistema y vuelve a intentar.
                        </p>
                    </div>

                    <div class="step-card">
                        <h5><i class="bi bi-wifi-off text-danger me-2"></i>Tengo problemas de conexión mientras edito fechas</h5>
                        <p><strong>Acción a tomar:</strong></p>
                        <ul>
                            <li>NO refresques la página ni salgas del navegador</li>
                            <li>Anota manualmente las fechas que habías modificado (por precaución)</li>
                            <li>Espera a que se restablezca la conexión</li>
                            <li>Intenta guardar cuando vuelva la conexión</li>
                        </ul>
                        <p><strong>Si perdiste los cambios:</strong></p>
                        <p>
                            Tendrás que volver a establecer las fechas manualmente. Por eso es recomendable 
                            guardar frecuentemente en lugar de acumular muchos cambios.
                        </p>
                    </div>

                </div>

                <!-- SECCIÓN 10: MEJORES PRÁCTICAS -->
                <div class="manual-section">
                    <h3><i class="bi bi-award me-2"></i>Mejores Prácticas</h3>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Establece fechas realistas y alcanzables</strong>
                        <p class="mb-0 mt-2">
                            Considera la carga de trabajo actual del empleado, la duración de la capacitación, 
                            y otros compromisos. Una fecha meta bien pensada es motivadora; una fecha imposible 
                            es desmotivadora.
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Prioriza las capacitaciones obligatorias</strong>
                        <p class="mb-0 mt-2">
                            Establece primero las fechas de las unidades obligatorias (marcadas en rojo) y luego 
                            las opcionales. Así aseguras que lo más importante tiene fecha definida.
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Distribuye las capacitaciones en el tiempo</strong>
                        <p class="mb-0 mt-2">
                            Evita amontonar muchas capacitaciones en el mismo mes. Espacía las fechas meta para 
                            que el trabajador tenga tiempo de completar cada una adecuadamente.
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Revisa y ajusta periódicamente</strong>
                        <p class="mb-0 mt-2">
                            Programa revisiones mensuales para ajustar fechas según el avance real. No dejes 
                            acumular muchas unidades vencidas; es mejor extender las fechas a tiempo.
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Comunica las fechas a los trabajadores</strong>
                        <p class="mb-0 mt-2">
                            No asumas que el trabajador revisará el sistema. Cuando establezcas o cambies fechas 
                            importantes, comunícaselo directamente por correo o reunión.
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Guarda con frecuencia</strong>
                        <p class="mb-0 mt-2">
                            No acumules 20 o 30 cambios sin guardar. Guarda cada vez que completes la planeación 
                            de un grupo de unidades relacionadas. Así reduces el riesgo de perder trabajo.
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Usa las alertas visuales como herramienta de gestión</strong>
                        <p class="mb-0 mt-2">
                            Filtra o busca las unidades con badges de "Vencida" o "Vence Pronto" para hacer 
                            seguimiento proactivo y evitar incumplimientos masivos.
                        </p>
                    </div>

                </div>

                <!-- TARJETA PARA REPORTAR BUGS -->
                <div class="bug-report-card">
                    <i class="bi bi-bug-fill icon-large"></i>
                    <h4 class="mb-3">¿Encontraste un problema o tienes una sugerencia?</h4>
                    <p class="mb-4">
                        Si experimentaste un error, algo no funciona como esperas, o tienes 
                        una sugerencia para mejorar el sistema, repórtalo aquí.
                    </p>
                    <a href="../report-bug.html" class="btn btn-light btn-lg">
                        <i class="bi bi-exclamation-triangle me-2"></i>Reportar Bug o Problema
                    </a>
                </div>

            </div>
        </div>

    </div>

    <!-- BOTÓN FLOTANTE PARA REPORTAR BUGS -->
    <a href="../report-bug.html" class="btn btn-danger btn-lg floating-bug-button" title="Reportar Bug">
        <i class="bi bi-bug-fill me-2"></i>Reportar Bug
    </a>

    <!-- SCRIPTS - ORDEN CRÍTICO -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/js/config.js"></script>
    
    <script>
        // ==========================================
        // VARIABLES GLOBALES
        // ==========================================
        let currentUser = null;

        // ==========================================
        // CONFIGURACIÓN DE LA PÁGINA
        // ==========================================
        const PAGE_CONFIG = {
            moduleName: 'Formación',
            modulePath: 'training',
            pageTitle: 'Gestionar Fechas Tentativas',
            pagePath: 'manage-deadlines.html',
            moduleDescription: 'Establecer y actualizar fechas meta para el cumplimiento de unidades formativas'
        };

        // ==========================================
        // INICIALIZACIÓN
        // ==========================================
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('📖 Iniciando página de manual...');
            
            try {
                // Verificar si existe la función de colores corporativos
                if (typeof loadAndApplyBrandColors === 'function') {
                    await loadAndApplyBrandColors();
                }
                
                // Verificar sesión si la función existe
                if (typeof getStoredSession === 'function') {
                    const session = getStoredSession();
                    if (session && session.user) {
                        currentUser = session.user;
                    }
                }
                
                // Actualizar información en la página
                updatePageInfo();
                
                console.log('✅ Página de manual lista');
                
            } catch (error) {
                console.error('❌ Error inicializando página:', error);
                if (typeof showMessage === 'function') {
                    showMessage('Error al cargar la página: ' + error.message, 'danger');
                }
            }
        });

        // ==========================================
        // ACTUALIZAR INFORMACIÓN DE LA PÁGINA
        // ==========================================
        function updatePageInfo() {
            // Actualizar title
            document.title = `Manual - ${PAGE_CONFIG.moduleName} - ${PAGE_CONFIG.pageTitle} - SchoolNet`;
        }

        // ==========================================
        // UTILIDADES DE LOADING
        // ==========================================
        function showLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.remove('hidden');
            }
        }

        function hideLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.add('hidden');
            }
        }

        // ==========================================
        // FUNCIÓN DE MENSAJES
        // ==========================================
        function showMessage(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            if (!alertContainer) return;
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertContainer.appendChild(alertDiv);
            
            // Auto-remove después de 5 segundos
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

    </script>
</body>
</html>
