<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- VERSIÓN DE LA PÁGINA -->
    <meta name="page-version" content="26.01.26.09.03">
    
    <title>Manual - Modalidades - SchoolNet</title>
    
    <!-- Bootstrap CSS - VERSIÓN FIJA PROBADA -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-overlay.hidden {
            display: none;
        }
        
        .loading-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Encabezado discreto */
        .manual-header {
            background: #f8f9fa;
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding: 1.5rem 0;
            margin-bottom: 2rem;
        }

        .manual-header h1 {
            font-size: 1.75rem;
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 0.25rem;
        }

        .manual-header .subtitle {
            color: #6c757d;
            font-size: 0.95rem;
        }

        /* Info card */
        .info-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Secciones del manual */
        .section-title {
            color: var(--system-primary-color, #1B365D);
            font-size: 1.5rem;
            margin-top: 2.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e9ecef;
        }

        /* Tarjetas de pasos */
        .step-card {
            background: #f8f9fa;
            border-left: 4px solid var(--system-primary-color, #1B365D);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 1rem;
        }

        /* Cajas de información */
        .info-box {
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin-bottom: 1rem;
        }

        .info-box.warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
        }

        .info-box.tip {
            background: #d1ecf1;
            border-left: 4px solid #0dcaf0;
        }

        .info-box.important {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
        }

        .info-box.success {
            background: #d1e7dd;
            border-left: 4px solid #198754;
        }

        /* Listas personalizadas */
        .custom-list {
            list-style: none;
            padding-left: 0;
        }

        .custom-list li {
            padding: 0.5rem 0;
            padding-left: 2rem;
            position: relative;
        }

        .custom-list li::before {
            content: "✓";
            position: absolute;
            left: 0;
            color: var(--system-primary-color, #1B365D);
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* Tarjeta para reportar bugs - USANDO COLOR PRIMARIO PARA MEJOR CONTRASTE */
        .bug-report-card {
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 12px;
            padding: 2rem;
            margin-top: 3rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .bug-report-card h5 {
            color: white;
        }

        /* Botón flotante para reportar bugs */
        .floating-bug-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            background: var(--system-primary-color, #1B365D) !important;
            border-color: var(--system-primary-color, #1B365D) !important;
        }

        .floating-bug-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
            opacity: 0.9;
        }

        .icon-large {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        /* Tabla de ejemplo */
        .example-table {
            font-size: 0.9rem;
        }

        .example-table th {
            background: #f8f9fa;
        }
    </style>
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="mb-0">Cargando...</p>
        </div>
    </div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="container-fluid">

        <!-- ENCABEZADO DISCRETO -->
        <div class="manual-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1>
                            <i class="bi bi-book me-2"></i>
                            Manual: Modalidades
                        </h1>
                        <p class="subtitle mb-0">Formación - Gestionar Modalidades</p>
                    </div>
                    <div class="col-md-4 text-md-end mt-3 mt-md-0">
                        <a href="../../modules/training/modalities.html" class="btn btn-outline-primary">
                            <i class="bi bi-arrow-left me-1"></i>Volver al Módulo
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- CONTENEDOR DE ALERTAS -->
        <div id="alertContainer"></div>

        <div class="row">
            <div class="col-lg-9 mx-auto">

                <!-- INFORMACIÓN CONTEXTUAL -->
                <div class="info-card">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h6 class="text-muted mb-2">Manual de:</h6>
                            <h5 class="mb-1"><strong id="display-module">Formación</strong></h5>
                            <p class="text-muted mb-0 small" id="display-page">Gestionar Modalidades</p>
                        </div>
                        <div class="col-md-6 text-md-end mt-3 mt-md-0">
                            <p class="small text-muted mb-0">
                                <i class="bi bi-info-circle me-1"></i>
                                Si tienes dudas o encuentras algún problema,<br>
                                puedes reportarlo usando el botón de abajo.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ========================================== -->
                <!-- CONTENIDO DEL MANUAL -->
                <!-- ========================================== -->

                <!-- SECCIÓN 1: ¿QUÉ ES? -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-info-circle me-2"></i>
                        ¿Qué son las Modalidades de Formación?
                    </h2>
                    
                    <div class="step-card">
                        <p class="lead mb-3">
                            Las <strong>Modalidades</strong> son los formatos o tipos de entrega en que se imparten las unidades formativas. Definen <strong>cómo</strong> se lleva a cabo la capacitación: presencial, virtual sincrónica, virtual asincrónica, híbrida, entre otras.
                        </p>
                        
                        <p>
                            Cada modalidad tiene características específicas que determinan la forma de interacción entre facilitadores y participantes, los recursos necesarios y la logística requerida para su implementación.
                        </p>

                        <div class="info-box tip mt-3">
                            <strong><i class="bi bi-lightbulb me-2"></i>¿Para qué sirven?</strong>
                            <p class="mb-0 mt-2">
                                Permiten clasificar las capacitaciones por su formato de entrega, facilitan la planificación logística, ayudan a asignar recursos apropiados y permiten generar reportes por tipo de formación.
                            </p>
                        </div>
                    </div>

                    <div class="step-card">
                        <h5 class="mb-3">Ejemplos de Modalidades</h5>
                        <table class="table table-sm example-table">
                            <thead>
                                <tr>
                                    <th>Modalidad</th>
                                    <th>Descripción</th>
                                    <th style="width: 15%;" class="text-center">Facilitador</th>
                                    <th style="width: 15%;" class="text-center">Sincrónica</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Presencial</strong></td>
                                    <td>Capacitación en espacio físico con presencia de facilitador y participantes</td>
                                    <td class="text-center"><span class="badge bg-primary">Sí</span></td>
                                    <td class="text-center"><span class="badge bg-info">Sí</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Virtual Sincrónica</strong></td>
                                    <td>Capacitación en línea en tiempo real (videoconferencia)</td>
                                    <td class="text-center"><span class="badge bg-primary">Sí</span></td>
                                    <td class="text-center"><span class="badge bg-info">Sí</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Virtual Asincrónica</strong></td>
                                    <td>Autoformación en línea sin horario fijo (cursos pregrabados, LMS)</td>
                                    <td class="text-center"><span class="badge bg-secondary">No</span></td>
                                    <td class="text-center"><span class="badge bg-secondary">No</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Híbrida</strong></td>
                                    <td>Combinación de sesiones presenciales y virtuales</td>
                                    <td class="text-center"><span class="badge bg-primary">Sí</span></td>
                                    <td class="text-center"><span class="badge bg-info">Sí</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Taller Práctico</strong></td>
                                    <td>Sesión presencial centrada en práctica y aplicación</td>
                                    <td class="text-center"><span class="badge bg-primary">Sí</span></td>
                                    <td class="text-center"><span class="badge bg-info">Sí</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- SECCIÓN 2: CARACTERÍSTICAS PRINCIPALES -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-star me-2"></i>
                        Características principales
                    </h2>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="step-card">
                                <h5><i class="bi bi-list-ul text-primary me-2"></i>Catálogo flexible</h5>
                                <p class="mb-0">Visualiza todas las modalidades disponibles con sus características y cantidad de unidades asociadas.</p>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="step-card">
                                <h5><i class="bi bi-plus-circle text-success me-2"></i>Creación personalizada</h5>
                                <p class="mb-0">Define modalidades específicas para tu institución con propiedades configurables.</p>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="step-card">
                                <h5><i class="bi bi-sliders text-info me-2"></i>Propiedades configurables</h5>
                                <p class="mb-0">Marca si requiere facilitador y si es sincrónica para clasificar automáticamente las necesidades logísticas.</p>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="step-card">
                                <h5><i class="bi bi-toggle-on text-warning me-2"></i>Control de estado</h5>
                                <p class="mb-0">Activa o desactiva modalidades según necesidad. Las inactivas no están disponibles para nuevas unidades.</p>
                            </div>
                        </div>
                    </div>

                    <div class="step-card mt-4">
                        <h5 class="mb-3">Propiedades de las modalidades</h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <h6 class="text-primary"><i class="bi bi-person-video2 me-2"></i>Requiere Facilitador</h6>
                                <p class="small mb-3">
                                    Indica si la modalidad necesita un facilitador o instructor asignado. Las modalidades que requieren facilitador necesitan que se asigne un responsable a la capacitación.
                                </p>
                                <p class="small mb-0"><strong>Ejemplos:</strong></p>
                                <ul class="small">
                                    <li><strong>SÍ:</strong> Presencial, Virtual Sincrónica, Taller</li>
                                    <li><strong>NO:</strong> Virtual Asincrónica, Autoestudio</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6 class="text-info"><i class="bi bi-clock-history me-2"></i>Es Sincrónica</h6>
                                <p class="small mb-3">
                                    Indica si la formación requiere participación en tiempo real o si los participantes pueden acceder en su propio horario.
                                </p>
                                <p class="small mb-0"><strong>Ejemplos:</strong></p>
                                <ul class="small">
                                    <li><strong>SÍ:</strong> Presencial, Virtual en vivo, Webinar</li>
                                    <li><strong>NO:</strong> Cursos pregrabados, LMS, E-learning</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN 3: ANTES DE COMENZAR -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-clipboard-check me-2"></i>
                        Antes de comenzar
                    </h2>

                    <div class="step-card">
                        <h5 class="mb-3">Requisitos previos</h5>
                        
                        <ul class="custom-list">
                            <li><strong>Permiso necesario:</strong> Debes tener el permiso "Gestionar modalidades" asignado en tu cuenta.</li>
                            <li><strong>Análisis de necesidades:</strong> Identifica qué tipos de formación ofrece tu institución.</li>
                            <li><strong>Claridad conceptual:</strong> Comprende las diferencias entre modalidades sincrónicas/asincrónicas y con/sin facilitador.</li>
                        </ul>

                        <div class="info-box warning mt-3">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Importante</strong>
                            <p class="mb-0">
                                Define solo las modalidades que realmente utilizas. Un catálogo muy amplio con modalidades no utilizadas dificulta la gestión y puede generar confusión.
                            </p>
                        </div>
                    </div>

                    <div class="step-card">
                        <h5 class="mb-3">Diferencias clave entre modalidades</h5>
                        
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Criterio</th>
                                    <th>Sincrónica</th>
                                    <th>Asincrónica</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Horario</strong></td>
                                    <td>Horario fijo, todos al mismo tiempo</td>
                                    <td>Horario flexible, cada quien a su ritmo</td>
                                </tr>
                                <tr>
                                    <td><strong>Interacción</strong></td>
                                    <td>En tiempo real con facilitador</td>
                                    <td>Diferida o sin interacción directa</td>
                                </tr>
                                <tr>
                                    <td><strong>Ejemplos</strong></td>
                                    <td>Clase presencial, videoconferencia</td>
                                    <td>Curso en plataforma, videos pregrabados</td>
                                </tr>
                                <tr>
                                    <td><strong>Ventaja</strong></td>
                                    <td>Retroalimentación inmediata</td>
                                    <td>Flexibilidad de tiempo y lugar</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="step-card">
                        <h5 class="mb-3">Buenas prácticas de nomenclatura</h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <h6 class="text-success"><i class="bi bi-check-circle me-2"></i>Recomendado:</h6>
                                <ul>
                                    <li>Nombres claros y auto-explicativos</li>
                                    <li>Usar términos estándar reconocibles</li>
                                    <li>Especificar el medio (presencial/virtual)</li>
                                    <li>Indicar si es sincrónica en el nombre si es relevante</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6 class="text-danger"><i class="bi bi-x-circle me-2"></i>Evitar:</h6>
                                <ul>
                                    <li>Nombres ambiguos o vagos</li>
                                    <li>Siglas desconocidas sin explicación</li>
                                    <li>Redundancias innecesarias</li>
                                    <li>Modalidades muy similares entre sí</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN 4: GUÍA PASO A PASO -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-list-ol me-2"></i>
                        Guía paso a paso
                    </h2>

                    <!-- CREAR NUEVA MODALIDAD -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">1</span>
                            Crear una nueva modalidad
                        </h5>
                        
                        <p class="mt-3 mb-2"><strong>Para agregar una nueva modalidad al catálogo:</strong></p>
                        <ol>
                            <li class="mb-2">En la página principal, haz clic en el botón azul <strong>"Nueva Modalidad"</strong> ubicado en la parte superior derecha</li>
                            <li class="mb-2">Se abrirá un formulario con los siguientes campos:
                                <ul class="mt-2">
                                    <li><strong>Nombre de la Modalidad:</strong> Campo obligatorio (ej: "Presencial", "Virtual Sincrónica")</li>
                                    <li><strong>Descripción:</strong> Campo opcional. Explica el formato y características de esta modalidad</li>
                                    <li><strong>Requiere Facilitador:</strong> Checkbox. Marca si necesita un instructor asignado (activado por defecto)</li>
                                    <li><strong>Es Sincrónica:</strong> Checkbox. Marca si requiere participación en tiempo real (activado por defecto)</li>
                                    <li><strong>Estado:</strong> Campo obligatorio. Selecciona "Activo" (por defecto) o "Inactivo"</li>
                                </ul>
                            </li>
                            <li class="mb-2">Completa el nombre de la modalidad (campo obligatorio)</li>
                            <li class="mb-2">Agrega una descripción para clarificar las características</li>
                            <li class="mb-2">Ajusta los checkboxes según las características de la modalidad:
                                <ul class="mt-2">
                                    <li>Desmarca "Requiere Facilitador" solo para modalidades de autoestudio</li>
                                    <li>Desmarca "Es Sincrónica" para cursos asincrónicos o autoformativos</li>
                                </ul>
                            </li>
                            <li class="mb-2">Haz clic en el botón verde <strong>"Guardar"</strong></li>
                            <li>La nueva modalidad aparecerá en la tabla principal</li>
                        </ol>

                        <div class="info-box success mt-3">
                            <strong><i class="bi bi-check-circle me-2"></i>Confirmación</strong>
                            <p class="mb-0">
                                Verás un mensaje verde confirmando que la modalidad fue creada exitosamente. La nueva modalidad aparecerá inmediatamente en la lista ordenada alfabéticamente.
                            </p>
                        </div>
                    </div>

                    <!-- VER LISTADO -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">2</span>
                            Consultar el catálogo de modalidades
                        </h5>
                        
                        <p class="mt-3 mb-2"><strong>La tabla muestra la siguiente información:</strong></p>
                        <ul>
                            <li><strong>#:</strong> Número de orden en la lista actual</li>
                            <li><strong>Nombre:</strong> Nombre completo de la modalidad</li>
                            <li><strong>Descripción:</strong> Información adicional sobre la modalidad</li>
                            <li><strong>Facilitador:</strong> Badge azul "Sí" si requiere facilitador, gris "No" si es autoformación</li>
                            <li><strong>Sincrónica:</strong> Badge azul "Sí" si es en tiempo real, gris "No" si es asincrónica</li>
                            <li><strong>Unidades:</strong> Cantidad de unidades formativas que usan esta modalidad (badge amarillo con número)</li>
                            <li><strong>Estado:</strong> Badge verde si está activa, gris si está inactiva</li>
                            <li><strong>Acciones:</strong> Botones para editar o cambiar estado</li>
                        </ul>

                        <div class="info-box tip mt-3">
                            <strong><i class="bi bi-lightbulb me-2"></i>Interpretación rápida</strong>
                            <p class="mb-0">
                                Los badges de "Facilitador" y "Sincrónica" te permiten identificar rápidamente las necesidades logísticas de cada modalidad.
                            </p>
                        </div>
                    </div>

                    <!-- EDITAR MODALIDAD -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">3</span>
                            Editar una modalidad existente
                        </h5>
                        
                        <p class="mt-3 mb-2"><strong>Para modificar una modalidad:</strong></p>
                        <ol>
                            <li class="mb-2">Ubica la modalidad que deseas editar en la tabla</li>
                            <li class="mb-2">En la columna "Acciones", haz clic en el botón azul con icono de lápiz <i class="bi bi-pencil"></i></li>
                            <li class="mb-2">Se abrirá el formulario con los datos actuales de la modalidad prellenados</li>
                            <li class="mb-2">Modifica los campos que necesites cambiar</li>
                            <li class="mb-2">Ajusta los checkboxes si las características han cambiado</li>
                            <li class="mb-2">Haz clic en <strong>"Guardar"</strong></li>
                            <li>Los cambios se aplicarán inmediatamente</li>
                        </ol>

                        <div class="info-box warning mt-3">
                            <strong><i class="bi bi-info-circle me-2"></i>Modalidades con unidades asociadas</strong>
                            <p class="mb-0 mt-2">
                                Si la modalidad está asociada a unidades formativas, verás una alerta informativa mostrando cuántas unidades están vinculadas. Ten cuidado al modificar las características, ya que pueden afectar la planificación existente.
                            </p>
                        </div>
                    </div>

                    <!-- CAMBIAR ESTADO -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">4</span>
                            Activar o desactivar una modalidad
                        </h5>
                        
                        <p class="mt-3 mb-2"><strong>Para cambiar el estado de una modalidad:</strong></p>
                        <ol>
                            <li class="mb-2">Ubica la modalidad en la tabla</li>
                            <li class="mb-2">En la columna "Acciones", observa el segundo botón:
                                <ul class="mt-2">
                                    <li>Si está activa: verás un icono amarillo <i class="bi bi-toggle-on"></i> (desactivar)</li>
                                    <li>Si está inactiva: verás un icono verde <i class="bi bi-toggle-off"></i> (activar)</li>
                                </ul>
                            </li>
                            <li class="mb-2">Haz clic en el botón correspondiente</li>
                            <li class="mb-2">Confirma la acción en el mensaje que aparece</li>
                            <li>El estado cambiará inmediatamente</li>
                        </ol>

                        <div class="info-box important mt-3">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Efecto de desactivar una modalidad</strong>
                            <p class="mb-2 mt-2">
                                Cuando desactivas una modalidad:
                            </p>
                            <ul class="mb-0">
                                <li>Ya NO estará disponible para asignar a nuevas unidades formativas</li>
                                <li>Las unidades formativas que ya usan esta modalidad NO se ven afectadas</li>
                                <li>La modalidad permanece en la base de datos y puede reactivarse</li>
                                <li>Útil para modalidades que temporalmente no se usan (ej: presencial durante pandemia)</li>
                            </ul>
                        </div>
                    </div>

                    <!-- CONFIGURAR CHECKBOXES -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">5</span>
                            Configurar las características (checkboxes)
                        </h5>
                        
                        <p class="mt-3 mb-2"><strong>Guía de decisión para los checkboxes:</strong></p>
                        
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Modalidad</th>
                                        <th class="text-center">Requiere Facilitador</th>
                                        <th class="text-center">Es Sincrónica</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Presencial</td>
                                        <td class="text-center">✅ Sí</td>
                                        <td class="text-center">✅ Sí</td>
                                    </tr>
                                    <tr>
                                        <td>Virtual Sincrónica (Zoom, Teams)</td>
                                        <td class="text-center">✅ Sí</td>
                                        <td class="text-center">✅ Sí</td>
                                    </tr>
                                    <tr>
                                        <td>Virtual Asincrónica (LMS, e-learning)</td>
                                        <td class="text-center">❌ No</td>
                                        <td class="text-center">❌ No</td>
                                    </tr>
                                    <tr>
                                        <td>Híbrida</td>
                                        <td class="text-center">✅ Sí</td>
                                        <td class="text-center">✅ Sí</td>
                                    </tr>
                                    <tr>
                                        <td>Taller Práctico</td>
                                        <td class="text-center">✅ Sí</td>
                                        <td class="text-center">✅ Sí</td>
                                    </tr>
                                    <tr>
                                        <td>Autoestudio (lectura, videos)</td>
                                        <td class="text-center">❌ No</td>
                                        <td class="text-center">❌ No</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="info-box tip mt-3">
                            <strong><i class="bi bi-lightbulb me-2"></i>Regla práctica</strong>
                            <p class="mb-0">
                                Si los participantes deben estar conectados a una hora específica = <strong>Sincrónica</strong>. Si hay un instructor guiando la sesión = <strong>Requiere Facilitador</strong>.
                            </p>
                        </div>
                    </div>
                </section>

                <!-- SECCIÓN 5: SOLUCIÓN DE PROBLEMAS -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-question-circle me-2"></i>
                        Solución de problemas comunes
                    </h2>

                    <div class="step-card">
                        <h5 class="text-danger mb-3"><i class="bi bi-exclamation-triangle me-2"></i>No puedo crear una modalidad con cierto nombre</h5>
                        <p><strong>Causa probable:</strong></p>
                        <p>Ya existe una modalidad con ese nombre exacto en el sistema.</p>
                        <p><strong>Solución:</strong></p>
                        <ul>
                            <li>Verifica si la modalidad ya existe en la lista (puede estar inactiva)</li>
                            <li>Si existe pero está inactiva, actívala en lugar de crear una nueva</li>
                            <li>Si necesitas una variante, agrégale un calificador específico (ej: "Virtual Sincrónica - Básica")</li>
                        </ul>
                    </div>

                    <div class="step-card">
                        <h5 class="text-warning mb-3"><i class="bi bi-exclamation-triangle me-2"></i>No sé cómo configurar los checkboxes</h5>
                        <p><strong>Solución:</strong></p>
                        <p>Hazte estas preguntas:</p>
                        <ul>
                            <li><strong>Para "Requiere Facilitador":</strong> ¿Hay un instructor que dirige o guía la capacitación? Si SÍ → marca el checkbox</li>
                            <li><strong>Para "Es Sincrónica":</strong> ¿Los participantes deben conectarse a una hora específica? Si SÍ → marca el checkbox</li>
                        </ul>
                        <p class="mt-2"><strong>Ejemplo:</strong> Un curso en Moodle sin instructor y que cada quien hace a su ritmo: ambos checkboxes deben estar DESMARCADOS.</p>
                    </div>

                    <div class="step-card">
                        <h5 class="text-danger mb-3"><i class="bi bi-exclamation-triangle me-2"></i>El contador de unidades no se actualiza</h5>
                        <p><strong>Solución:</strong></p>
                        <ul>
                            <li>Haz clic en el botón "Actualizar" en la parte superior de la página</li>
                            <li>El contador refleja las unidades formativas activas que usan esta modalidad</li>
                            <li>Si el problema persiste, recarga la página completa (F5)</li>
                        </ul>
                    </div>

                    <div class="step-card">
                        <h5 class="text-warning mb-3"><i class="bi bi-exclamation-triangle me-2"></i>Tengo muchas modalidades similares</h5>
                        <p><strong>Recomendación:</strong></p>
                        <p>Si tienes modalidades muy parecidas (ej: "Virtual Zoom" y "Virtual Teams"), considera consolidarlas en una sola más general (ej: "Virtual Sincrónica").</p>
                        <p><strong>Pasos:</strong></p>
                        <ul>
                            <li>Decide cuál modalidad mantendrás</li>
                            <li>Desactiva las modalidades redundantes</li>
                            <li>Un catálogo simple es más fácil de gestionar y menos confuso para los usuarios</li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN 6: BUENAS PRÁCTICAS -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-award me-2"></i>
                        Buenas prácticas
                    </h2>

                    <div class="step-card">
                        <h5 class="mb-3"><i class="bi bi-check-circle text-success me-2"></i>Al crear modalidades</h5>
                        
                        <ul class="custom-list">
                            <li>Mantén un catálogo simple con 4-8 modalidades principales</li>
                            <li>Usa nombres estándar que todos comprendan fácilmente</li>
                            <li>Completa siempre las descripciones para clarificar características</li>
                            <li>Configura correctamente los checkboxes desde el inicio</li>
                            <li>Evita crear modalidades muy específicas que se usen poco</li>
                            <li>Piensa en las necesidades logísticas que implica cada modalidad</li>
                        </ul>
                    </div>

                    <div class="step-card">
                        <h5 class="mb-3"><i class="bi bi-shield-check text-info me-2"></i>Mantenimiento del catálogo</h5>
                        
                        <ul class="custom-list">
                            <li>Revisa periódicamente si todas las modalidades activas se siguen usando</li>
                            <li>Desactiva modalidades temporalmente no disponibles (ej: presencial durante pandemia)</li>
                            <li>Actualiza las descripciones si cambian las herramientas o plataformas usadas</li>
                            <li>Consolida modalidades similares para simplificar el catálogo</li>
                            <li>Comunica cambios importantes al equipo de planificación</li>
                        </ul>
                    </div>

                    <div class="step-card">
                        <h5 class="mb-3"><i class="bi bi-people text-warning me-2"></i>Planificación logística</h5>
                        
                        <ul class="custom-list">
                            <li>Usa el filtro de "Requiere Facilitador" para planificar asignación de instructores</li>
                            <li>Las modalidades sincrónicas requieren coordinación de horarios</li>
                            <li>Las modalidades asincrónicas permiten mayor flexibilidad</li>
                            <li>Considera recursos necesarios (salas, equipos, licencias) según modalidad</li>
                            <li>Revisa capacidad institucional antes de ofrecer nuevas modalidades</li>
                        </ul>
                    </div>
                </section>

                <!-- SECCIÓN 7: PREGUNTAS FRECUENTES -->
                <section>
                    <h2 class="section-title">
                        <i class="bi bi-chat-dots me-2"></i>
                        Preguntas frecuentes
                    </h2>

                    <div class="accordion" id="faqAccordion">
                        
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                                    ¿Cuántas modalidades debería tener en el catálogo?
                                </button>
                            </h2>
                            <div id="faq1" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    Se recomienda mantener entre 4 y 8 modalidades. Lo más común es tener: Presencial, Virtual Sincrónica, Virtual Asincrónica, e Híbrida. Agrega otras solo si realmente las usas con frecuencia. Un catálogo muy amplio dificulta la gestión sin aportar valor real.
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                                    ¿Qué diferencia hay entre sincrónica y asincrónica?
                                </button>
                            </h2>
                            <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    <strong>Sincrónica</strong> significa que todos participan al mismo tiempo en un horario fijo (ej: clase en vivo, videoconferencia). <strong>Asincrónica</strong> significa que cada participante accede al contenido en su propio horario (ej: curso pregrabado, lecturas en plataforma). La sincronía requiere coordinación de agendas, mientras que la asincronía ofrece flexibilidad.
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                                    ¿Cuándo marco "Requiere Facilitador"?
                                </button>
                            </h2>
                            <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    Marca este checkbox cuando la capacitación necesita un instructor o facilitador que dirija, guíe o coordine las sesiones. NO lo marques para modalidades de autoformación donde el participante trabaja de manera independiente con materiales (videos, lecturas, ejercicios) sin interacción con un instructor.
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq4">
                                    ¿Puedo tener una modalidad híbrida que sea parte sincrónica y parte asincrónica?
                                </button>
                            </h2>
                            <div id="faq4" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    Sí, puedes crear una modalidad "Híbrida" o "Blended". Para los checkboxes, marca según la característica PREDOMINANTE. Si tiene sesiones sincrónicas importantes, márcala como sincrónica y con facilitador. La descripción puede especificar que combina elementos de ambos tipos. Lo importante es que el checkbox refleje las necesidades logísticas principales.
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq5">
                                    ¿Qué pasa si cambio los checkboxes de una modalidad que ya tiene unidades asociadas?
                                </button>
                            </h2>
                            <div id="faq5" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    Los cambios se aplican inmediatamente a la definición de la modalidad. Esto puede afectar reportes o filtros que usen estas características. Por ejemplo, si cambias una modalidad de "requiere facilitador" a "no requiere facilitador", podría afectar la planificación de recursos. Es mejor hacer estos cambios cuando la modalidad aún no está ampliamente utilizada.
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq6">
                                    ¿Debería crear modalidades específicas por herramienta (Zoom, Teams, Moodle)?
                                </button>
                            </h2>
                            <div id="faq6" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    No es recomendable. Es mejor usar modalidades genéricas como "Virtual Sincrónica" en lugar de crear una para cada herramienta. La herramienta específica puede cambiar, pero la modalidad permanece. Si necesitas registrar la herramienta, puedes hacerlo en la descripción de la unidad formativa específica, no en la modalidad.
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq7">
                                    ¿Para qué sirve saber si una modalidad requiere facilitador?
                                </button>
                            </h2>
                            <div id="faq7" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    Esta información es crucial para la planificación logística. Las modalidades que requieren facilitador necesitan: (1) asignar un instructor disponible, (2) coordinar su agenda, (3) preparar materiales de apoyo, (4) considerar su carga laboral. Las modalidades sin facilitador pueden implementarse más fácilmente porque dependen solo de recursos digitales.
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq8">
                                    ¿Puedo tener dos modalidades con las mismas características?
                                </button>
                            </h2>
                            <div id="faq8" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    Técnicamente sí, pero no es recomendable. Si dos modalidades tienen los mismos checkboxes marcados, probablemente sean redundantes. Por ejemplo, "Taller Presencial" y "Clase Presencial" podrían consolidarse en una sola "Presencial". Mantén el catálogo simple diferenciando solo cuando hay una razón operativa clara.
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq9">
                                    ¿Qué modalidad uso para un webinar o conferencia virtual?
                                </button>
                            </h2>
                            <div id="faq9" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    Un webinar o conferencia virtual es típicamente "Virtual Sincrónica" (todos conectados al mismo tiempo) con facilitador. Si quieres diferenciarla, puedes crear una modalidad específica "Webinar" o "Conferencia Virtual" con ambos checkboxes marcados. Sin embargo, muchas instituciones simplemente la incluyen bajo "Virtual Sincrónica".
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq10">
                                    ¿Quién puede gestionar las modalidades?
                                </button>
                            </h2>
                            <div id="faq10" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    Solo los usuarios que tengan el permiso "Gestionar modalidades" pueden acceder a esta página y realizar cambios. Este permiso generalmente se asigna a coordinadores de formación, responsables de desarrollo profesional y administradores del sistema. Si necesitas agregar una modalidad nueva, contacta a estas personas.
                                </div>
                            </div>
                        </div>

                    </div>
                </section>

                <!-- ========================================== -->
                <!-- FIN DEL CONTENIDO DEL MANUAL -->
                <!-- ========================================== -->

                <!-- TARJETA PARA REPORTAR BUGS -->
                <div class="bug-report-card">
                    <i class="bi bi-bug-fill icon-large"></i>
                    <h4 class="mb-3">¿Encontraste un problema o tienes una sugerencia?</h4>
                    <p class="mb-4">
                        Si experimentaste un error, algo no funciona como esperas, o tienes 
                        una sugerencia para mejorar el sistema, repórtalo aquí.
                    </p>
                    <a href="../report-bug.html" class="btn btn-light btn-lg">
                        <i class="bi bi-exclamation-triangle me-2"></i>Reportar Bug o Problema
                    </a>
                </div>

            </div>
        </div>

    </div>

    <!-- BOTÓN FLOTANTE PARA REPORTAR BUGS -->
    <a href="../report-bug.html" class="btn btn-danger btn-lg floating-bug-button" title="Reportar Bug">
        <i class="bi bi-bug-fill me-2"></i>Reportar Bug
    </a>

    <!-- SCRIPTS - ORDEN CRÍTICO -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/js/config.js"></script>
    
    <script>
        // ==========================================
        // VARIABLES GLOBALES
        // ==========================================
        let currentUser = null;

        // ==========================================
        // CONFIGURACIÓN DE LA PÁGINA
        // ==========================================
        const PAGE_CONFIG = {
            moduleName: 'Formación',
            modulePath: 'training',
            pageTitle: 'Gestionar Modalidades',
            pagePath: 'modalities.html',
            moduleDescription: 'Tipos de formación (Presencial, Virtual, etc.)'
        };

        // ==========================================
        // INICIALIZACIÓN
        // ==========================================
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('📖 Iniciando página de manual...');
            
            try {
                // Verificar si existe la función de colores corporativos
                if (typeof loadAndApplyBrandColors === 'function') {
                    await loadAndApplyBrandColors();
                }
                
                // Verificar sesión si la función existe
                if (typeof getStoredSession === 'function') {
                    const session = getStoredSession();
                    if (session && session.user) {
                        currentUser = session.user;
                    }
                }
                
                // Actualizar información en la página
                updatePageInfo();
                
                console.log('✅ Página de manual lista');
                
            } catch (error) {
                console.error('❌ Error inicializando página:', error);
                if (typeof showMessage === 'function') {
                    showMessage('Error al cargar la página: ' + error.message, 'danger');
                }
            }
        });

        // ==========================================
        // ACTUALIZAR INFORMACIÓN DE LA PÁGINA
        // ==========================================
        function updatePageInfo() {
            // Actualizar title
            document.title = `Manual - ${PAGE_CONFIG.moduleName} - ${PAGE_CONFIG.pageTitle} - SchoolNet`;
        }

        // ==========================================
        // UTILIDADES DE LOADING
        // ==========================================
        function showLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.remove('hidden');
            }
        }

        function hideLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.add('hidden');
            }
        }

        // ==========================================
        // FUNCIÓN DE MENSAJES
        // ==========================================
        function showMessage(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            if (!alertContainer) return;
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertContainer.appendChild(alertDiv);
            
            // Auto-remove después de 5 segundos
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

    </script>
</body>
</html>
