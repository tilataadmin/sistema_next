<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- VERSIÓN DE LA PÁGINA -->
    <meta name="page-version" content="26.01.26.16.00">
    
    <title>Manual - Formación - Registrar Cumplimiento de Unidades - SchoolNet</title>
    
    <!-- Bootstrap CSS - VERSIÓN FIJA PROBADA -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-overlay.hidden {
            display: none;
        }
        
        .loading-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Encabezado discreto */
        .manual-header {
            background: #f8f9fa;
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding: 1.5rem 0;
            margin-bottom: 2rem;
        }

        .manual-header h1 {
            font-size: 1.75rem;
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 0.25rem;
        }

        .manual-header .subtitle {
            color: #6c757d;
            font-size: 0.95rem;
        }

        /* Info card */
        .info-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Tarjeta para reportar bugs - COLOR PRIMARIO */
        .bug-report-card {
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .bug-report-card h5 {
            color: white;
        }

        /* Botón flotante para reportar bugs - COLOR PRIMARIO */
        .floating-bug-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            background: var(--system-primary-color, #1B365D) !important;
            border-color: var(--system-primary-color, #1B365D) !important;
        }

        .floating-bug-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
            opacity: 0.9;
        }

        .icon-large {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        /* Cajas de información */
        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #0d6efd;
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
        }

        .success-box {
            background: #d1e7dd;
            border-left: 4px solid #198754;
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
        }

        .danger-box {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
        }

        /* Tarjetas de pasos */
        .step-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .step-card h5 {
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 1rem;
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 0.75rem;
        }

        /* Listas con estilo */
        .feature-list {
            list-style: none;
            padding-left: 0;
        }

        .feature-list li {
            padding-left: 1.75rem;
            margin-bottom: 0.75rem;
            position: relative;
        }

        .feature-list li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: #198754;
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* Secciones del manual */
        .manual-section {
            margin-bottom: 3rem;
        }

        .manual-section h3 {
            color: var(--system-primary-color, #1B365D);
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .manual-section h4 {
            color: #495057;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }

        /* FAQ */
        .faq-item {
            margin-bottom: 1.5rem;
        }

        .faq-question {
            font-weight: 600;
            color: #495057;
            margin-bottom: 0.5rem;
        }

        .faq-answer {
            color: #6c757d;
            padding-left: 1.5rem;
        }

        /* Ejemplo visual */
        .example-box {
            background: #f8f9fa;
            border: 2px dashed #8b5cf6;
            border-radius: 8px;
            padding: 1.25rem;
            margin: 1.5rem 0;
        }

        .example-box .example-title {
            color: #8b5cf6;
            font-weight: bold;
            margin-bottom: 0.75rem;
        }
    </style>
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="mb-0">Cargando...</p>
        </div>
    </div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="container-fluid">

        <!-- ENCABEZADO DISCRETO -->
        <div class="manual-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1>
                            <i class="bi bi-book me-2"></i>
                            Manual: Registrar Cumplimiento de Unidades
                        </h1>
                        <p class="subtitle mb-0">Módulo de Formación</p>
                    </div>
                    <div class="col-md-4 text-md-end mt-3 mt-md-0">
                        <a href="../../modules/training/register-completion.html" class="btn btn-outline-primary">
                            <i class="bi bi-arrow-left me-1"></i>Volver al Módulo
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- CONTENEDOR DE ALERTAS -->
        <div id="alertContainer"></div>

        <div class="row">
            <div class="col-lg-10 mx-auto">

                <!-- INFORMACIÓN CONTEXTUAL -->
                <div class="info-card">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h6 class="text-muted mb-2">Manual de:</h6>
                            <h5 class="mb-1"><strong id="display-module">Formación</strong></h5>
                            <p class="text-muted mb-0 small" id="display-page">Registrar Cumplimiento de Unidades Formativas</p>
                        </div>
                        <div class="col-md-6 text-md-end mt-3 mt-md-0">
                            <p class="small text-muted mb-0">
                                <i class="bi bi-info-circle me-1"></i>
                                Si tienes dudas o encuentras algún problema,<br>
                                puedes reportarlo usando el botón de abajo.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- CONTENIDO DEL MANUAL -->
                <!-- ============================================ -->

                <!-- SECCIÓN 1: ¿QUÉ ES? -->
                <div class="manual-section">
                    <h3><i class="bi bi-info-circle me-2"></i>¿Qué es esta funcionalidad?</h3>
                    
                    <p>
                        Esta herramienta te permite <strong>registrar y gestionar el cumplimiento</strong> de las 
                        unidades formativas que los trabajadores tienen asignadas en sus rutas de capacitación.
                    </p>

                    <p>
                        Es el lugar donde documentas oficialmente que un trabajador completó una unidad formativa, 
                        incluyendo la fecha de completación, calificación obtenida, evidencias y observaciones.
                    </p>

                    <div class="success-box">
                        <strong><i class="bi bi-lightbulb me-2"></i>Ejemplo:</strong>
                        Cuando un trabajador termina el curso de "Primeros Auxilios Básicos", vienes a esta 
                        funcionalidad para registrar que lo completó el 20 de enero, obtuvo 95 puntos, y adjuntas 
                        el enlace a su certificado digital.
                    </div>
                </div>

                <!-- SECCIÓN 2: ¿PARA QUÉ SIRVE? -->
                <div class="manual-section">
                    <h3><i class="bi bi-star me-2"></i>¿Para qué sirve?</h3>
                    
                    <ul class="feature-list">
                        <li>Registrar oficialmente cuando un trabajador completa una unidad formativa</li>
                        <li>Documentar calificaciones y evaluaciones de desempeño en cada capacitación</li>
                        <li>Adjuntar enlaces a certificados, diplomas u otras evidencias de cumplimiento</li>
                        <li>Editar registros anteriores si hay que corregir información</li>
                        <li>Llevar un historial completo del progreso formativo de cada trabajador</li>
                        <li>Mantener trazabilidad de quién completó qué y cuándo</li>
                        <li>Generar estadísticas confiables sobre cumplimiento de capacitaciones</li>
                    </ul>

                    <div class="info-box">
                        <strong><i class="bi bi-shield-check me-2"></i>Importancia:</strong>
                        Esta información es crítica para auditorías, certificaciones institucionales, y para 
                        demostrar el cumplimiento de requisitos legales en capacitación laboral.
                    </div>
                </div>

                <!-- SECCIÓN 3: ¿QUIÉN PUEDE USARLA? -->
                <div class="manual-section">
                    <h3><i class="bi bi-people me-2"></i>¿Quién puede usar esta funcionalidad?</h3>
                    
                    <p>
                        Esta funcionalidad está disponible para usuarios que tengan el permiso 
                        <strong>"Registrar cumplimiento de unidades"</strong> en el sistema.
                    </p>

                    <p>
                        Generalmente, este permiso lo tienen:
                    </p>

                    <ul>
                        <li>Coordinadores de formación y capacitación</li>
                        <li>Asistentes de talento humano</li>
                        <li>Jefes de área responsables de la formación de su equipo</li>
                        <li>Directores académicos o de desarrollo</li>
                        <li>Administradores del sistema</li>
                    </ul>

                    <div class="warning-box">
                        <strong><i class="bi bi-exclamation-triangle me-2"></i>Importante:</strong>
                        Solo registra cumplimientos cuando tengas certeza y evidencia de que el trabajador 
                        efectivamente completó la unidad formativa. La información que registres aquí tiene 
                        valor oficial y puede ser auditada.
                    </div>
                </div>

                <!-- SECCIÓN 4: ¿CÓMO SE USA? -->
                <div class="manual-section">
                    <h3><i class="bi bi-list-check me-2"></i>¿Cómo se usa? Paso a paso</h3>

                    <h4><i class="bi bi-journal-check me-2"></i>Para registrar un nuevo cumplimiento:</h4>

                    <!-- PASO 1 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">1</span>
                            Buscar al trabajador
                        </h5>
                        <p>
                            En el campo de búsqueda superior, escribe el nombre del trabajador cuyo cumplimiento 
                            vas a registrar. Necesitas escribir al menos 3 caracteres para que aparezcan los resultados.
                        </p>
                        <div class="success-box">
                            <strong><i class="bi bi-lightbulb me-2"></i>Consejo:</strong>
                            Si hay varios trabajadores con nombres similares, escribe el apellido completo para 
                            encontrar más rápido a la persona correcta.
                        </div>
                    </div>

                    <!-- PASO 2 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">2</span>
                            Seleccionar al trabajador
                        </h5>
                        <p>
                            Aparecerán tarjetas con los trabajadores que coincidan. Cada tarjeta muestra el nombre 
                            completo y los roles. Haz clic en la tarjeta del trabajador correcto.
                        </p>
                        <p>
                            Una vez seleccionado, verás su información resumida y el sistema cargará automáticamente 
                            todas sus unidades formativas.
                        </p>
                    </div>

                    <!-- PASO 3 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">3</span>
                            Filtrar las unidades (opcional)
                        </h5>
                        <p>
                            Por defecto, verás las unidades "Pendientes". Puedes cambiar el filtro usando los botones:
                        </p>
                        <ul>
                            <li><strong>Pendientes:</strong> Unidades aún no iniciadas</li>
                            <li><strong>En Progreso:</strong> Unidades que el trabajador ya empezó pero no ha terminado</li>
                            <li><strong>Vencidas:</strong> Unidades cuya fecha meta ya pasó sin completarse</li>
                            <li><strong>Todas:</strong> Muestra todas las unidades sin completar (pendientes, en progreso y vencidas)</li>
                        </ul>
                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>Nota:</strong>
                            El sistema te muestra cuántas unidades hay en cada categoría.
                        </div>
                    </div>

                    <!-- PASO 4 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">4</span>
                            Identificar la unidad a registrar
                        </h5>
                        <p>
                            Busca en la lista la unidad que el trabajador completó. Cada tarjeta te muestra:
                        </p>
                        <ul>
                            <li>Si es obligatoria u opcional</li>
                            <li>El estado actual (Pendiente, En progreso, Vencido)</li>
                            <li>El código y título de la unidad</li>
                            <li>Fecha de asignación y fecha meta de completación</li>
                            <li>Si está próxima a vencer (con alerta visual)</li>
                        </ul>
                    </div>

                    <!-- PASO 5 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">5</span>
                            Hacer clic en "Registrar"
                        </h5>
                        <p>
                            En la tarjeta de la unidad que completó el trabajador, haz clic en el botón verde 
                            <span class="badge bg-success">
                                <i class="bi bi-check-circle me-1"></i>Registrar
                            </span>
                        </p>
                        <p>
                            Se abrirá una ventana con el formulario de registro.
                        </p>
                    </div>

                    <!-- PASO 6 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">6</span>
                            Completar el formulario de registro
                        </h5>
                        <p>
                            Llena la siguiente información:
                        </p>
                        
                        <h6 class="mt-3 mb-2"><strong>A. Fecha de Completación</strong> (obligatorio)</h6>
                        <p>
                            Selecciona la fecha en que el trabajador terminó la unidad formativa.
                        </p>
                        <div class="warning-box">
                            <strong>Restricciones importantes:</strong>
                            <ul class="mt-2 mb-0">
                                <li>La fecha NO puede ser anterior a la fecha en que se le asignó la unidad</li>
                                <li>La fecha NO puede ser futura (no puedes poner fechas posteriores a hoy)</li>
                            </ul>
                        </div>
                        
                        <h6 class="mt-3 mb-2"><strong>B. URL de Evidencia</strong> (opcional pero recomendado)</h6>
                        <p>
                            Pega el enlace al certificado, diploma o documento que compruebe que el trabajador 
                            completó la capacitación.
                        </p>
                        <div class="example-box">
                            <div class="example-title">Ejemplos de evidencias válidas:</div>
                            <ul class="mb-0">
                                <li>Enlace a Google Drive con el certificado escaneado</li>
                                <li>URL del certificado digital de la plataforma de capacitación</li>
                                <li>Enlace a carpeta compartida con fotos de asistencia al curso</li>
                                <li>Link al diploma en formato PDF</li>
                            </ul>
                        </div>
                        
                        <h6 class="mt-3 mb-2"><strong>C. Calificación / Puntaje</strong> (opcional)</h6>
                        <p>
                            Si la capacitación tuvo evaluación con nota, ingresa el puntaje obtenido. 
                            El sistema usa una escala de 0 a 100.
                        </p>
                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>Si la capacitación usa otra escala:</strong>
                            Convierte la nota a base 100. Por ejemplo:
                            <ul class="mt-2 mb-0">
                                <li>Nota 4.5/5.0 = 90/100</li>
                                <li>Nota 8/10 = 80/100</li>
                                <li>Nota 17/20 = 85/100</li>
                            </ul>
                        </div>
                        
                        <h6 class="mt-3 mb-2"><strong>D. Notas de Evaluación</strong> (opcional)</h6>
                        <p>
                            Aquí puedes escribir observaciones sobre el desempeño del trabajador:
                        </p>
                        <div class="example-box">
                            <div class="example-title">Ejemplos de buenas notas:</div>
                            <ul class="mb-0">
                                <li>"Excelente participación. Destacó en ejercicios prácticos de RCP."</li>
                                <li>"Aprobó con nota sobresaliente. Mostró liderazgo en trabajo en equipo."</li>
                                <li>"Completó el curso satisfactoriamente. Requiere refuerzo en tema de evacuación."</li>
                                <li>"Certificado como instructor nivel básico. Puede capacitar a otros en el área."</li>
                            </ul>
                        </div>
                    </div>

                    <!-- PASO 7 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">7</span>
                            Guardar el registro
                        </h5>
                        <p>
                            Revisa que toda la información esté correcta y haz clic en 
                            <span class="badge bg-success">
                                <i class="bi bi-check-circle me-1"></i>Registrar Cumplimiento
                            </span>
                        </p>
                        <p>
                            El sistema te pedirá confirmación. Al confirmar:
                        </p>
                        <ul>
                            <li>La unidad se marcará como "Completada" en la ruta del trabajador</li>
                            <li>Desaparecerá de la sección de pendientes</li>
                            <li>Aparecerá en la sección de unidades completadas</li>
                            <li>Se actualizarán las estadísticas del trabajador</li>
                        </ul>
                    </div>

                    <hr class="my-5">

                    <h4><i class="bi bi-pencil me-2"></i>Para editar un registro existente:</h4>

                    <!-- PASO 1 EDICIÓN -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">1</span>
                            Buscar al trabajador y desplegar unidades completadas
                        </h5>
                        <p>
                            Busca y selecciona al trabajador como en los pasos anteriores.
                        </p>
                        <p>
                            Luego, haz clic en la sección <strong>"Unidades Completadas"</strong> para expandirla 
                            (está colapsada por defecto).
                        </p>
                    </div>

                    <!-- PASO 2 EDICIÓN -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">2</span>
                            Localizar el registro a editar
                        </h5>
                        <p>
                            Busca en la lista la unidad cuyo registro necesitas modificar. 
                            Las tarjetas de unidades completadas muestran:
                        </p>
                        <ul>
                            <li>Fecha de completación registrada</li>
                            <li>Calificación obtenida (si se registró)</li>
                            <li>Enlace a la evidencia (si existe)</li>
                            <li>Extracto de las notas de evaluación</li>
                        </ul>
                    </div>

                    <!-- PASO 3 EDICIÓN -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">3</span>
                            Hacer clic en "Editar"
                        </h5>
                        <p>
                            En la tarjeta de la unidad, haz clic en 
                            <span class="badge bg-primary">
                                <i class="bi bi-pencil me-1"></i>Editar
                            </span>
                        </p>
                        <p>
                            Se abrirá el formulario con toda la información actual pre-cargada.
                        </p>
                    </div>

                    <!-- PASO 4 EDICIÓN -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">4</span>
                            Modificar la información necesaria
                        </h5>
                        <p>
                            Cambia los campos que necesites actualizar. Puedes modificar:
                        </p>
                        <ul>
                            <li>La fecha de completación</li>
                            <li>El enlace a la evidencia</li>
                            <li>La calificación</li>
                            <li>Las notas de evaluación</li>
                        </ul>
                        <div class="info-box">
                            <strong><i class="bi bi-info-circle me-2"></i>Nota:</strong>
                            Las mismas restricciones de fecha aplican al editar (no puede ser anterior a la 
                            asignación ni futura).
                        </div>
                    </div>

                    <!-- PASO 5 EDICIÓN -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">5</span>
                            Guardar los cambios
                        </h5>
                        <p>
                            Haz clic en 
                            <span class="badge bg-primary">
                                <i class="bi bi-check-circle me-1"></i>Guardar Cambios
                            </span>
                        </p>
                        <p>
                            El registro se actualizará con la nueva información.
                        </p>
                        <div class="warning-box">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Importante:</strong>
                            Los cambios sobrescriben la información anterior. No hay un historial de ediciones 
                            visible para el usuario, así que asegúrate de que los cambios sean correctos antes 
                            de guardar.
                        </div>
                    </div>

                </div>

                <!-- SECCIÓN 5: CARACTERÍSTICAS ESPECIALES -->
                <div class="manual-section">
                    <h3><i class="bi bi-stars me-2"></i>Características Especiales</h3>

                    <h4>Filtros inteligentes</h4>
                    <p>
                        Los filtros te permiten enfocarte en lo más urgente:
                    </p>
                    <ul>
                        <li><strong>Pendientes:</strong> Ideal para hacer seguimiento a lo que falta por iniciar</li>
                        <li><strong>En Progreso:</strong> Para registrar completaciones de capacitaciones que ya están en curso</li>
                        <li><strong>Vencidas:</strong> Para identificar rápidamente retrasos y tomar acciones</li>
                        <li><strong>Todas:</strong> Vista completa de todo lo que falta por completar</li>
                    </ul>

                    <h4>Alertas de vencimiento</h4>
                    <p>
                        El sistema te avisa cuando una unidad está próxima a vencer:
                    </p>
                    <ul>
                        <li>Si faltan 7 días o menos, verás un badge amarillo parpadeante</li>
                        <li>Si la fecha meta ya pasó, se muestra cuántos días lleva vencida</li>
                    </ul>
                    <div class="info-box">
                        <strong><i class="bi bi-lightbulb me-2"></i>Tip:</strong>
                        Usa estas alertas para priorizar qué capacitaciones registrar primero y cuáles 
                        requieren seguimiento urgente con el trabajador.
                    </div>

                    <h4>Sección colapsable de completadas</h4>
                    <p>
                        Por defecto, las unidades completadas están ocultas para mantener la pantalla limpia y 
                        enfocada en lo pendiente. Haz clic en "Unidades Completadas" para expandir o contraer 
                        esta sección cuando necesites consultarla o editar registros.
                    </p>

                    <h4>Cambio rápido de trabajador</h4>
                    <p>
                        Si necesitas registrar cumplimientos de varios trabajadores seguidos, usa el botón 
                        "Cambiar" al lado del nombre del trabajador actual. Esto te devuelve al buscador sin 
                        perder el contexto de la página.
                    </p>
                </div>

                <!-- SECCIÓN 6: INFORMACIÓN IMPORTANTE -->
                <div class="manual-section">
                    <h3><i class="bi bi-exclamation-circle me-2"></i>Información Importante</h3>

                    <h4>¿Qué unidades puedo registrar?</h4>
                    <p>
                        Solo puedes registrar cumplimiento de unidades que estén en estado:
                    </p>
                    <ul>
                        <li>Pendiente</li>
                        <li>En progreso</li>
                        <li>Vencido</li>
                    </ul>
                    <p>
                        Las unidades ya completadas solo se pueden editar, no re-registrar.
                    </p>

                    <h4>Validaciones automáticas</h4>
                    <p>
                        El sistema te ayuda a evitar errores:
                    </p>
                    <ul>
                        <li>No te permite poner fechas de completación anteriores a la fecha de asignación</li>
                        <li>No acepta fechas futuras</li>
                        <li>Valida que las calificaciones estén entre 0 y 100</li>
                        <li>Verifica que las URLs de evidencia tengan formato válido</li>
                    </ul>

                    <h4>Impacto del registro</h4>
                    <p>
                        Cuando registras un cumplimiento:
                    </p>
                    <ul>
                        <li>La unidad cambia de estado automáticamente a "Completado"</li>
                        <li>Se actualiza el porcentaje de cumplimiento del trabajador</li>
                        <li>Las estadísticas del módulo de formación se actualizan</li>
                        <li>Si hay validación de vigencia, comienzan a contar los plazos de renovación</li>
                    </ul>

                    <h4>Campos opcionales vs obligatorios</h4>
                    <p>
                        <strong>Obligatorio:</strong> Solo la fecha de completación es obligatoria.
                    </p>
                    <p>
                        <strong>Opcionales pero recomendados:</strong>
                    </p>
                    <ul>
                        <li><strong>URL de evidencia:</strong> Fundamental para auditorías y verificación</li>
                        <li><strong>Calificación:</strong> Importante para evaluar nivel de dominio del tema</li>
                        <li><strong>Notas:</strong> Útiles para decisiones futuras de formación y promoción</li>
                    </ul>

                    <div class="warning-box">
                        <strong><i class="bi bi-shield-exclamation me-2"></i>Responsabilidad:</strong>
                        Aunque algunos campos son opcionales, procura completar la mayor cantidad de información 
                        posible. Los datos que registres aquí son oficiales y pueden ser solicitados en auditorías 
                        laborales, certificaciones de calidad, o procesos legales.
                    </div>
                </div>

                <!-- SECCIÓN 7: PREGUNTAS FRECUENTES -->
                <div class="manual-section">
                    <h3><i class="bi bi-question-circle me-2"></i>Preguntas Frecuentes</h3>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¿Qué hago si un trabajador completó una unidad pero olvidé registrarla hace meses?
                        </div>
                        <div class="faq-answer">
                            Puedes registrarla ahora con la fecha real en que la completó (siempre y cuando sea 
                            posterior a la fecha de asignación). El sistema acepta fechas pasadas. Asegúrate de 
                            tener la evidencia disponible para demostrar que efectivamente se completó en esa fecha.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¿Puedo registrar el cumplimiento antes de que el trabajador termine realmente la capacitación?
                        </div>
                        <div class="faq-answer">
                            No. Solo debes registrar cumplimientos cuando el trabajador efectivamente haya terminado 
                            y aprobado la capacitación. Registrar cumplimientos anticipados constituye falsedad en 
                            documentos oficiales y puede tener consecuencias laborales y legales.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            No tengo el certificado o evidencia, ¿puedo dejar ese campo vacío?
                        </div>
                        <div class="faq-answer">
                            Sí, el campo de evidencia es opcional. Sin embargo, es altamente recomendable obtener 
                            y adjuntar alguna evidencia. Si no la tienes en el momento, registra el cumplimiento 
                            y luego edita el registro para agregar el enlace cuando obtengas el certificado.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¿Qué pasa si registro una fecha equivocada?
                        </div>
                        <div class="faq-answer">
                            Puedes editar el registro en cualquier momento. Busca al trabajador, expande la sección 
                            de "Unidades Completadas", localiza la unidad y haz clic en "Editar". Corrige la fecha 
                            y guarda los cambios.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            Un trabajador completó una capacitación externa que no estaba en su ruta, ¿la registro aquí?
                        </div>
                        <div class="faq-answer">
                            No. Esta funcionalidad solo permite registrar cumplimiento de unidades que ya están 
                            asignadas en la ruta del trabajador. Si quieres agregar una capacitación externa, 
                            primero debes asignarle esa unidad desde el módulo de gestión de rutas, y luego 
                            registrar su cumplimiento.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¿Puedo eliminar un registro de cumplimiento?
                        </div>
                        <div class="faq-answer">
                            No desde esta pantalla. Los registros de cumplimiento son permanentes por temas de 
                            auditoría y trazabilidad. Si registraste algo por error, contacta al administrador 
                            del sistema quien tiene permisos para hacer correcciones en casos justificados.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¿Dónde guardo los certificados si no tengo Google Drive?
                        </div>
                        <div class="faq-answer">
                            Puedes usar cualquier servicio de almacenamiento en la nube que genere enlaces públicos: 
                            OneDrive, Dropbox, plataformas LMS de capacitación, etc. Lo importante es que el enlace 
                            sea accesible y permanente (no se borre después de un tiempo).
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¿El trabajador puede ver lo que registro aquí?
                        </div>
                        <div class="faq-answer">
                            Depende de los permisos configurados en el sistema. Generalmente, los trabajadores 
                            pueden ver sus propias unidades completadas, fechas y calificaciones en su perfil o 
                            en su vista de ruta de formación, pero no necesariamente las notas de evaluación 
                            que escribas.
                        </div>
                    </div>

                </div>

                <!-- SECCIÓN 8: PROBLEMAS COMUNES -->
                <div class="manual-section">
                    <h3><i class="bi bi-tools me-2"></i>Problemas Comunes y Soluciones</h3>

                    <div class="step-card">
                        <h5><i class="bi bi-x-circle text-danger me-2"></i>El sistema no acepta la fecha que quiero poner</h5>
                        <p><strong>Posibles causas:</strong></p>
                        <ul>
                            <li>La fecha es anterior a la fecha de asignación de la unidad</li>
                            <li>La fecha es futura (posterior a hoy)</li>
                        </ul>
                        <p><strong>Solución:</strong></p>
                        <p>
                            Verifica que la fecha esté dentro del rango permitido. La fecha de completación debe 
                            estar entre la fecha de asignación y el día de hoy. Si necesitas registrar una fecha 
                            fuera de este rango por razones válidas, contacta al administrador.
                        </p>
                    </div>

                    <div class="step-card">
                        <h5><i class="bi bi-exclamation-triangle text-warning me-2"></i>No aparecen todas las unidades del trabajador</h5>
                        <p><strong>Posibles causas:</strong></p>
                        <ul>
                            <li>Tienes un filtro activo que oculta algunas unidades</li>
                            <li>Las unidades ya están completadas (busca en sección de completadas)</li>
                            <li>El trabajador no tiene unidades asignadas</li>
                        </ul>
                        <p><strong>Solución:</strong></p>
                        <p>
                            Cambia el filtro a "Todas" para ver todas las unidades pendientes. Expande la sección 
                            de "Unidades Completadas" para ver las que ya están registradas. Si aun así no aparecen 
                            unidades que deberían estar, verifica desde el módulo de gestión de rutas que 
                            efectivamente estén asignadas.
                        </p>
                    </div>

                    <div class="step-card">
                        <h5><i class="bi bi-exclamation-circle text-info me-2"></i>El botón "Registrar" no hace nada al hacer clic</h5>
                        <p><strong>Posibles causas:</strong></p>
                        <ul>
                            <li>Problema de conexión a internet</li>
                            <li>Error temporal del navegador</li>
                            <li>Sesión expirada</li>
                        </ul>
                        <p><strong>Solución:</strong></p>
                        <p>
                            Primero verifica tu conexión a internet. Luego intenta refrescar la página (F5). 
                            Si el problema persiste, cierra sesión y vuelve a ingresar. Si aún no funciona, 
                            reporta el problema usando el botón de "Reportar Bug" al final de esta página.
                        </p>
                    </div>

                    <div class="step-card">
                        <h5><i class="bi bi-link-45deg text-primary me-2"></i>La URL de evidencia no se guarda correctamente</h5>
                        <p><strong>Posibles causas:</strong></p>
                        <ul>
                            <li>El enlace no tiene formato de URL válido</li>
                            <li>Falta el "https://" al inicio</li>
                            <li>Hay espacios en el enlace</li>
                        </ul>
                        <p><strong>Solución:</strong></p>
                        <p>
                            Asegúrate de que el enlace comience con "http://" o "https://". Copia el enlace 
                            directamente desde la barra de direcciones del navegador en lugar de escribirlo 
                            manualmente. Verifica que no haya espacios antes ni después del enlace.
                        </p>
                    </div>

                    <div class="step-card">
                        <h5><i class="bi bi-calculator text-success me-2"></i>No puedo ingresar la calificación que quiero</h5>
                        <p><strong>Posibles causas:</strong></p>
                        <ul>
                            <li>Estás intentando poner un valor mayor a 100</li>
                            <li>Estás usando formato incorrecto (letras en lugar de números)</li>
                        </ul>
                        <p><strong>Solución:</strong></p>
                        <p>
                            El campo solo acepta números entre 0 y 100. Si la calificación original usa otra 
                            escala, conviértela a base 100. Usa punto (.) como separador decimal, no coma (,). 
                            Ejemplo: 95.5 en lugar de 95,5.
                        </p>
                    </div>

                </div>

                <!-- SECCIÓN 9: MEJORES PRÁCTICAS -->
                <div class="manual-section">
                    <h3><i class="bi bi-award me-2"></i>Mejores Prácticas</h3>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Registra tan pronto como sea posible</strong>
                        <p class="mb-0 mt-2">
                            No esperes semanas o meses. Registra el cumplimiento inmediatamente después de que 
                            el trabajador complete la capacitación, mientras la información está fresca y las 
                            evidencias están disponibles.
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Siempre adjunta evidencia</strong>
                        <p class="mb-0 mt-2">
                            Aunque es opcional, acostúmbrate a siempre adjuntar el enlace al certificado o 
                            evidencia. Te ahorrará problemas en auditorías futuras.
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Sé específico en las notas</strong>
                        <p class="mb-0 mt-2">
                            Si escribes notas de evaluación, sé concreto. En lugar de "Bien", escribe "Aprobó 
                            con 90 puntos. Destacó en módulo de liderazgo."
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Revisa antes de guardar</strong>
                        <p class="mb-0 mt-2">
                            Tómate unos segundos para verificar que toda la información sea correcta antes de 
                            confirmar el registro. Es más fácil hacerlo bien la primera vez que editar después.
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Organiza tus evidencias</strong>
                        <p class="mb-0 mt-2">
                            Crea una estructura de carpetas clara en tu almacenamiento en la nube. Por ejemplo: 
                            "Certificados 2026 / Enero / Primeros Auxilios". Esto facilitará encontrar las 
                            evidencias cuando necesites actualizar los enlaces.
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Usa los filtros estratégicamente</strong>
                        <p class="mb-0 mt-2">
                            Empieza tu jornada filtrando por "Vencidas" para atender lo urgente primero. 
                            Luego revisa "En Progreso" y finalmente "Pendientes".
                        </p>
                    </div>

                </div>

                <!-- TARJETA PARA REPORTAR BUGS -->
                <div class="bug-report-card">
                    <i class="bi bi-bug-fill icon-large"></i>
                    <h4 class="mb-3">¿Encontraste un problema o tienes una sugerencia?</h4>
                    <p class="mb-4">
                        Si experimentaste un error, algo no funciona como esperas, o tienes 
                        una sugerencia para mejorar el sistema, repórtalo aquí.
                    </p>
                    <a href="../report-bug.html" class="btn btn-light btn-lg">
                        <i class="bi bi-exclamation-triangle me-2"></i>Reportar Bug o Problema
                    </a>
                </div>

            </div>
        </div>

    </div>

    <!-- BOTÓN FLOTANTE PARA REPORTAR BUGS -->
    <a href="../report-bug.html" class="btn btn-danger btn-lg floating-bug-button" title="Reportar Bug">
        <i class="bi bi-bug-fill me-2"></i>Reportar Bug
    </a>

    <!-- SCRIPTS - ORDEN CRÍTICO -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/js/config.js"></script>
    
    <script>
        // ==========================================
        // VARIABLES GLOBALES
        // ==========================================
        let currentUser = null;

        // ==========================================
        // CONFIGURACIÓN DE LA PÁGINA
        // ==========================================
        const PAGE_CONFIG = {
            moduleName: 'Formación',
            modulePath: 'training',
            pageTitle: 'Registrar Cumplimiento de Unidades',
            pagePath: 'register-completion.html',
            moduleDescription: 'Registrar y gestionar el cumplimiento de unidades formativas'
        };

        // ==========================================
        // INICIALIZACIÓN
        // ==========================================
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('📖 Iniciando página de manual...');
            
            try {
                // Verificar si existe la función de colores corporativos
                if (typeof loadAndApplyBrandColors === 'function') {
                    await loadAndApplyBrandColors();
                }
                
                // Verificar sesión si la función existe
                if (typeof getStoredSession === 'function') {
                    const session = getStoredSession();
                    if (session && session.user) {
                        currentUser = session.user;
                    }
                }
                
                // Actualizar información en la página
                updatePageInfo();
                
                console.log('✅ Página de manual lista');
                
            } catch (error) {
                console.error('❌ Error inicializando página:', error);
                if (typeof showMessage === 'function') {
                    showMessage('Error al cargar la página: ' + error.message, 'danger');
                }
            }
        });

        // ==========================================
        // ACTUALIZAR INFORMACIÓN DE LA PÁGINA
        // ==========================================
        function updatePageInfo() {
            // Actualizar title
            document.title = `Manual - ${PAGE_CONFIG.moduleName} - ${PAGE_CONFIG.pageTitle} - SchoolNet`;
        }

        // ==========================================
        // UTILIDADES DE LOADING
        // ==========================================
        function showLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.remove('hidden');
            }
        }

        function hideLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.add('hidden');
            }
        }

        // ==========================================
        // FUNCIÓN DE MENSAJES
        // ==========================================
        function showMessage(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            if (!alertContainer) return;
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertContainer.appendChild(alertDiv);
            
            // Auto-remove después de 5 segundos
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

    </script>
</body>
</html>
