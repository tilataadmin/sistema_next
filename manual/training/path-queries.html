<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- VERSI√ìN DE LA P√ÅGINA -->
    <meta name="page-version" content="26.01.26.17.19">
    
    <title>Manual - Formaci√≥n - Consultas de Rutas - SchoolNet</title>
    
    <!-- Bootstrap CSS - VERSI√ìN FIJA PROBADA -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-overlay.hidden {
            display: none;
        }
        
        .loading-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Encabezado discreto */
        .manual-header {
            background: #f8f9fa;
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding: 1.5rem 0;
            margin-bottom: 2rem;
        }

        .manual-header h1 {
            font-size: 1.75rem;
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 0.25rem;
        }

        .manual-header .subtitle {
            color: #6c757d;
            font-size: 0.95rem;
        }

        /* Info card */
        .info-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Tarjeta para reportar bugs - COLOR PRIMARIO */
        .bug-report-card {
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .bug-report-card h5 {
            color: white;
        }

        /* Bot√≥n flotante para reportar bugs - COLOR PRIMARIO */
        .floating-bug-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            background: var(--system-primary-color, #1B365D) !important;
            border-color: var(--system-primary-color, #1B365D) !important;
        }

        .floating-bug-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
            opacity: 0.9;
        }

        .icon-large {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        /* Cajas de informaci√≥n */
        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #0d6efd;
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
        }

        .success-box {
            background: #d1e7dd;
            border-left: 4px solid #198754;
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
        }

        .danger-box {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
        }

        /* Tarjetas de pasos */
        .step-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .step-card h5 {
            color: var(--system-primary-color, #1B365D);
            margin-bottom: 1rem;
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: var(--system-primary-color, #1B365D);
            color: white;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 0.75rem;
        }

        /* Listas con estilo */
        .feature-list {
            list-style: none;
            padding-left: 0;
        }

        .feature-list li {
            padding-left: 1.75rem;
            margin-bottom: 0.75rem;
            position: relative;
        }

        .feature-list li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #198754;
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* Secciones del manual */
        .manual-section {
            margin-bottom: 3rem;
        }

        .manual-section h3 {
            color: var(--system-primary-color, #1B365D);
            border-bottom: 2px solid var(--system-primary-color, #1B365D);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .manual-section h4 {
            color: #495057;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }

        /* FAQ */
        .faq-item {
            margin-bottom: 1.5rem;
        }

        .faq-question {
            font-weight: 600;
            color: #495057;
            margin-bottom: 0.5rem;
        }

        .faq-answer {
            color: #6c757d;
            padding-left: 1.5rem;
        }

        /* Tabla de tipos de consulta */
        .query-types-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
        }

        .query-types-table th,
        .query-types-table td {
            border: 1px solid #dee2e6;
            padding: 0.75rem;
            text-align: left;
        }

        .query-types-table th {
            background-color: var(--system-primary-color, #1B365D);
            color: white;
            font-weight: 600;
        }

        .query-types-table tr:hover {
            background-color: #f8f9fa;
        }

        .query-icon {
            font-size: 1.5rem;
            margin-right: 0.5rem;
        }

        /* Tarjetas de comparaci√≥n */
        .comparison-card {
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.25rem;
            margin-bottom: 1rem;
            background: white;
        }

        .comparison-title {
            color: var(--system-primary-color, #1B365D);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        /* Ejemplos visuales */
        .example-box {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: monospace;
            font-size: 0.9rem;
        }
    </style>
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="mb-0">Cargando...</p>
        </div>
    </div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="container-fluid">

        <!-- ENCABEZADO DISCRETO -->
        <div class="manual-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1>
                            <i class="bi bi-book me-2"></i>
                            Manual: Consultas de Rutas de Formaci√≥n
                        </h1>
                        <p class="subtitle mb-0">M√≥dulo de Formaci√≥n</p>
                    </div>
                    <div class="col-md-4 text-md-end mt-3 mt-md-0">
                        <a href="../../modules/training/path-queries.html" class="btn btn-outline-primary">
                            <i class="bi bi-arrow-left me-1"></i>Volver al M√≥dulo
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- CONTENEDOR DE ALERTAS -->
        <div id="alertContainer"></div>

        <div class="row">
            <div class="col-lg-10 mx-auto">

                <!-- INFORMACI√ìN CONTEXTUAL -->
                <div class="info-card">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h6 class="text-muted mb-2">Manual de:</h6>
                            <h5 class="mb-1"><strong id="display-module">Formaci√≥n</strong></h5>
                            <p class="text-muted mb-0 small" id="display-page">Consultas de Rutas de Formaci√≥n</p>
                        </div>
                        <div class="col-md-6 text-md-end mt-3 mt-md-0">
                            <p class="small text-muted mb-0">
                                <i class="bi bi-info-circle me-1"></i>
                                Si tienes dudas o encuentras alg√∫n problema,<br>
                                puedes reportarlo usando el bot√≥n de abajo.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- CONTENIDO DEL MANUAL -->
                <!-- ============================================ -->

                <!-- SECCI√ìN 1: ¬øQU√â ES? -->
                <div class="manual-section">
                    <h3><i class="bi bi-info-circle me-2"></i>¬øQu√© es esta funcionalidad?</h3>
                    
                    <p>
                        La funcionalidad de <strong>Consultas de Rutas de Formaci√≥n</strong> te permite hacer 
                        b√∫squedas profundas y espec√≠ficas en la informaci√≥n de capacitaciones, respondiendo a 
                        preguntas muy concretas que el Dashboard general no puede responder.
                    </p>

                    <p>
                        A diferencia de los Reportes (que muestran informaci√≥n masiva en tablas), las Consultas 
                        te permiten "hacerle una pregunta espec√≠fica al sistema" y obtener una respuesta inmediata 
                        con datos precisos y visualizaciones relevantes.
                    </p>

                    <div class="success-box">
                        <strong><i class="bi bi-lightbulb me-2"></i>Pi√©nsalo as√≠:</strong>
                        Es como tener un asistente experto que conoce TODO sobre formaci√≥n. En lugar de revisar 
                        manualmente cientos de registros, simplemente le haces una pregunta espec√≠fica como 
                        "¬øC√≥mo va Juan P√©rez en sus capacitaciones?" o "¬øQu√© m√≥dulos facilita Mar√≠a Garc√≠a?" 
                        y √©l te da la respuesta completa con estad√≠sticas, tablas y gr√°ficos.
                    </div>

                    <div class="comparison-card">
                        <div class="comparison-title">üîç Dashboard vs. Reportes vs. Consultas</div>
                        <ul class="mb-0">
                            <li><strong>Dashboard:</strong> Panorama general, m√©tricas globales, alertas del momento</li>
                            <li><strong>Reportes:</strong> Exportaciones masivas de datos con m√∫ltiples filtros</li>
                            <li><strong>Consultas:</strong> Respuestas espec√≠ficas e inmediatas a preguntas puntuales</li>
                        </ul>
                    </div>
                </div>

                <!-- SECCI√ìN 2: ¬øPARA QU√â SIRVE? -->
                <div class="manual-section">
                    <h3><i class="bi bi-star me-2"></i>¬øPara qu√© sirve?</h3>
                    
                    <ul class="feature-list">
                        <li>Responder preguntas espec√≠ficas sobre trabajadores, m√≥dulos, ejes o √°reas en segundos</li>
                        <li>Investigar casos particulares sin necesidad de exportar datos masivos</li>
                        <li>Hacer seguimiento personalizado a trabajadores espec√≠ficos</li>
                        <li>Analizar el impacto de facilitadores o instructores</li>
                        <li>Identificar patrones temporales en completaciones</li>
                        <li>Compartir consultas con otras personas mediante enlaces directos</li>
                        <li>Obtener visualizaciones autom√°ticas (gr√°ficos, KPIs) seg√∫n el tipo de consulta</li>
                        <li>Exportar resultados espec√≠ficos en formato CSV para an√°lisis externo</li>
                        <li>Acceder r√°pidamente a informaci√≥n desde el Dashboard (clic en m√©tricas ‚Üí consulta autom√°tica)</li>
                    </ul>

                    <div class="info-box">
                        <strong><i class="bi bi-graph-up me-2"></i>Caso de uso t√≠pico:</strong>
                        Un gerente te pregunta: "¬øC√≥mo va el equipo de Ventas en el eje de T√©cnicas Comerciales?". 
                        Con Consultas, en 10 segundos puedes darle la respuesta exacta: porcentaje de completaci√≥n, 
                        qui√©nes van bien, qui√©nes est√°n rezagados, y compartirle el enlace para que √©l mismo lo revise.
                    </div>
                </div>

                <!-- SECCI√ìN 3: ¬øQUI√âN PUEDE USARLA? -->
                <div class="manual-section">
                    <h3><i class="bi bi-people me-2"></i>¬øQui√©n puede usar esta funcionalidad?</h3>
                    
                    <p>
                        Esta funcionalidad est√° disponible para usuarios que tengan el permiso 
                        <strong>"Consultas de rutas"</strong> en el sistema.
                    </p>

                    <p>
                        T√≠picamente, este permiso lo tienen:
                    </p>

                    <ul>
                        <li>Coordinadores y analistas de formaci√≥n</li>
                        <li>Jefes de talento humano</li>
                        <li>Gerentes de √°rea que necesitan seguimiento detallado</li>
                        <li>Personal de auditor√≠a y compliance</li>
                        <li>Facilitadores que quieren ver su impacto</li>
                        <li>Administradores del sistema</li>
                    </ul>

                    <div class="warning-box">
                        <strong><i class="bi bi-shield-exclamation me-2"></i>Responsabilidad:</strong>
                        Las consultas muestran informaci√≥n detallada y sensible sobre el desempe√±o de trabajadores. 
                        √ösalas de manera √©tica, constructiva y respetando la confidencialidad. No uses esta 
                        informaci√≥n para perjudicar o avergonzar a nadie.
                    </div>
                </div>

                <!-- SECCI√ìN 4: TIPOS DE CONSULTAS -->
                <div class="manual-section">
                    <h3><i class="bi bi-funnel me-2"></i>8 Tipos de Consultas Disponibles</h3>

                    <p>
                        El sistema ofrece 8 tipos de consultas predefinidas, cada una dise√±ada para responder 
                        preguntas espec√≠ficas. Elige el tipo seg√∫n lo que necesites saber:
                    </p>

                    <table class="query-types-table">
                        <thead>
                            <tr>
                                <th style="width: 30%;">Tipo de Consulta</th>
                                <th style="width: 70%;">¬øQu√© pregunta responde?</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="query-icon">üë§</span><strong>Por Trabajador Espec√≠fico</strong></td>
                                <td>"¬øC√≥mo va [nombre] en su ruta de formaci√≥n? ¬øQu√© m√≥dulos ha completado? ¬øCu√°les le faltan?"</td>
                            </tr>
                            <tr>
                                <td><span class="query-icon">üìö</span><strong>Por M√≥dulo Espec√≠fico</strong></td>
                                <td>"¬øQui√©nes est√°n tomando [m√≥dulo X]? ¬øCu√°ntos lo han completado? ¬øQui√©nes est√°n pendientes?"</td>
                            </tr>
                            <tr>
                                <td><span class="query-icon">üìä</span><strong>Por Eje Formativo</strong></td>
                                <td>"¬øC√≥mo va el eje de [Seguridad/Liderazgo/etc.]? ¬øQu√© m√≥dulos lo componen? ¬øQu√© porcentaje se ha completado?"</td>
                            </tr>
                            <tr>
                                <td><span class="query-icon">üè¢</span><strong>Por √Årea Organizacional</strong></td>
                                <td>"¬øC√≥mo va el equipo de [Ventas/TI/etc.] en formaci√≥n? ¬øQui√©n va mejor/peor? ¬øCu√°l es el promedio del √°rea?"</td>
                            </tr>
                            <tr>
                                <td><span class="query-icon">üìÖ</span><strong>Por Rango de Fechas</strong></td>
                                <td>"¬øQu√© se complet√≥ entre [fecha 1] y [fecha 2]? ¬øQui√©nes fueron los m√°s activos? ¬øHubo patrones?"</td>
                            </tr>
                            <tr>
                                <td><span class="query-icon">üéì</span><strong>Por Facilitador</strong></td>
                                <td>"¬øQu√© m√≥dulos facilita [instructor X]? ¬øA cu√°ntas personas ha impactado? ¬øC√≥mo califican sus cursos?"</td>
                            </tr>
                            <tr>
                                <td><span class="query-icon">‚ö†Ô∏è</span><strong>Por Estado</strong></td>
                                <td>"¬øQu√© m√≥dulos est√°n [Vencidos/Pendientes/En Progreso]? ¬øCu√°les vencen pronto? ¬øQui√©nes est√°n afectados?"</td>
                            </tr>
                            <tr>
                                <td><span class="query-icon">üîç</span><strong>Consulta Avanzada</strong></td>
                                <td>"Necesito combinar m√∫ltiples filtros: trabajadores de [√°rea X], en m√≥dulos del [eje Y], completados en [fechas Z], etc."</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- SECCI√ìN 5: C√ìMO EJECUTAR CONSULTAS -->
                <div class="manual-section">
                    <h3><i class="bi bi-play-circle me-2"></i>¬øC√≥mo Ejecutar una Consulta? Paso a paso</h3>

                    <!-- PASO 1 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">1</span>
                            Seleccionar el tipo de consulta
                        </h5>
                        <p>
                            En la secci√≥n de <strong>"Configuraci√≥n de la Consulta"</strong>, ver√°s un selector 
                            grande con 8 opciones. Haz clic y elige el tipo de consulta que mejor responda a tu 
                            pregunta.
                        </p>
                        <div class="info-box">
                            <strong><i class="bi bi-lightbulb me-2"></i>Consejo:</strong>
                            Si no est√°s seguro cu√°l elegir, revisa la tabla de arriba. Piensa en "¬øqu√© quiero saber?" 
                            y encuentra el tipo que se acerque m√°s a esa pregunta.
                        </div>
                    </div>

                    <!-- PASO 2 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">2</span>
                            Configurar los par√°metros
                        </h5>
                        <p>
                            Una vez que selecciones un tipo, aparecer√°n los par√°metros espec√≠ficos que necesitas 
                            configurar. Dependiendo del tipo, ver√°s:
                        </p>
                        <ul>
                            <li><strong>Par√°metros obligatorios</strong> (marcados con <span class="text-danger">*</span>): DEBES seleccionarlos para poder ejecutar la consulta</li>
                            <li><strong>Par√°metros opcionales</strong> (marcados con "(Opcional)"): Son filtros adicionales que puedes usar si quieres acotar m√°s</li>
                        </ul>
                        <p>Ejemplos de par√°metros:</p>
                        <ul>
                            <li><strong>Trabajador:</strong> Selecciona una persona espec√≠fica</li>
                            <li><strong>M√≥dulo:</strong> Elige un curso/capacitaci√≥n en particular</li>
                            <li><strong>Eje Formativo:</strong> Filtra por categor√≠a (Seguridad, Liderazgo, etc.)</li>
                            <li><strong>√Årea Organizacional:</strong> Limita a un departamento</li>
                            <li><strong>Fechas:</strong> Define un rango temporal</li>
                            <li><strong>Estado:</strong> Pendiente, En Progreso, Completado, Vencido</li>
                        </ul>
                    </div>

                    <!-- PASO 3 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">3</span>
                            Ejecutar la consulta
                        </h5>
                        <p>
                            Una vez configurados los par√°metros obligatorios, haz clic en el bot√≥n morado grande 
                            <span class="badge bg-primary">
                                <i class="bi bi-play-circle me-1"></i>Ejecutar Consulta
                            </span>
                        </p>
                        <p>
                            El sistema procesar√° tu consulta (ver√°s una animaci√≥n de carga) y en pocos segundos 
                            mostrar√° los resultados en la parte inferior de la p√°gina.
                        </p>
                        <div class="warning-box">
                            <strong><i class="bi bi-exclamation-triangle me-2"></i>Nota:</strong>
                            Si el bot√≥n "Ejecutar Consulta" est√° deshabilitado (color gris), significa que faltan 
                            par√°metros obligatorios. Aseg√∫rate de llenar todos los campos marcados con *.
                        </div>
                    </div>

                    <!-- PASO 4 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">4</span>
                            Revisar los resultados
                        </h5>
                        <p>
                            Los resultados aparecer√°n en una secci√≥n llamada <strong>"Resultados de la Consulta"</strong>. 
                            Dependiendo del tipo, ver√°s:
                        </p>
                        <ul>
                            <li><strong>KPIs resumidos:</strong> 4 tarjetas con m√©tricas clave (totales, porcentajes, promedios)</li>
                            <li><strong>Gr√°ficos visuales:</strong> Algunos tipos incluyen gr√°ficos de barras, l√≠neas o tendencias</li>
                            <li><strong>Tabla detallada:</strong> Lista completa de registros con toda la informaci√≥n relevante</li>
                            <li><strong>Badges de colores:</strong> Indican estados (verde=completado, rojo=vencido, etc.)</li>
                            <li><strong>Barras de progreso:</strong> Visualizan porcentajes de manera intuitiva</li>
                        </ul>
                        <p>
                            Puedes hacer scroll en la tabla para ver todos los registros. La tabla se ordena 
                            autom√°ticamente de la manera m√°s √∫til seg√∫n el tipo de consulta.
                        </p>
                    </div>

                    <!-- PASO 5 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">5</span>
                            (Opcional) Exportar, compartir o imprimir
                        </h5>
                        <p>
                            En la esquina superior derecha de los resultados ver√°s varios botones de acci√≥n:
                        </p>
                        <ul>
                            <li>
                                <span class="badge bg-primary"><i class="bi bi-download me-1"></i>Exportar</span> 
                                - Descarga los resultados en formato CSV para an√°lisis en Excel
                            </li>
                            <li>
                                <span class="badge bg-secondary"><i class="bi bi-share me-1"></i>Compartir</span> 
                                - Copia un enlace directo a esta consulta para compartir con otros
                            </li>
                            <li>
                                <span class="badge bg-secondary"><i class="bi bi-printer me-1"></i>Imprimir</span> 
                                - Abre una vista optimizada para imprimir o guardar como PDF
                            </li>
                            <li>
                                <span class="badge bg-secondary"><i class="bi bi-arrow-repeat me-1"></i>Nueva Consulta</span> 
                                - Limpia los resultados y te permite hacer otra consulta diferente
                            </li>
                        </ul>
                    </div>

                    <!-- PASO 6 -->
                    <div class="step-card">
                        <h5>
                            <span class="step-number">6</span>
                            (Opcional) Hacer otra consulta
                        </h5>
                        <p>
                            Para hacer una nueva consulta:
                        </p>
                        <ol>
                            <li>Haz clic en el bot√≥n "Nueva Consulta" (o presiona Ctrl/Cmd + N)</li>
                            <li>Selecciona otro tipo de consulta o ajusta los par√°metros</li>
                            <li>Ejecuta de nuevo</li>
                        </ol>
                        <p>
                            Los resultados anteriores se reemplazar√°n. Si quieres conservarlos, exp√≥rtalos o 
                            comp√°rtelos antes de hacer la nueva consulta.
                        </p>
                    </div>

                </div>

                <!-- SECCI√ìN 6: CONSULTAS DESDE DASHBOARD -->
                <div class="manual-section">
                    <h3><i class="bi bi-link-45deg me-2"></i>Acceso R√°pido desde el Dashboard</h3>

                    <p>
                        Una de las funcionalidades m√°s poderosas es que puedes <strong>hacer clic en m√©tricas 
                        del Dashboard y autom√°ticamente se abrir√° una consulta configurada</strong> con los 
                        datos relevantes.
                    </p>

                    <h4>¬øC√≥mo funciona?</h4>

                    <div class="step-card">
                        <h5>Ejemplo 1: M√≥dulos vencidos</h5>
                        <p>
                            Est√°s en el Dashboard y ves que hay 15 m√≥dulos vencidos (badge rojo). Haces clic 
                            en ese n√∫mero y el sistema:
                        </p>
                        <ol>
                            <li>Te lleva autom√°ticamente a Consultas de Rutas</li>
                            <li>Selecciona el tipo "Por Estado"</li>
                            <li>Configura el estado como "Vencido"</li>
                            <li>Ejecuta la consulta autom√°ticamente</li>
                        </ol>
                        <p>
                            En 2 segundos tienes la lista completa de los 15 m√≥dulos vencidos con todos los detalles.
                        </p>
                    </div>

                    <div class="step-card">
                        <h5>Ejemplo 2: Progreso por eje</h5>
                        <p>
                            En el Dashboard ves que el eje "Seguridad y Salud" tiene 65% de completaci√≥n. 
                            Haces clic en ese eje y el sistema abre una consulta "Por Eje Formativo" ya 
                            configurada con ese eje, mostr√°ndote todos los m√≥dulos, trabajadores y el detalle 
                            del progreso.
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-zap me-2"></i>Ventaja clave:</strong>
                        No necesitas memorizar c√≥mo configurar consultas. Simplemente haz clic en lo que te 
                        llame la atenci√≥n en el Dashboard y el sistema te llevar√° autom√°ticamente a la consulta 
                        correspondiente ya configurada y ejecutada.
                    </div>

                    <div class="info-box">
                        <strong><i class="bi bi-bell me-2"></i>Banner informativo:</strong>
                        Cuando llegues a Consultas desde un clic en el Dashboard, ver√°s un banner morado en 
                        la parte superior que dice algo como "M√≥dulos Vencidos - Cargado desde dashboard". 
                        Esto te confirma que la consulta se configur√≥ autom√°ticamente.
                    </div>
                </div>

                <!-- SECCI√ìN 7: INTERPRETANDO RESULTADOS -->
                <div class="manual-section">
                    <h3><i class="bi bi-eye me-2"></i>C√≥mo Interpretar los Resultados</h3>

                    <h4>Elementos comunes en todas las consultas</h4>

                    <p><strong>KPIs (Indicadores en tarjetas):</strong></p>
                    <ul>
                        <li>Son las 4 tarjetas grandes en la parte superior de los resultados</li>
                        <li>Muestran m√©tricas resumidas: totales, porcentajes, promedios</li>
                        <li>Los colores ayudan a identificar r√°pidamente: verde=bueno, rojo=urgente, azul=informativo</li>
                    </ul>

                    <p><strong>Badges de estado:</strong></p>
                    <ul>
                        <li><span class="badge" style="background-color: #d1e7dd; color: #0f5132;">Completado</span> - Verde: Ya terminado exitosamente</li>
                        <li><span class="badge" style="background-color: #fff3cd; color: #856404;">Pendiente</span> - Amarillo: No iniciado a√∫n</li>
                        <li><span class="badge" style="background-color: #cfe2ff; color: #084298;">En progreso</span> - Azul: Iniciado pero no terminado</li>
                        <li><span class="badge" style="background-color: #f8d7da; color: #842029;">Vencido</span> - Rojo: Pas√≥ la fecha l√≠mite sin completar</li>
                    </ul>

                    <p><strong>Barras de progreso:</strong></p>
                    <ul>
                        <li><span style="color: #198754;">‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†</span> Verde (75-100%): Excelente progreso</li>
                        <li><span style="color: #0dcaf0;">‚ñ†‚ñ†‚ñ†‚ñ†‚ñ°</span> Azul (50-74%): Buen avance</li>
                        <li><span style="color: #ffc107;">‚ñ†‚ñ†‚ñ†‚ñ°‚ñ°</span> Amarillo (25-49%): Progreso limitado, necesita impulso</li>
                        <li><span style="color: #dc3545;">‚ñ†‚ñ†‚ñ°‚ñ°‚ñ°</span> Rojo (0-24%): Cr√≠tico, requiere atenci√≥n inmediata</li>
                    </ul>

                    <p><strong>Iconos de alerta (consultas por estado):</strong></p>
                    <ul>
                        <li>üî¥ <strong>Rojo:</strong> Urgente (vence hoy, ya venci√≥, o vence en ‚â§7 d√≠as)</li>
                        <li>üü° <strong>Amarillo:</strong> Pr√≥ximo (vence entre 8-30 d√≠as)</li>
                        <li>üü¢ <strong>Verde:</strong> Normal (vence en m√°s de 30 d√≠as)</li>
                    </ul>

                    <h4>Qu√© buscar seg√∫n el tipo de consulta</h4>

                    <div class="info-box">
                        <strong>Por Trabajador:</strong>
                        <ul class="mt-2 mb-0">
                            <li>Revisa el % de completaci√≥n general: <75% necesita seguimiento</li>
                            <li>Identifica m√≥dulos vencidos (badge rojo): prioriza extender plazos o dar apoyo</li>
                            <li>Observa patrones: si todos los pendientes son de un mismo eje, puede haber un problema con ese contenido</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <strong>Por M√≥dulo:</strong>
                        <ul class="mt-2 mb-0">
                            <li>Si muchos trabajadores tienen calificaci√≥n baja, el m√≥dulo puede ser muy dif√≠cil o estar mal dise√±ado</li>
                            <li>Si hay muchos "En Progreso" pero pocos "Completado", quiz√°s el m√≥dulo es demasiado largo o aburrido</li>
                            <li>Promedio de calificaci√≥n <70: considera revisar el contenido</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <strong>Por Eje:</strong>
                        <ul class="mt-2 mb-0">
                            <li>Compara porcentajes entre m√≥dulos del mismo eje: ¬øalguno destaca positiva o negativamente?</li>
                            <li>Si un eje completo tiene <50%, puede indicar falta de inter√©s o relevancia</li>
                            <li>Ejes obligatorios con bajo % requieren acciones correctivas inmediatas</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <strong>Por √Årea:</strong>
                        <ul class="mt-2 mb-0">
                            <li>Identifica trabajadores con 0%: pueden tener problemas t√©cnicos o necesitar motivaci√≥n</li>
                            <li>Si toda el √°rea va mal, revisa si las fechas l√≠mite son realistas</li>
                            <li>√Åreas con >80%: reconoce y replica sus buenas pr√°cticas</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <strong>Por Fechas:</strong>
                        <ul class="mt-2 mb-0">
                            <li>Busca patrones: ¬øhay d√≠as/semanas con picos de actividad?</li>
                            <li>Periodos sin completaciones: investiga si hubo vacaciones, incidentes o desinter√©s</li>
                            <li>Tendencia a la baja: puede indicar fatiga o sobrecarga</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <strong>Por Facilitador:</strong>
                        <ul class="mt-2 mb-0">
                            <li>Calificaci√≥n promedio <70: el facilitador necesita capacitaci√≥n o feedback</li>
                            <li>Pocos completados vs. muchas asignaciones: investiga si hay problemas de disponibilidad o metodolog√≠a</li>
                            <li>Alto impacto (muchos trabajadores): reconoce y retiene a ese facilitador</li>
                        </ul>
                    </div>

                </div>

                <!-- SECCI√ìN 8: COMPARTIR Y COLABORAR -->
                <div class="manual-section">
                    <h3><i class="bi bi-share me-2"></i>Compartir Consultas con Otras Personas</h3>

                    <p>
                        Una de las funcionalidades m√°s √∫tiles es que puedes compartir consultas mediante enlaces 
                        directos. Cuando compartes un enlace, la otra persona ver√° EXACTAMENTE la misma consulta 
                        que t√∫, ya configurada y ejecutada.
                    </p>

                    <h4>C√≥mo compartir:</h4>

                    <div class="step-card">
                        <h5>Paso 1: Ejecuta la consulta que quieres compartir</h5>
                        <p>
                            Primero, aseg√∫rate de que la consulta est√© ejecutada y mostrando los resultados 
                            correctos.
                        </p>
                    </div>

                    <div class="step-card">
                        <h5>Paso 2: Haz clic en el bot√≥n "Compartir"</h5>
                        <p>
                            En la secci√≥n de resultados, haz clic en:
                            <span class="badge bg-secondary"><i class="bi bi-share me-1"></i>Compartir</span>
                        </p>
                        <p>
                            El sistema copiar√° autom√°ticamente un enlace al portapapeles.
                        </p>
                    </div>

                    <div class="step-card">
                        <h5>Paso 3: Pega el enlace donde lo necesites</h5>
                        <p>
                            Puedes pegar el enlace en:
                        </p>
                        <ul>
                            <li>Correos electr√≥nicos</li>
                            <li>Mensajes de WhatsApp, Slack o Teams</li>
                            <li>Documentos compartidos</li>
                            <li>Presentaciones</li>
                        </ul>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Ventaja:</strong>
                        La persona que reciba el enlace no necesita saber c√≥mo configurar consultas. 
                        Simplemente hace clic y ve los resultados inmediatamente. El enlace incluye todos 
                        los par√°metros de tu consulta.
                    </div>

                    <div class="warning-box">
                        <strong><i class="bi bi-shield-lock me-2"></i>Seguridad:</strong>
                        La persona que reciba el enlace DEBE tener permisos de "Consultas de rutas" en el 
                        sistema. Si no tiene permiso, el enlace no funcionar√° y ver√° un mensaje de acceso denegado.
                    </div>
                </div>

                <!-- SECCI√ìN 9: PREGUNTAS FRECUENTES -->
                <div class="manual-section">
                    <h3><i class="bi bi-question-circle me-2"></i>Preguntas Frecuentes</h3>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¬øCu√°l es la diferencia entre Consultas y Reportes?
                        </div>
                        <div class="faq-answer">
                            <strong>Consultas:</strong> Respuestas r√°pidas a preguntas espec√≠ficas, con gr√°ficos 
                            y visualizaciones. Ideal para investigaci√≥n e interacci√≥n inmediata.<br>
                            <strong>Reportes:</strong> Exportaciones masivas de datos en tablas, con m√∫ltiples 
                            filtros. Ideal para an√°lisis profundo en Excel o documentaci√≥n formal.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¬øPor qu√© mi consulta no muestra resultados?
                        </div>
                        <div class="faq-answer">
                            Posibles causas: (1) Los par√°metros que elegiste son muy restrictivos y no hay datos 
                            que cumplan todas las condiciones, (2) Hay un error tipogr√°fico en alg√∫n filtro opcional, 
                            (3) Los datos que buscas realmente no existen. Intenta quitar filtros opcionales y 
                            ejecutar de nuevo.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¬øPuedo guardar mis consultas favoritas?
                        </div>
                        <div class="faq-answer">
                            No directamente en el sistema, pero puedes guardar el enlace de compartir en tus 
                            favoritos del navegador o en un documento personal. Cada vez que hagas clic en ese 
                            enlace, se ejecutar√° la misma consulta con datos actualizados.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¬øLos datos se actualizan en tiempo real?
                        </div>
                        <div class="faq-answer">
                            S√≠. Cada vez que ejecutas una consulta, el sistema obtiene los datos m√°s recientes 
                            de la base de datos. Si alguien complet√≥ un m√≥dulo hace 5 minutos, esa completaci√≥n 
                            aparecer√° en tu consulta.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¬øQu√© formato tiene el archivo exportado?
                        </div>
                        <div class="faq-answer">
                            Los resultados se exportan en formato CSV (valores separados por comas), que puedes 
                            abrir en Excel, Google Sheets o cualquier programa de hojas de c√°lculo. El CSV incluye 
                            solo los datos de la tabla, no los gr√°ficos ni KPIs.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¬øPuedo hacer consultas sobre datos hist√≥ricos?
                        </div>
                        <div class="faq-answer">
                            S√≠, especialmente con el tipo "Por Rango de Fechas". Puedes consultar completaciones 
                            de hace meses o a√±os, siempre que los datos est√©n en el sistema.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¬øC√≥mo uso la Consulta Avanzada?
                        </div>
                        <div class="faq-answer">
                            La Consulta Avanzada te permite combinar m√∫ltiples filtros libremente. Todos los 
                            par√°metros son opcionales, pero debes seleccionar al menos uno. Es √∫til cuando 
                            necesitas hacer preguntas muy espec√≠ficas como "trabajadores del √°rea X, en m√≥dulos 
                            del eje Y, completados en fecha Z".
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¬øHay l√≠mite de resultados en una consulta?
                        </div>
                        <div class="faq-answer">
                            No hay l√≠mite t√©cnico. Sin embargo, consultas muy amplias (como "todos los trabajadores, 
                            todos los m√≥dulos, sin filtros") pueden tardar m√°s en cargarse. Si la consulta tarda 
                            m√°s de 30 segundos, considera agregar filtros para acotar.
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="bi bi-chevron-right me-2"></i>
                            ¬øPuedo ver consultas de otros usuarios?
                        </div>
                        <div class="faq-answer">
                            Solo si ellos te comparten el enlace. No hay un historial centralizado de consultas 
                            de otros usuarios por razones de privacidad. Cada consulta es individual.
                        </div>
                    </div>

                </div>

                <!-- SECCI√ìN 10: MEJORES PR√ÅCTICAS -->
                <div class="manual-section">
                    <h3><i class="bi bi-award me-2"></i>Mejores Pr√°cticas y Consejos</h3>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Aprende los atajos de teclado</strong>
                        <p class="mb-0 mt-2">
                            <strong>Ctrl/Cmd + Enter:</strong> Ejecutar consulta (si los par√°metros est√°n completos)<br>
                            <strong>Ctrl/Cmd + N:</strong> Nueva consulta<br>
                            <strong>Ctrl/Cmd + E:</strong> Exportar resultados (si hay resultados visibles)
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Usa el Dashboard como punto de partida</strong>
                        <p class="mb-0 mt-2">
                            En lugar de configurar consultas manualmente, haz clic en las m√©tricas del Dashboard. 
                            Es m√°s r√°pido y el sistema configura autom√°ticamente los par√°metros correctos.
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Guarda enlaces de consultas frecuentes</strong>
                        <p class="mb-0 mt-2">
                            Si haces la misma consulta semanalmente (ej: "m√≥dulos vencidos"), ejec√∫tala una vez, 
                            comp√°rtela, y guarda el enlace en tus favoritos. As√≠ no tienes que reconfigurarla 
                            cada vez.
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Combina tipos de consultas</strong>
                        <p class="mb-0 mt-2">
                            Para entender una situaci√≥n compleja, haz varias consultas complementarias. Ejemplo: 
                            primero "Por √Årea" para ver el panorama general, luego "Por Trabajador" para los casos 
                            cr√≠ticos, luego "Por Estado" para identificar urgencias.
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Exporta antes de cerrar</strong>
                        <p class="mb-0 mt-2">
                            Si los resultados son importantes, exp√≥rtalos a CSV antes de hacer otra consulta o 
                            cerrar la p√°gina. Los resultados no se guardan autom√°ticamente.
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Comparte con contexto</strong>
                        <p class="mb-0 mt-2">
                            Cuando compartas un enlace, a√±ade una nota explicando qu√© representa. Ejemplo: 
                            "Este enlace muestra el progreso del equipo de Ventas en T√©cnicas Comerciales - 
                            √öltimo update: 26 enero".
                        </p>
                    </div>

                    <div class="success-box">
                        <strong><i class="bi bi-check-circle me-2"></i>Usa filtros opcionales estrat√©gicamente</strong>
                        <p class="mb-0 mt-2">
                            Empieza con una consulta amplia (solo par√°metros obligatorios), revisa los resultados, 
                            y luego agrega filtros opcionales para enfocar. No uses todos los filtros de golpe o 
                            podr√≠as no encontrar datos.
                        </p>
                    </div>

                </div>

                <!-- TARJETA PARA REPORTAR BUGS -->
                <div class="bug-report-card">
                    <i class="bi bi-bug-fill icon-large"></i>
                    <h4 class="mb-3">¬øEncontraste un problema o tienes una sugerencia?</h4>
                    <p class="mb-4">
                        Si experimentaste un error, algo no funciona como esperas, o tienes 
                        una sugerencia para mejorar el sistema, rep√≥rtalo aqu√≠.
                    </p>
                    <a href="../report-bug.html" class="btn btn-light btn-lg">
                        <i class="bi bi-exclamation-triangle me-2"></i>Reportar Bug o Problema
                    </a>
                </div>

            </div>
        </div>

    </div>

    <!-- BOT√ìN FLOTANTE PARA REPORTAR BUGS -->
    <a href="../report-bug.html" class="btn btn-danger btn-lg floating-bug-button" title="Reportar Bug">
        <i class="bi bi-bug-fill me-2"></i>Reportar Bug
    </a>

    <!-- SCRIPTS - ORDEN CR√çTICO -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/js/config.js"></script>
    
    <script>
        // ==========================================
        // VARIABLES GLOBALES
        // ==========================================
        let currentUser = null;

        // ==========================================
        // CONFIGURACI√ìN DE LA P√ÅGINA
        // ==========================================
        const PAGE_CONFIG = {
            moduleName: 'Formaci√≥n',
            modulePath: 'training',
            pageTitle: 'Consultas de Rutas de Formaci√≥n',
            pagePath: 'path-queries.html',
            moduleDescription: 'B√∫squedas espec√≠ficas y an√°lisis detallados de rutas formativas'
        };

        // ==========================================
        // INICIALIZACI√ìN
        // ==========================================
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üìñ Iniciando p√°gina de manual...');
            
            try {
                // Verificar si existe la funci√≥n de colores corporativos
                if (typeof loadAndApplyBrandColors === 'function') {
                    await loadAndApplyBrandColors();
                }
                
                // Verificar sesi√≥n si la funci√≥n existe
                if (typeof getStoredSession === 'function') {
                    const session = getStoredSession();
                    if (session && session.user) {
                        currentUser = session.user;
                    }
                }
                
                // Actualizar informaci√≥n en la p√°gina
                updatePageInfo();
                
                console.log('‚úÖ P√°gina de manual lista');
                
            } catch (error) {
                console.error('‚ùå Error inicializando p√°gina:', error);
                if (typeof showMessage === 'function') {
                    showMessage('Error al cargar la p√°gina: ' + error.message, 'danger');
                }
            }
        });

        // ==========================================
        // ACTUALIZAR INFORMACI√ìN DE LA P√ÅGINA
        // ==========================================
        function updatePageInfo() {
            // Actualizar title
            document.title = `Manual - ${PAGE_CONFIG.moduleName} - ${PAGE_CONFIG.pageTitle} - SchoolNet`;
        }

        // ==========================================
        // UTILIDADES DE LOADING
        // ==========================================
        function showLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.remove('hidden');
            }
        }

        function hideLoading() {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.add('hidden');
            }
        }

        // ==========================================
        // FUNCI√ìN DE MENSAJES
        // ==========================================
        function showMessage(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            if (!alertContainer) return;
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertContainer.appendChild(alertDiv);
            
            // Auto-remove despu√©s de 5 segundos
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

    </script>
</body>
</html>
